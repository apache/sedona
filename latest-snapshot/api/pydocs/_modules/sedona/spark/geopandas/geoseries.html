

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../../">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>sedona.spark.geopandas.geoseries &mdash; Apache Sedona Python Documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../../../../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../../../../_static/custom.css?v=08a75d8b" />

  
      <script src="../../../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../../../_static/documentation_options.js?v=908dc885"></script>
      <script src="../../../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
     
    <!-- Google Fonts for Apache Sedona styling -->
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&family=Roboto+Mono:wght@400;500&display=swap" rel="stylesheet">

    <!-- Additional meta tags for better rendering -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#1565c0">

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #ff5722" >

          
          
          <a href="../../../../index.html" class="icon icon-home">
            Apache Sedona Python
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../modules.html">sedona</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../sedona.html">sedona package</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../sedona.html#subpackages">Subpackages</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.core.html">sedona.core package</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.flink.html">sedona.flink package</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.geoarrow.html">sedona.geoarrow package</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.maps.html">sedona.maps package</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.raster.html">sedona.raster package</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.raster_utils.html">sedona.raster_utils package</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.register.html">sedona.register package</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.html">sedona.spark package</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.sql.html">sedona.sql package</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.stac.html">sedona.stac package</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.stats.html">sedona.stats package</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.utils.html">sedona.utils package</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../sedona.html#submodules">Submodules</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../sedona.html#module-sedona.exceptions">sedona.exceptions module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.html#sedona.exceptions.InvalidParametersException"><code class="docutils literal notranslate"><span class="pre">InvalidParametersException</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../sedona.html#module-sedona.version">sedona.version module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../sedona.html#module-sedona">Module contents</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../sedona.flink.html">sedona.flink package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../sedona.flink.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../sedona.flink.html#module-sedona.flink.context">sedona.flink.context module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../sedona.flink.html#sedona.flink.context.SedonaContext"><code class="docutils literal notranslate"><span class="pre">SedonaContext</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.flink.html#sedona.flink.context.SedonaContext.create"><code class="docutils literal notranslate"><span class="pre">SedonaContext.create()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../sedona.flink.html#module-sedona.flink">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../sedona.spark.html">sedona.spark package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../sedona.spark.html#subpackages">Subpackages</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../sedona.spark.core.html">sedona.spark.core package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.core.html#subpackages">Subpackages</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.core.html#submodules">Submodules</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.core.html#module-sedona.spark.core.utils">sedona.spark.core.utils module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.core.html#module-sedona.spark.core">Module contents</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../sedona.spark.geoarrow.html">sedona.spark.geoarrow package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geoarrow.html#submodules">Submodules</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geoarrow.html#module-sedona.spark.geoarrow.geoarrow">sedona.spark.geoarrow.geoarrow module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geoarrow.html#module-sedona.spark.geoarrow">Module contents</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../sedona.spark.geopandas.html">sedona.spark.geopandas package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html">sedona.spark.geopandas core</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.io.html">sedona.spark.geopandas.io</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.tools.html">sedona.spark.geopandas.tools</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../sedona.spark.maps.html">sedona.spark.maps package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.maps.html#submodules">Submodules</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.maps.html#module-sedona.spark.maps.SedonaKepler">sedona.spark.maps.SedonaKepler module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.maps.html#module-sedona.spark.maps.SedonaMapUtils">sedona.spark.maps.SedonaMapUtils module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.maps.html#module-sedona.spark.maps.SedonaPyDeck">sedona.spark.maps.SedonaPyDeck module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.maps.html#module-sedona.spark.maps">Module contents</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../sedona.spark.raster.html">sedona.spark.raster package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.raster.html#submodules">Submodules</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.raster.html#module-sedona.spark.raster.awt_raster">sedona.spark.raster.awt_raster module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.raster.html#module-sedona.spark.raster.data_buffer">sedona.spark.raster.data_buffer module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.raster.html#module-sedona.spark.raster.meta">sedona.spark.raster.meta module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.raster.html#module-sedona.spark.raster.raster_serde">sedona.spark.raster.raster_serde module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.raster.html#module-sedona.spark.raster.sample_model">sedona.spark.raster.sample_model module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.raster.html#module-sedona.spark.raster.sedona_raster">sedona.spark.raster.sedona_raster module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.raster.html#module-sedona.spark.raster">Module contents</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../sedona.spark.raster_utils.html">sedona.spark.raster_utils package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.raster_utils.html#submodules">Submodules</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.raster_utils.html#module-sedona.spark.raster_utils.SedonaUtils">sedona.spark.raster_utils.SedonaUtils module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.raster_utils.html#module-sedona.spark.raster_utils">Module contents</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../sedona.spark.register.html">sedona.spark.register package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.register.html#submodules">Submodules</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.register.html#module-sedona.spark.register.geo_registrator">sedona.spark.register.geo_registrator module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.register.html#module-sedona.spark.register.java_libs">sedona.spark.register.java_libs module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.register.html#module-sedona.spark.register">Module contents</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../sedona.spark.sql.html">sedona.spark.sql package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.sql.html#submodules">Submodules</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.sql.html#sedona-spark-sql-connect-module">sedona.spark.sql.connect module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.sql.html#module-sedona.spark.sql.dataframe_api">sedona.spark.sql.dataframe_api module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.sql.html#module-sedona.spark.sql.exceptions">sedona.spark.sql.exceptions module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.sql.html#module-sedona.spark.sql.functions">sedona.spark.sql.functions module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.sql.html#module-sedona.spark.sql.st_aggregates">sedona.spark.sql.st_aggregates module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.sql.html#module-sedona.spark.sql.st_constructors">sedona.spark.sql.st_constructors module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.sql.html#module-sedona.spark.sql.st_functions">sedona.spark.sql.st_functions module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.sql.html#module-sedona.spark.sql.st_predicates">sedona.spark.sql.st_predicates module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.sql.html#module-sedona.spark.sql.types">sedona.spark.sql.types module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.sql.html#module-sedona.spark.sql">Module contents</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../sedona.spark.stac.html">sedona.spark.stac package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.stac.html#submodules">Submodules</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.stac.html#module-sedona.spark.stac.client">sedona.spark.stac.client module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.stac.html#module-sedona.spark.stac.collection_client">sedona.spark.stac.collection_client module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.stac.html#module-sedona.spark.stac">Module contents</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../sedona.spark.stats.html">sedona.spark.stats package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.stats.html#subpackages">Subpackages</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.stats.html#submodules">Submodules</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.stats.html#module-sedona.spark.stats.weighting">sedona.spark.stats.weighting module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.stats.html#module-sedona.spark.stats">Module contents</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../sedona.spark.utils.html">sedona.spark.utils package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.utils.html#submodules">Submodules</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.utils.html#module-sedona.spark.utils.abstract_parser">sedona.spark.utils.abstract_parser module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.utils.html#module-sedona.spark.utils.adapter">sedona.spark.utils.adapter module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.utils.html#module-sedona.spark.utils.binary_parser">sedona.spark.utils.binary_parser module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.utils.html#module-sedona.spark.utils.decorators">sedona.spark.utils.decorators module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.utils.html#module-sedona.spark.utils.geometry_adapter">sedona.spark.utils.geometry_adapter module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.utils.html#module-sedona.spark.utils.geometry_serde">sedona.spark.utils.geometry_serde module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.utils.html#module-sedona.spark.utils.geometry_serde_general">sedona.spark.utils.geometry_serde_general module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.utils.html#module-sedona.spark.utils.geomserde_speedup">sedona.spark.utils.geomserde_speedup module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.utils.html#module-sedona.spark.utils.jvm">sedona.spark.utils.jvm module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.utils.html#module-sedona.spark.utils.meta">sedona.spark.utils.meta module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.utils.html#module-sedona.spark.utils.prep">sedona.spark.utils.prep module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.utils.html#module-sedona.spark.utils.serde">sedona.spark.utils.serde module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.utils.html#module-sedona.spark.utils.spatial_rdd_parser">sedona.spark.utils.spatial_rdd_parser module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.utils.html#module-sedona.spark.utils.structured_adapter">sedona.spark.utils.structured_adapter module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.utils.html#module-sedona.spark.utils.types">sedona.spark.utils.types module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.utils.html#module-sedona.spark.utils">Module contents</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../sedona.spark.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../sedona.spark.html#module-sedona.spark.SedonaContext">sedona.spark.SedonaContext module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../sedona.spark.html#sedona.spark.SedonaContext.SedonaContext"><code class="docutils literal notranslate"><span class="pre">SedonaContext</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.html#sedona.spark.SedonaContext.SedonaContext.__init__"><code class="docutils literal notranslate"><span class="pre">SedonaContext.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.html#sedona.spark.SedonaContext.SedonaContext.builder"><code class="docutils literal notranslate"><span class="pre">SedonaContext.builder()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.html#sedona.spark.SedonaContext.SedonaContext.create"><code class="docutils literal notranslate"><span class="pre">SedonaContext.create()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../sedona.spark.html#module-sedona.spark">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../sedona.spark.geopandas.html">sedona.spark.geopandas package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html">sedona.spark.geopandas core</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries"><code class="docutils literal notranslate"><span class="pre">GeoSeries</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.__init__"><code class="docutils literal notranslate"><span class="pre">GeoSeries.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.area"><code class="docutils literal notranslate"><span class="pre">GeoSeries.area</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.boundary"><code class="docutils literal notranslate"><span class="pre">GeoSeries.boundary</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.bounds"><code class="docutils literal notranslate"><span class="pre">GeoSeries.bounds</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.buffer"><code class="docutils literal notranslate"><span class="pre">GeoSeries.buffer()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.centroid"><code class="docutils literal notranslate"><span class="pre">GeoSeries.centroid</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.clip"><code class="docutils literal notranslate"><span class="pre">GeoSeries.clip()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.concave_hull"><code class="docutils literal notranslate"><span class="pre">GeoSeries.concave_hull()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.contains"><code class="docutils literal notranslate"><span class="pre">GeoSeries.contains()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.contains_properly"><code class="docutils literal notranslate"><span class="pre">GeoSeries.contains_properly()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.convex_hull"><code class="docutils literal notranslate"><span class="pre">GeoSeries.convex_hull</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.copy"><code class="docutils literal notranslate"><span class="pre">GeoSeries.copy()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.count_coordinates"><code class="docutils literal notranslate"><span class="pre">GeoSeries.count_coordinates()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.count_geometries"><code class="docutils literal notranslate"><span class="pre">GeoSeries.count_geometries()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.count_interior_rings"><code class="docutils literal notranslate"><span class="pre">GeoSeries.count_interior_rings()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.covered_by"><code class="docutils literal notranslate"><span class="pre">GeoSeries.covered_by()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.covers"><code class="docutils literal notranslate"><span class="pre">GeoSeries.covers()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.crosses"><code class="docutils literal notranslate"><span class="pre">GeoSeries.crosses()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.crs"><code class="docutils literal notranslate"><span class="pre">GeoSeries.crs</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.delaunay_triangles"><code class="docutils literal notranslate"><span class="pre">GeoSeries.delaunay_triangles()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.difference"><code class="docutils literal notranslate"><span class="pre">GeoSeries.difference()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.disjoint"><code class="docutils literal notranslate"><span class="pre">GeoSeries.disjoint()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.distance"><code class="docutils literal notranslate"><span class="pre">GeoSeries.distance()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.dwithin"><code class="docutils literal notranslate"><span class="pre">GeoSeries.dwithin()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.envelope"><code class="docutils literal notranslate"><span class="pre">GeoSeries.envelope</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.estimate_utm_crs"><code class="docutils literal notranslate"><span class="pre">GeoSeries.estimate_utm_crs()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.explode"><code class="docutils literal notranslate"><span class="pre">GeoSeries.explode()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.exterior"><code class="docutils literal notranslate"><span class="pre">GeoSeries.exterior</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.extract_unique_points"><code class="docutils literal notranslate"><span class="pre">GeoSeries.extract_unique_points()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.fillna"><code class="docutils literal notranslate"><span class="pre">GeoSeries.fillna()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.force_2d"><code class="docutils literal notranslate"><span class="pre">GeoSeries.force_2d()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.force_3d"><code class="docutils literal notranslate"><span class="pre">GeoSeries.force_3d()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.from_arrow"><code class="docutils literal notranslate"><span class="pre">GeoSeries.from_arrow()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.from_file"><code class="docutils literal notranslate"><span class="pre">GeoSeries.from_file()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.from_shapely"><code class="docutils literal notranslate"><span class="pre">GeoSeries.from_shapely()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.from_wkb"><code class="docutils literal notranslate"><span class="pre">GeoSeries.from_wkb()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.from_wkt"><code class="docutils literal notranslate"><span class="pre">GeoSeries.from_wkt()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.from_xy"><code class="docutils literal notranslate"><span class="pre">GeoSeries.from_xy()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.geom_type"><code class="docutils literal notranslate"><span class="pre">GeoSeries.geom_type</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.geometry"><code class="docutils literal notranslate"><span class="pre">GeoSeries.geometry</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.get_geometry"><code class="docutils literal notranslate"><span class="pre">GeoSeries.get_geometry()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.get_precision"><code class="docutils literal notranslate"><span class="pre">GeoSeries.get_precision()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.has_sindex"><code class="docutils literal notranslate"><span class="pre">GeoSeries.has_sindex</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.has_z"><code class="docutils literal notranslate"><span class="pre">GeoSeries.has_z</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.interiors"><code class="docutils literal notranslate"><span class="pre">GeoSeries.interiors</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.intersection"><code class="docutils literal notranslate"><span class="pre">GeoSeries.intersection()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.intersection_all"><code class="docutils literal notranslate"><span class="pre">GeoSeries.intersection_all()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.intersects"><code class="docutils literal notranslate"><span class="pre">GeoSeries.intersects()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.is_ccw"><code class="docutils literal notranslate"><span class="pre">GeoSeries.is_ccw</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.is_closed"><code class="docutils literal notranslate"><span class="pre">GeoSeries.is_closed</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.is_empty"><code class="docutils literal notranslate"><span class="pre">GeoSeries.is_empty</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.is_ring"><code class="docutils literal notranslate"><span class="pre">GeoSeries.is_ring</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.is_simple"><code class="docutils literal notranslate"><span class="pre">GeoSeries.is_simple</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.is_valid"><code class="docutils literal notranslate"><span class="pre">GeoSeries.is_valid</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.is_valid_reason"><code class="docutils literal notranslate"><span class="pre">GeoSeries.is_valid_reason()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.isna"><code class="docutils literal notranslate"><span class="pre">GeoSeries.isna()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.isnull"><code class="docutils literal notranslate"><span class="pre">GeoSeries.isnull()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.length"><code class="docutils literal notranslate"><span class="pre">GeoSeries.length</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.line_merge"><code class="docutils literal notranslate"><span class="pre">GeoSeries.line_merge()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.m"><code class="docutils literal notranslate"><span class="pre">GeoSeries.m</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.make_valid"><code class="docutils literal notranslate"><span class="pre">GeoSeries.make_valid()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.minimum_bounding_circle"><code class="docutils literal notranslate"><span class="pre">GeoSeries.minimum_bounding_circle()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.minimum_bounding_radius"><code class="docutils literal notranslate"><span class="pre">GeoSeries.minimum_bounding_radius()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.minimum_clearance"><code class="docutils literal notranslate"><span class="pre">GeoSeries.minimum_clearance()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.minimum_rotated_rectangle"><code class="docutils literal notranslate"><span class="pre">GeoSeries.minimum_rotated_rectangle()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.normalize"><code class="docutils literal notranslate"><span class="pre">GeoSeries.normalize()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.notna"><code class="docutils literal notranslate"><span class="pre">GeoSeries.notna()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.notnull"><code class="docutils literal notranslate"><span class="pre">GeoSeries.notnull()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.offset_curve"><code class="docutils literal notranslate"><span class="pre">GeoSeries.offset_curve()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.overlaps"><code class="docutils literal notranslate"><span class="pre">GeoSeries.overlaps()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.plot"><code class="docutils literal notranslate"><span class="pre">GeoSeries.plot()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.remove_repeated_points"><code class="docutils literal notranslate"><span class="pre">GeoSeries.remove_repeated_points()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.representative_point"><code class="docutils literal notranslate"><span class="pre">GeoSeries.representative_point()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.reverse"><code class="docutils literal notranslate"><span class="pre">GeoSeries.reverse()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.segmentize"><code class="docutils literal notranslate"><span class="pre">GeoSeries.segmentize()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.set_crs"><code class="docutils literal notranslate"><span class="pre">GeoSeries.set_crs()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.set_precision"><code class="docutils literal notranslate"><span class="pre">GeoSeries.set_precision()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.simplify"><code class="docutils literal notranslate"><span class="pre">GeoSeries.simplify()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.sindex"><code class="docutils literal notranslate"><span class="pre">GeoSeries.sindex</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.snap"><code class="docutils literal notranslate"><span class="pre">GeoSeries.snap()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.to_arrow"><code class="docutils literal notranslate"><span class="pre">GeoSeries.to_arrow()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.to_crs"><code class="docutils literal notranslate"><span class="pre">GeoSeries.to_crs()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.to_file"><code class="docutils literal notranslate"><span class="pre">GeoSeries.to_file()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.to_geoframe"><code class="docutils literal notranslate"><span class="pre">GeoSeries.to_geoframe()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.to_geopandas"><code class="docutils literal notranslate"><span class="pre">GeoSeries.to_geopandas()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.to_json"><code class="docutils literal notranslate"><span class="pre">GeoSeries.to_json()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.to_parquet"><code class="docutils literal notranslate"><span class="pre">GeoSeries.to_parquet()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.to_spark_pandas"><code class="docutils literal notranslate"><span class="pre">GeoSeries.to_spark_pandas()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.to_wkb"><code class="docutils literal notranslate"><span class="pre">GeoSeries.to_wkb()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.to_wkt"><code class="docutils literal notranslate"><span class="pre">GeoSeries.to_wkt()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.total_bounds"><code class="docutils literal notranslate"><span class="pre">GeoSeries.total_bounds</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.touches"><code class="docutils literal notranslate"><span class="pre">GeoSeries.touches()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.transform"><code class="docutils literal notranslate"><span class="pre">GeoSeries.transform()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.type"><code class="docutils literal notranslate"><span class="pre">GeoSeries.type</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.unary_union"><code class="docutils literal notranslate"><span class="pre">GeoSeries.unary_union</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.union_all"><code class="docutils literal notranslate"><span class="pre">GeoSeries.union_all()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.voronoi_polygons"><code class="docutils literal notranslate"><span class="pre">GeoSeries.voronoi_polygons()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.within"><code class="docutils literal notranslate"><span class="pre">GeoSeries.within()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.x"><code class="docutils literal notranslate"><span class="pre">GeoSeries.x</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.y"><code class="docutils literal notranslate"><span class="pre">GeoSeries.y</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.z"><code class="docutils literal notranslate"><span class="pre">GeoSeries.z</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoDataFrame"><code class="docutils literal notranslate"><span class="pre">GeoDataFrame</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoDataFrame.__init__"><code class="docutils literal notranslate"><span class="pre">GeoDataFrame.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoDataFrame.active_geometry_name"><code class="docutils literal notranslate"><span class="pre">GeoDataFrame.active_geometry_name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoDataFrame.copy"><code class="docutils literal notranslate"><span class="pre">GeoDataFrame.copy()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoDataFrame.crs"><code class="docutils literal notranslate"><span class="pre">GeoDataFrame.crs</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoDataFrame.from_arrow"><code class="docutils literal notranslate"><span class="pre">GeoDataFrame.from_arrow()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoDataFrame.from_dict"><code class="docutils literal notranslate"><span class="pre">GeoDataFrame.from_dict()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoDataFrame.from_features"><code class="docutils literal notranslate"><span class="pre">GeoDataFrame.from_features()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoDataFrame.from_file"><code class="docutils literal notranslate"><span class="pre">GeoDataFrame.from_file()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoDataFrame.from_postgis"><code class="docutils literal notranslate"><span class="pre">GeoDataFrame.from_postgis()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoDataFrame.geometry"><code class="docutils literal notranslate"><span class="pre">GeoDataFrame.geometry</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoDataFrame.iterfeatures"><code class="docutils literal notranslate"><span class="pre">GeoDataFrame.iterfeatures()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoDataFrame.plot"><code class="docutils literal notranslate"><span class="pre">GeoDataFrame.plot()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoDataFrame.rename_geometry"><code class="docutils literal notranslate"><span class="pre">GeoDataFrame.rename_geometry()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoDataFrame.set_crs"><code class="docutils literal notranslate"><span class="pre">GeoDataFrame.set_crs()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoDataFrame.set_geometry"><code class="docutils literal notranslate"><span class="pre">GeoDataFrame.set_geometry()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoDataFrame.sjoin"><code class="docutils literal notranslate"><span class="pre">GeoDataFrame.sjoin()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoDataFrame.to_arrow"><code class="docutils literal notranslate"><span class="pre">GeoDataFrame.to_arrow()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoDataFrame.to_crs"><code class="docutils literal notranslate"><span class="pre">GeoDataFrame.to_crs()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoDataFrame.to_feather"><code class="docutils literal notranslate"><span class="pre">GeoDataFrame.to_feather()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoDataFrame.to_file"><code class="docutils literal notranslate"><span class="pre">GeoDataFrame.to_file()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoDataFrame.to_geo_dict"><code class="docutils literal notranslate"><span class="pre">GeoDataFrame.to_geo_dict()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoDataFrame.to_geopandas"><code class="docutils literal notranslate"><span class="pre">GeoDataFrame.to_geopandas()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoDataFrame.to_json"><code class="docutils literal notranslate"><span class="pre">GeoDataFrame.to_json()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoDataFrame.to_parquet"><code class="docutils literal notranslate"><span class="pre">GeoDataFrame.to_parquet()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoDataFrame.to_spark_pandas"><code class="docutils literal notranslate"><span class="pre">GeoDataFrame.to_spark_pandas()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoDataFrame.to_wkb"><code class="docutils literal notranslate"><span class="pre">GeoDataFrame.to_wkb()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoDataFrame.to_wkt"><code class="docutils literal notranslate"><span class="pre">GeoDataFrame.to_wkt()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoDataFrame.type"><code class="docutils literal notranslate"><span class="pre">GeoDataFrame.type</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.sindex.SpatialIndex"><code class="docutils literal notranslate"><span class="pre">SpatialIndex</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.sindex.SpatialIndex.__init__"><code class="docutils literal notranslate"><span class="pre">SpatialIndex.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.sindex.SpatialIndex.intersection"><code class="docutils literal notranslate"><span class="pre">SpatialIndex.intersection()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.sindex.SpatialIndex.is_empty"><code class="docutils literal notranslate"><span class="pre">SpatialIndex.is_empty</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.sindex.SpatialIndex.nearest"><code class="docutils literal notranslate"><span class="pre">SpatialIndex.nearest()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.sindex.SpatialIndex.query"><code class="docutils literal notranslate"><span class="pre">SpatialIndex.query()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.sindex.SpatialIndex.size"><code class="docutils literal notranslate"><span class="pre">SpatialIndex.size</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../sedona.spark.geopandas.io.html">sedona.spark.geopandas.io</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../sedona.spark.geopandas.io.html#sedona.spark.geopandas.io.read_file"><code class="docutils literal notranslate"><span class="pre">read_file()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../sedona.spark.geopandas.io.html#sedona.spark.geopandas.io.read_parquet"><code class="docutils literal notranslate"><span class="pre">read_parquet()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../sedona.spark.geopandas.tools.html">sedona.spark.geopandas.tools</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../sedona.spark.geopandas.tools.html#sedona.spark.geopandas.tools.sjoin.sjoin"><code class="docutils literal notranslate"><span class="pre">sjoin()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../sedona.stac.html">sedona.stac package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../sedona.stac.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../sedona.stac.html#module-sedona.stac.client">sedona.stac.client module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../sedona.stac.html#module-sedona.stac.collection_client">sedona.stac.collection_client module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../sedona.stac.html#module-sedona.stac">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../sedona.stats.html">sedona.stats package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../sedona.stats.html#subpackages">Subpackages</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../sedona.stats.clustering.html">sedona.stats.clustering package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.stats.clustering.html#subpackages">Subpackages</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.stats.clustering.html#module-sedona.stats.clustering">Module contents</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../sedona.stats.hotspot_detection.html">sedona.stats.hotspot_detection package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.stats.hotspot_detection.html#subpackages">Subpackages</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.stats.hotspot_detection.html#submodules">Submodules</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.stats.hotspot_detection.html#module-sedona.stats.hotspot_detection.getis_ord">sedona.stats.hotspot_detection.getis_ord module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.stats.hotspot_detection.html#module-sedona.stats.hotspot_detection">Module contents</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../sedona.stats.outlier_detection.html">sedona.stats.outlier_detection package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.stats.outlier_detection.html#subpackages">Subpackages</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.stats.outlier_detection.html#module-sedona.stats.outlier_detection">Module contents</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../sedona.stats.weighting.html">sedona.stats.weighting package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.stats.weighting.html#module-sedona.stats.weighting">Module contents</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../sedona.stats.html#module-sedona.stats">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../sedona.utils.html">sedona.utils package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../sedona.utils.html#subpackages">Subpackages</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../sedona.utils.structured_adapter.html">sedona.utils.structured_adapter package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.utils.structured_adapter.html#module-sedona.utils.structured_adapter">Module contents</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../sedona.utils.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../sedona.utils.html#module-sedona.utils.adapter">sedona.utils.adapter module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../sedona.utils.html#module-sedona.utils.spatial_rdd_parser">sedona.utils.spatial_rdd_parser module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../sedona.utils.html#module-sedona.utils">Module contents</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: #ff5722" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">Apache Sedona Python</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../../index.html">Module code</a></li>
      <li class="breadcrumb-item active">sedona.spark.geopandas.geoseries</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
    <div class="sedona-content-wrapper">
        
           <div itemprop="articleBody">
             
  <h1>Source code for sedona.spark.geopandas.geoseries</h1><div class="highlight"><pre>
<span></span><span class="c1"># Licensed to the Apache Software Foundation (ASF) under one</span>
<span class="c1"># or more contributor license agreements.  See the NOTICE file</span>
<span class="c1"># distributed with this work for additional information</span>
<span class="c1"># regarding copyright ownership.  The ASF licenses this file</span>
<span class="c1"># to you under the Apache License, Version 2.0 (the</span>
<span class="c1"># &quot;License&quot;); you may not use this file except in compliance</span>
<span class="c1"># with the License.  You may obtain a copy of the License at</span>
<span class="c1">#</span>
<span class="c1">#   http://www.apache.org/licenses/LICENSE-2.0</span>
<span class="c1">#</span>
<span class="c1"># Unless required by applicable law or agreed to in writing,</span>
<span class="c1"># software distributed under the License is distributed on an</span>
<span class="c1"># &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY</span>
<span class="c1"># KIND, either express or implied.  See the License for the</span>
<span class="c1"># specific language governing permissions and limitations</span>
<span class="c1"># under the License.</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">typing</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Any</span><span class="p">,</span> <span class="n">Union</span><span class="p">,</span> <span class="n">Literal</span><span class="p">,</span> <span class="n">List</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">geopandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">gpd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">sedona.spark.geopandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sgpd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pyspark.pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pspd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pyspark</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyspark.pandas</span><span class="w"> </span><span class="kn">import</span> <span class="n">Series</span> <span class="k">as</span> <span class="n">PandasOnSparkSeries</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyspark.pandas.frame</span><span class="w"> </span><span class="kn">import</span> <span class="n">DataFrame</span> <span class="k">as</span> <span class="n">PandasOnSparkDataFrame</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyspark.pandas.internal</span><span class="w"> </span><span class="kn">import</span> <span class="n">InternalFrame</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyspark.pandas.series</span><span class="w"> </span><span class="kn">import</span> <span class="n">first_series</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyspark.pandas.utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">scol_for</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyspark.sql.types</span><span class="w"> </span><span class="kn">import</span> <span class="n">NullType</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sedona.spark.sql.types</span><span class="w"> </span><span class="kn">import</span> <span class="n">GeometryType</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">sedona.spark.sql</span><span class="w"> </span><span class="kn">import</span> <span class="n">st_aggregates</span> <span class="k">as</span> <span class="n">sta</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sedona.spark.sql</span><span class="w"> </span><span class="kn">import</span> <span class="n">st_constructors</span> <span class="k">as</span> <span class="n">stc</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sedona.spark.sql</span><span class="w"> </span><span class="kn">import</span> <span class="n">st_functions</span> <span class="k">as</span> <span class="n">stf</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sedona.spark.sql</span><span class="w"> </span><span class="kn">import</span> <span class="n">st_predicates</span> <span class="k">as</span> <span class="n">stp</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">pyspark.sql</span><span class="w"> </span><span class="kn">import</span> <span class="n">Column</span> <span class="k">as</span> <span class="n">PySparkColumn</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyspark.sql</span><span class="w"> </span><span class="kn">import</span> <span class="n">functions</span> <span class="k">as</span> <span class="n">F</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">shapely</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">shapely.geometry.base</span><span class="w"> </span><span class="kn">import</span> <span class="n">BaseGeometry</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">sedona.spark.geopandas._typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Label</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sedona.spark.geopandas.base</span><span class="w"> </span><span class="kn">import</span> <span class="n">GeoFrame</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sedona.spark.geopandas.geodataframe</span><span class="w"> </span><span class="kn">import</span> <span class="n">GeoDataFrame</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sedona.spark.geopandas.sindex</span><span class="w"> </span><span class="kn">import</span> <span class="n">SpatialIndex</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">packaging.version</span><span class="w"> </span><span class="kn">import</span> <span class="n">parse</span> <span class="k">as</span> <span class="n">parse_version</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">pyspark.pandas.internal</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
    <span class="n">SPARK_DEFAULT_INDEX_NAME</span><span class="p">,</span>  <span class="c1"># __index_level_0__</span>
    <span class="n">NATURAL_ORDER_COLUMN_NAME</span><span class="p">,</span>
    <span class="n">SPARK_DEFAULT_SERIES_NAME</span><span class="p">,</span>  <span class="c1"># &#39;0&#39;</span>
<span class="p">)</span>


<span class="c1"># ============================================================================</span>
<span class="c1"># IMPLEMENTATION STATUS TRACKING</span>
<span class="c1"># ============================================================================</span>

<span class="n">IMPLEMENTATION_STATUS</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;IMPLEMENTED&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">&quot;area&quot;</span><span class="p">,</span>
        <span class="s2">&quot;buffer&quot;</span><span class="p">,</span>
        <span class="s2">&quot;bounds&quot;</span><span class="p">,</span>
        <span class="s2">&quot;centroid&quot;</span><span class="p">,</span>
        <span class="s2">&quot;contains&quot;</span><span class="p">,</span>
        <span class="s2">&quot;crs&quot;</span><span class="p">,</span>
        <span class="s2">&quot;distance&quot;</span><span class="p">,</span>
        <span class="s2">&quot;envelope&quot;</span><span class="p">,</span>
        <span class="s2">&quot;geometry&quot;</span><span class="p">,</span>
        <span class="s2">&quot;intersection&quot;</span><span class="p">,</span>
        <span class="s2">&quot;intersects&quot;</span><span class="p">,</span>
        <span class="s2">&quot;is_empty&quot;</span><span class="p">,</span>
        <span class="s2">&quot;is_simple&quot;</span><span class="p">,</span>
        <span class="s2">&quot;is_valid&quot;</span><span class="p">,</span>
        <span class="s2">&quot;is_valid_reason&quot;</span><span class="p">,</span>
        <span class="s2">&quot;length&quot;</span><span class="p">,</span>
        <span class="s2">&quot;make_valid&quot;</span><span class="p">,</span>
        <span class="s2">&quot;set_crs&quot;</span><span class="p">,</span>
        <span class="s2">&quot;to_crs&quot;</span><span class="p">,</span>
        <span class="s2">&quot;to_geopandas&quot;</span><span class="p">,</span>
        <span class="s2">&quot;to_wkb&quot;</span><span class="p">,</span>
        <span class="s2">&quot;to_wkt&quot;</span><span class="p">,</span>
        <span class="s2">&quot;x&quot;</span><span class="p">,</span>
        <span class="s2">&quot;y&quot;</span><span class="p">,</span>
        <span class="s2">&quot;z&quot;</span><span class="p">,</span>
        <span class="s2">&quot;has_z&quot;</span><span class="p">,</span>
        <span class="s2">&quot;get_geometry&quot;</span><span class="p">,</span>
        <span class="s2">&quot;boundary&quot;</span><span class="p">,</span>
        <span class="s2">&quot;total_bounds&quot;</span><span class="p">,</span>
        <span class="s2">&quot;estimate_utm_crs&quot;</span><span class="p">,</span>
        <span class="s2">&quot;isna&quot;</span><span class="p">,</span>
        <span class="s2">&quot;isnull&quot;</span><span class="p">,</span>
        <span class="s2">&quot;notna&quot;</span><span class="p">,</span>
        <span class="s2">&quot;notnull&quot;</span><span class="p">,</span>
        <span class="s2">&quot;from_xy&quot;</span><span class="p">,</span>
        <span class="s2">&quot;copy&quot;</span><span class="p">,</span>
        <span class="s2">&quot;geom_type&quot;</span><span class="p">,</span>
        <span class="s2">&quot;sindex&quot;</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="s2">&quot;NOT_IMPLEMENTED&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">&quot;clip&quot;</span><span class="p">,</span>
        <span class="s2">&quot;contains_properly&quot;</span><span class="p">,</span>
        <span class="s2">&quot;convex_hull&quot;</span><span class="p">,</span>
        <span class="s2">&quot;count_coordinates&quot;</span><span class="p">,</span>
        <span class="s2">&quot;count_geometries&quot;</span><span class="p">,</span>
        <span class="s2">&quot;count_interior_rings&quot;</span><span class="p">,</span>
        <span class="s2">&quot;explode&quot;</span><span class="p">,</span>
        <span class="s2">&quot;force_2d&quot;</span><span class="p">,</span>
        <span class="s2">&quot;force_3d&quot;</span><span class="p">,</span>
        <span class="s2">&quot;from_file&quot;</span><span class="p">,</span>
        <span class="s2">&quot;from_shapely&quot;</span><span class="p">,</span>
        <span class="s2">&quot;from_arrow&quot;</span><span class="p">,</span>
        <span class="s2">&quot;line_merge&quot;</span><span class="p">,</span>
        <span class="s2">&quot;reverse&quot;</span><span class="p">,</span>
        <span class="s2">&quot;segmentize&quot;</span><span class="p">,</span>
        <span class="s2">&quot;to_json&quot;</span><span class="p">,</span>
        <span class="s2">&quot;to_arrow&quot;</span><span class="p">,</span>
        <span class="s2">&quot;to_file&quot;</span><span class="p">,</span>
        <span class="s2">&quot;transform&quot;</span><span class="p">,</span>
        <span class="s2">&quot;unary_union&quot;</span><span class="p">,</span>
        <span class="s2">&quot;union_all&quot;</span><span class="p">,</span>
        <span class="s2">&quot;intersection_all&quot;</span><span class="p">,</span>
        <span class="s2">&quot;type&quot;</span><span class="p">,</span>
        <span class="s2">&quot;is_ring&quot;</span><span class="p">,</span>
        <span class="s2">&quot;is_ccw&quot;</span><span class="p">,</span>
        <span class="s2">&quot;is_closed&quot;</span><span class="p">,</span>
        <span class="s2">&quot;get_precision&quot;</span><span class="p">,</span>
        <span class="s2">&quot;concave_hull&quot;</span><span class="p">,</span>
        <span class="s2">&quot;delaunay_triangles&quot;</span><span class="p">,</span>
        <span class="s2">&quot;voronoi_polygons&quot;</span><span class="p">,</span>
        <span class="s2">&quot;minimum_rotated_rectangle&quot;</span><span class="p">,</span>
        <span class="s2">&quot;exterior&quot;</span><span class="p">,</span>
        <span class="s2">&quot;extract_unique_points&quot;</span><span class="p">,</span>
        <span class="s2">&quot;offset_curve&quot;</span><span class="p">,</span>
        <span class="s2">&quot;interiors&quot;</span><span class="p">,</span>
        <span class="s2">&quot;remove_repeated_points&quot;</span><span class="p">,</span>
        <span class="s2">&quot;set_precision&quot;</span><span class="p">,</span>
        <span class="s2">&quot;representative_point&quot;</span><span class="p">,</span>
        <span class="s2">&quot;minimum_bounding_circle&quot;</span><span class="p">,</span>
        <span class="s2">&quot;minimum_bounding_radius&quot;</span><span class="p">,</span>
        <span class="s2">&quot;minimum_clearance&quot;</span><span class="p">,</span>
        <span class="s2">&quot;normalize&quot;</span><span class="p">,</span>
        <span class="s2">&quot;m&quot;</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="s2">&quot;PARTIALLY_IMPLEMENTED&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">&quot;fillna&quot;</span><span class="p">,</span>  <span class="c1"># Limited parameter support (no &#39;limit&#39; parameter)</span>
        <span class="s2">&quot;from_wkb&quot;</span><span class="p">,</span>
        <span class="s2">&quot;from_wkt&quot;</span><span class="p">,</span>  <span class="c1"># Limited error handling options (only &#39;raise&#39; supported)</span>
    <span class="p">],</span>
<span class="p">}</span>

<span class="n">IMPLEMENTATION_PRIORITY</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;HIGH&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">&quot;contains&quot;</span><span class="p">,</span>
        <span class="s2">&quot;contains_properly&quot;</span><span class="p">,</span>
        <span class="s2">&quot;convex_hull&quot;</span><span class="p">,</span>
        <span class="s2">&quot;explode&quot;</span><span class="p">,</span>
        <span class="s2">&quot;clip&quot;</span><span class="p">,</span>
        <span class="s2">&quot;from_shapely&quot;</span><span class="p">,</span>
        <span class="s2">&quot;count_coordinates&quot;</span><span class="p">,</span>
        <span class="s2">&quot;count_geometries&quot;</span><span class="p">,</span>
        <span class="s2">&quot;is_ring&quot;</span><span class="p">,</span>
        <span class="s2">&quot;is_closed&quot;</span><span class="p">,</span>
        <span class="s2">&quot;reverse&quot;</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="s2">&quot;MEDIUM&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">&quot;force_2d&quot;</span><span class="p">,</span>
        <span class="s2">&quot;force_3d&quot;</span><span class="p">,</span>
        <span class="s2">&quot;transform&quot;</span><span class="p">,</span>
        <span class="s2">&quot;segmentize&quot;</span><span class="p">,</span>
        <span class="s2">&quot;line_merge&quot;</span><span class="p">,</span>
        <span class="s2">&quot;unary_union&quot;</span><span class="p">,</span>
        <span class="s2">&quot;union_all&quot;</span><span class="p">,</span>
        <span class="s2">&quot;to_json&quot;</span><span class="p">,</span>
        <span class="s2">&quot;from_file&quot;</span><span class="p">,</span>
        <span class="s2">&quot;count_interior_rings&quot;</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="s2">&quot;LOW&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">&quot;delaunay_triangles&quot;</span><span class="p">,</span>
        <span class="s2">&quot;voronoi_polygons&quot;</span><span class="p">,</span>
        <span class="s2">&quot;minimum_bounding_circle&quot;</span><span class="p">,</span>
        <span class="s2">&quot;representative_point&quot;</span><span class="p">,</span>
        <span class="s2">&quot;extract_unique_points&quot;</span><span class="p">,</span>
        <span class="s2">&quot;from_arrow&quot;</span><span class="p">,</span>
        <span class="s2">&quot;to_arrow&quot;</span><span class="p">,</span>
    <span class="p">],</span>
<span class="p">}</span>


<span class="k">def</span><span class="w"> </span><span class="nf">_not_implemented_error</span><span class="p">(</span><span class="n">method_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">additional_info</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generate a standardized NotImplementedError message.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    method_name : str</span>
<span class="sd">        The name of the method that is not implemented.</span>
<span class="sd">    additional_info : str, optional</span>
<span class="sd">        Additional information about the method or workarounds.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    str</span>
<span class="sd">        Formatted error message.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">base_message</span> <span class="o">=</span> <span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;GeoSeries.</span><span class="si">{</span><span class="n">method_name</span><span class="si">}</span><span class="s2">() is not implemented yet.</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="sa">f</span><span class="s2">&quot;This method will be added in a future release.&quot;</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="n">additional_info</span><span class="p">:</span>
        <span class="n">base_message</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n\n</span><span class="si">{</span><span class="n">additional_info</span><span class="si">}</span><span class="s2">&quot;</span>

    <span class="n">workaround</span> <span class="o">=</span> <span class="p">(</span>
        <span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">Temporary workaround - use GeoPandas:</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="s2">&quot;  gpd_series = sedona_series.to_geopandas()</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="sa">f</span><span class="s2">&quot;  result = gpd_series.</span><span class="si">{</span><span class="n">method_name</span><span class="si">}</span><span class="s2">(...)</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="s2">&quot;  # Note: This will collect all data to the driver.&quot;</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">base_message</span> <span class="o">+</span> <span class="n">workaround</span>


<div class="viewcode-block" id="GeoSeries">
<a class="viewcode-back" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">GeoSeries</span><span class="p">(</span><span class="n">GeoFrame</span><span class="p">,</span> <span class="n">pspd</span><span class="o">.</span><span class="n">Series</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A pandas-on-Spark Series for geometric/spatial operations.</span>

<span class="sd">    GeoSeries extends pyspark.pandas.Series to provide spatial operations</span>
<span class="sd">    using Apache Sedona&#39;s spatial functions. It maintains compatibility</span>
<span class="sd">    with GeoPandas GeoSeries while operating on distributed datasets.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data : array-like, Iterable, dict, or scalar value</span>
<span class="sd">        Contains the data for the GeoSeries. Can be geometries, WKB bytes,</span>
<span class="sd">        or other GeoSeries/GeoDataFrame objects.</span>
<span class="sd">    index : array-like or Index (1d), optional</span>
<span class="sd">        Values must be hashable and have the same length as `data`.</span>
<span class="sd">    crs : pyproj.CRS, optional</span>
<span class="sd">        Coordinate Reference System for the geometries.</span>
<span class="sd">    dtype : dtype, optional</span>
<span class="sd">        Data type for the GeoSeries.</span>
<span class="sd">    name : str, optional</span>
<span class="sd">        Name of the GeoSeries.</span>
<span class="sd">    copy : bool, default False</span>
<span class="sd">        Whether to copy the input data.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; from shapely.geometry import Point, Polygon</span>
<span class="sd">    &gt;&gt;&gt; from sedona.spark.geopandas import GeoSeries</span>
<span class="sd">    &gt;&gt;&gt;</span>
<span class="sd">    &gt;&gt;&gt; # Create from geometries</span>
<span class="sd">    &gt;&gt;&gt; s = GeoSeries([Point(0, 0), Point(1, 1)], crs=&#39;EPSG:4326&#39;)</span>
<span class="sd">    &gt;&gt;&gt; s</span>
<span class="sd">    0    POINT (0 0)</span>
<span class="sd">    1    POINT (1 1)</span>
<span class="sd">    dtype: geometry</span>
<span class="sd">    &gt;&gt;&gt;</span>
<span class="sd">    &gt;&gt;&gt; # Spatial operations</span>
<span class="sd">    &gt;&gt;&gt; s.buffer(0.1).area</span>
<span class="sd">    0    0.031416</span>
<span class="sd">    1    0.031416</span>
<span class="sd">    dtype: float64</span>
<span class="sd">    &gt;&gt;&gt;</span>
<span class="sd">    &gt;&gt;&gt; # CRS operations</span>
<span class="sd">    &gt;&gt;&gt; s_utm = s.to_crs(&#39;EPSG:32633&#39;)</span>
<span class="sd">    &gt;&gt;&gt; s_utm.crs</span>
<span class="sd">    &lt;Projected CRS: EPSG:32633&gt;</span>
<span class="sd">    Name: WGS 84 / UTM zone 33N</span>
<span class="sd">    ...</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    This implementation differs from GeoPandas in several ways:</span>
<span class="sd">    - Uses Spark for distributed processing</span>
<span class="sd">    - Geometries are stored in WKB (Well-Known Binary) format internally</span>
<span class="sd">    - Some methods may have different performance characteristics</span>
<span class="sd">    - Not all GeoPandas methods are implemented yet (see IMPLEMENTATION_STATUS)</span>

<span class="sd">    Performance Considerations:</span>
<span class="sd">    - Operations are distributed across Spark cluster</span>
<span class="sd">    - Avoid calling .to_geopandas() on large datasets</span>
<span class="sd">    - Use .sample() for testing with large datasets</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    geopandas.GeoSeries : The GeoPandas equivalent</span>
<span class="sd">    sedona.spark.geopandas.GeoDataFrame : DataFrame with geometry column</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">pspd</span><span class="o">.</span><span class="n">Series</span><span class="o">.</span><span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>

<div class="viewcode-block" id="GeoSeries.__init__">
<a class="viewcode-back" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.__init__">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">index</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">dtype</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">copy</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">fastpath</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">crs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize a GeoSeries object.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        data : array-like, GeoDataFrame, GeoSeries, or pandas Series</span>
<span class="sd">            The input data for the GeoSeries.</span>
<span class="sd">        index : array-like, optional</span>
<span class="sd">            The index for the GeoSeries.</span>
<span class="sd">        crs : pyproj.CRS, optional</span>
<span class="sd">            Coordinate Reference System for the GeoSeries.</span>
<span class="sd">        dtype : dtype, optional</span>
<span class="sd">            Data type for the GeoSeries.</span>
<span class="sd">        name : str, optional</span>
<span class="sd">            Name of the GeoSeries.</span>
<span class="sd">        copy : bool, default False</span>
<span class="sd">            Whether to copy the input data.</span>
<span class="sd">        fastpath : bool, default False</span>
<span class="sd">            Internal parameter for fast initialization.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; from shapely.geometry import Point</span>
<span class="sd">        &gt;&gt;&gt; import geopandas as gpd</span>
<span class="sd">        &gt;&gt;&gt; import pandas as pd</span>
<span class="sd">        &gt;&gt;&gt; from sedona.spark.geopandas import GeoSeries</span>

<span class="sd">        # Example 1: Initialize with GeoDataFrame</span>
<span class="sd">        &gt;&gt;&gt; gdf = gpd.GeoDataFrame({&#39;geometry&#39;: [Point(1, 1), Point(2, 2)]})</span>
<span class="sd">        &gt;&gt;&gt; gs = GeoSeries(data=gdf)</span>
<span class="sd">        &gt;&gt;&gt; print(gs)</span>
<span class="sd">        0    POINT (1 1)</span>
<span class="sd">        1    POINT (2 2)</span>
<span class="sd">        Name: geometry, dtype: geometry</span>

<span class="sd">        # Example 2: Initialize with GeoSeries</span>
<span class="sd">        &gt;&gt;&gt; gseries = gpd.GeoSeries([Point(1, 1), Point(2, 2)])</span>
<span class="sd">        &gt;&gt;&gt; gs = GeoSeries(data=gseries)</span>
<span class="sd">        &gt;&gt;&gt; print(gs)</span>
<span class="sd">        0    POINT (1 1)</span>
<span class="sd">        1    POINT (2 2)</span>
<span class="sd">        dtype: geometry</span>

<span class="sd">        # Example 3: Initialize with pandas Series</span>
<span class="sd">        &gt;&gt;&gt; pseries = pd.Series([Point(1, 1), Point(2, 2)])</span>
<span class="sd">        &gt;&gt;&gt; gs = GeoSeries(data=pseries)</span>
<span class="sd">        &gt;&gt;&gt; print(gs)</span>
<span class="sd">        0    POINT (1 1)</span>
<span class="sd">        1    POINT (2 2)</span>
<span class="sd">        dtype: geometry</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="n">data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_anchor</span><span class="p">:</span> <span class="n">GeoDataFrame</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_col_label</span><span class="p">:</span> <span class="n">Label</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_sindex</span><span class="p">:</span> <span class="n">SpatialIndex</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span>
            <span class="n">data</span><span class="p">,</span> <span class="p">(</span><span class="n">GeoDataFrame</span><span class="p">,</span> <span class="n">GeoSeries</span><span class="p">,</span> <span class="n">PandasOnSparkSeries</span><span class="p">,</span> <span class="n">PandasOnSparkDataFrame</span><span class="p">)</span>
        <span class="p">):</span>
            <span class="k">assert</span> <span class="n">dtype</span> <span class="ow">is</span> <span class="kc">None</span>
            <span class="k">assert</span> <span class="n">name</span> <span class="ow">is</span> <span class="kc">None</span>
            <span class="k">assert</span> <span class="ow">not</span> <span class="n">copy</span>
            <span class="k">assert</span> <span class="ow">not</span> <span class="n">fastpath</span>

            <span class="c1"># We don&#39;t check CRS validity to keep the operation lazy.</span>
            <span class="c1"># Keep the original code for now.</span>
            <span class="c1"># data_crs = None</span>
            <span class="c1"># if hasattr(data, &quot;crs&quot;):</span>
            <span class="c1">#     data_crs = data.crs</span>
            <span class="c1"># if data_crs is not None and crs is not None and data_crs != crs:</span>
            <span class="c1">#     raise ValueError(</span>
            <span class="c1">#         &quot;CRS mismatch between CRS of the passed geometries &quot;</span>
            <span class="c1">#         &quot;and &#39;crs&#39;. Use &#39;GeoSeries.set_crs(crs, &quot;</span>
            <span class="c1">#         &quot;allow_override=True)&#39; to overwrite CRS or &quot;</span>
            <span class="c1">#         &quot;&#39;GeoSeries.to_crs(crs)&#39; to reproject geometries. &quot;</span>
            <span class="c1">#     )</span>

            <span class="c1"># PySpark Pandas&#39; ps.Series.__init__() does not support construction from a</span>
            <span class="c1"># ps.Series input. For now, we manually implement the logic.</span>

            <span class="n">index</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">_col_label</span> <span class="k">if</span> <span class="n">index</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">index</span>
            <span class="n">ps_df</span> <span class="o">=</span> <span class="n">pspd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">_anchor</span><span class="p">)</span>

            <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
                <span class="n">data</span><span class="o">=</span><span class="n">ps_df</span><span class="p">,</span>
                <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">,</span>
                <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">,</span>
                <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
                <span class="n">copy</span><span class="o">=</span><span class="n">copy</span><span class="p">,</span>
                <span class="n">fastpath</span><span class="o">=</span><span class="n">fastpath</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">):</span>
                <span class="k">assert</span> <span class="n">index</span> <span class="ow">is</span> <span class="kc">None</span>
                <span class="k">assert</span> <span class="n">dtype</span> <span class="ow">is</span> <span class="kc">None</span>
                <span class="k">assert</span> <span class="n">name</span> <span class="ow">is</span> <span class="kc">None</span>
                <span class="k">assert</span> <span class="ow">not</span> <span class="n">copy</span>
                <span class="k">assert</span> <span class="ow">not</span> <span class="n">fastpath</span>
                <span class="n">pd_series</span> <span class="o">=</span> <span class="n">data</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">pd_series</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span>
                    <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
                    <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">,</span>
                    <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">,</span>
                    <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
                    <span class="n">copy</span><span class="o">=</span><span class="n">copy</span><span class="p">,</span>
                    <span class="n">fastpath</span><span class="o">=</span><span class="n">fastpath</span><span class="p">,</span>
                <span class="p">)</span>

            <span class="n">pd_series</span> <span class="o">=</span> <span class="n">pd_series</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">object</span><span class="p">)</span>

            <span class="c1"># Initialize the parent class PySpark Series with the pandas Series.</span>
            <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">pd_series</span><span class="p">)</span>

        <span class="c1"># Ensure we&#39;re storing geometry types.</span>
        <span class="k">if</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">spark</span><span class="o">.</span><span class="n">data_type</span> <span class="o">!=</span> <span class="n">GeometryType</span><span class="p">()</span>
            <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">spark</span><span class="o">.</span><span class="n">data_type</span> <span class="o">!=</span> <span class="n">NullType</span><span class="p">()</span>
        <span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="s2">&quot;Non geometry data passed to GeoSeries constructor, &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;received data of dtype &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">spark</span><span class="o">.</span><span class="n">data_type</span><span class="o">.</span><span class="n">typeName</span><span class="p">()</span><span class="si">}</span><span class="s2">&#39;&quot;</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="n">crs</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_crs</span><span class="p">(</span><span class="n">crs</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>


    <span class="c1"># ============================================================================</span>
    <span class="c1"># COORDINATE REFERENCE SYSTEM (CRS) OPERATIONS</span>
    <span class="c1"># ============================================================================</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">crs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="s2">&quot;CRS&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;The Coordinate Reference System (CRS) as a ``pyproj.CRS`` object.</span>

<span class="sd">        Returns None if the CRS is not set, and to set the value it</span>
<span class="sd">        :getter: Returns a ``pyproj.CRS`` or None. When setting, the value</span>
<span class="sd">        can be anything accepted by</span>
<span class="sd">        :meth:`pyproj.CRS.from_user_input() &lt;pyproj.crs.CRS.from_user_input&gt;`,</span>
<span class="sd">        such as an authority string (eg &quot;EPSG:4326&quot;) or a WKT string.</span>

<span class="sd">        Note: This assumes all records in the GeoSeries are assumed to have the same CRS.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; from shapely.geometry import Point</span>
<span class="sd">        &gt;&gt;&gt; from sedona.spark.geopandas import GeoSeries</span>
<span class="sd">        &gt;&gt;&gt; s = GeoSeries([Point(1, 1), Point(2, 2)], crs=&#39;EPSG:4326&#39;)</span>
<span class="sd">        &gt;&gt;&gt; s.crs  # doctest: +SKIP</span>
<span class="sd">        &lt;Geographic 2D CRS: EPSG:4326&gt;</span>
<span class="sd">        Name: WGS 84</span>
<span class="sd">        Axis Info [ellipsoidal]:</span>
<span class="sd">        - Lat[north]: Geodetic latitude (degree)</span>
<span class="sd">        - Lon[east]: Geodetic longitude (degree)</span>
<span class="sd">        Area of Use:</span>
<span class="sd">        - name: World</span>
<span class="sd">        - bounds: (-180.0, -90.0, 180.0, 90.0)</span>
<span class="sd">        Datum: World Geodetic System 1984</span>
<span class="sd">        - Ellipsoid: WGS 84</span>
<span class="sd">        - Prime Meridian: Greenwich</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        GeoSeries.set_crs : assign CRS</span>
<span class="sd">        GeoSeries.to_crs : re-project to another CRS</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">pyproj</span><span class="w"> </span><span class="kn">import</span> <span class="n">CRS</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="c1"># F.first is non-deterministic, but it doesn&#39;t matter because all non-null values should be the same.</span>
        <span class="n">spark_col</span> <span class="o">=</span> <span class="n">stf</span><span class="o">.</span><span class="n">ST_SRID</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">first</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">spark</span><span class="o">.</span><span class="n">column</span><span class="p">,</span> <span class="n">ignorenulls</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>

        <span class="c1"># Set this to avoid error complaining that we don&#39;t have a groupby column.</span>
        <span class="n">tmp_series</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_query_geometry_column</span><span class="p">(</span>
            <span class="n">spark_col</span><span class="p">,</span>
            <span class="n">returns_geom</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">is_aggr</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="c1"># All geometries should have the same SRID,</span>
        <span class="c1"># so we just take the SRID of the first non-null element.</span>
        <span class="n">srid</span> <span class="o">=</span> <span class="n">tmp_series</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
        <span class="c1"># Turn np.nan to 0 to avoid error.</span>
        <span class="n">srid</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">srid</span><span class="p">)</span> <span class="k">else</span> <span class="n">srid</span>

        <span class="c1"># Sedona returns 0 if SRID doesn&#39;t exist.</span>
        <span class="k">return</span> <span class="n">CRS</span><span class="o">.</span><span class="n">from_user_input</span><span class="p">(</span><span class="n">srid</span><span class="p">)</span> <span class="k">if</span> <span class="n">srid</span> <span class="o">!=</span> <span class="mi">0</span> <span class="k">else</span> <span class="kc">None</span>

    <span class="nd">@crs</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">crs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="s2">&quot;CRS&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">]):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_crs</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="nd">@typing</span><span class="o">.</span><span class="n">overload</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">set_crs</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">crs</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">epsg</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">inplace</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="kc">True</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">allow_override</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span> <span class="o">...</span>

    <span class="nd">@typing</span><span class="o">.</span><span class="n">overload</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">set_crs</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">crs</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">epsg</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">inplace</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="kc">False</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">allow_override</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;GeoSeries&quot;</span><span class="p">:</span> <span class="o">...</span>

<div class="viewcode-block" id="GeoSeries.set_crs">
<a class="viewcode-back" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.set_crs">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">set_crs</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">crs</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">epsg</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">inplace</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">allow_override</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="s2">&quot;GeoSeries&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the Coordinate Reference System (CRS) of a ``GeoSeries``.</span>

<span class="sd">        Pass ``None`` to remove CRS from the ``GeoSeries``.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        The underlying geometries are not transformed to this CRS. To</span>
<span class="sd">        transform the geometries to a new CRS, use the ``to_crs`` method.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        crs : pyproj.CRS | None, optional</span>
<span class="sd">            The value can be anything accepted</span>
<span class="sd">            by :meth:`pyproj.CRS.from_user_input() &lt;pyproj.crs.CRS.from_user_input&gt;`,</span>
<span class="sd">            such as an authority string (eg &quot;EPSG:4326&quot;) or a WKT string.</span>
<span class="sd">        epsg : int, optional if `crs` is specified</span>
<span class="sd">            EPSG code specifying the projection.</span>
<span class="sd">        inplace : bool, default False</span>
<span class="sd">            If True, the CRS of the GeoSeries will be changed in place</span>
<span class="sd">            (while still returning the result) instead of making a copy of</span>
<span class="sd">            the GeoSeries.</span>
<span class="sd">        allow_override : bool, default True</span>
<span class="sd">            If the GeoSeries already has a CRS, allow to replace the</span>
<span class="sd">            existing CRS, even when both are not equal. In Sedona, setting this to True</span>
<span class="sd">            will lead to eager evaluation instead of lazy evaluation. Unlike Geopandas,</span>
<span class="sd">            True is the default value in Sedona for performance reasons.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        GeoSeries</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; from sedona.spark.geopandas import GeoSeries</span>
<span class="sd">        &gt;&gt;&gt; from shapely.geometry import Point</span>
<span class="sd">        &gt;&gt;&gt; s = GeoSeries([Point(1, 1), Point(2, 2), Point(3, 3)])</span>
<span class="sd">        &gt;&gt;&gt; s</span>
<span class="sd">        0    POINT (1 1)</span>
<span class="sd">        1    POINT (2 2)</span>
<span class="sd">        2    POINT (3 3)</span>
<span class="sd">        dtype: geometry</span>

<span class="sd">        Setting CRS to a GeoSeries without one:</span>

<span class="sd">        &gt;&gt;&gt; s.crs is None</span>
<span class="sd">        True</span>

<span class="sd">        &gt;&gt;&gt; s = s.set_crs(&#39;epsg:3857&#39;)</span>
<span class="sd">        &gt;&gt;&gt; s.crs  # doctest: +SKIP</span>
<span class="sd">        &lt;Projected CRS: EPSG:3857&gt;</span>
<span class="sd">        Name: WGS 84 / Pseudo-Mercator</span>
<span class="sd">        Axis Info [cartesian]:</span>
<span class="sd">        - X[east]: Easting (metre)</span>
<span class="sd">        - Y[north]: Northing (metre)</span>
<span class="sd">        Area of Use:</span>
<span class="sd">        - name: World - 85°S to 85°N</span>
<span class="sd">        - bounds: (-180.0, -85.06, 180.0, 85.06)</span>
<span class="sd">        Coordinate Operation:</span>
<span class="sd">        - name: Popular Visualisation Pseudo-Mercator</span>
<span class="sd">        - method: Popular Visualisation Pseudo Mercator</span>
<span class="sd">        Datum: World Geodetic System 1984</span>
<span class="sd">        - Ellipsoid: WGS 84</span>
<span class="sd">        - Prime Meridian: Greenwich</span>

<span class="sd">        Overriding existing CRS:</span>

<span class="sd">        &gt;&gt;&gt; s = s.set_crs(4326, allow_override=True)</span>

<span class="sd">        Without ``allow_override=True``, ``set_crs`` returns an error if you try to</span>
<span class="sd">        override CRS.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        GeoSeries.to_crs : re-project to another CRS</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">pyproj</span><span class="w"> </span><span class="kn">import</span> <span class="n">CRS</span>

        <span class="k">if</span> <span class="n">crs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">crs</span> <span class="o">=</span> <span class="n">CRS</span><span class="o">.</span><span class="n">from_user_input</span><span class="p">(</span><span class="n">crs</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">epsg</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">crs</span> <span class="o">=</span> <span class="n">CRS</span><span class="o">.</span><span class="n">from_epsg</span><span class="p">(</span><span class="n">epsg</span><span class="p">)</span>

        <span class="c1"># The below block for the not allow_override case is eager due to the self.crs call.</span>
        <span class="c1"># This hurts performance and user experience, hence the default being set to True in Sedona.</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">allow_override</span><span class="p">:</span>
            <span class="n">curr_crs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">crs</span>

            <span class="k">if</span> <span class="n">curr_crs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">curr_crs</span> <span class="o">==</span> <span class="n">crs</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s2">&quot;The GeoSeries already has a CRS which is not equal to the passed &quot;</span>
                    <span class="s2">&quot;CRS. Specify &#39;allow_override=True&#39; to allow replacing the existing &quot;</span>
                    <span class="s2">&quot;CRS without doing any transformation. If you actually want to &quot;</span>
                    <span class="s2">&quot;transform the geometries, use &#39;GeoSeries.to_crs&#39; instead.&quot;</span>
                <span class="p">)</span>

        <span class="c1"># 0 indicates no SRID in Sedona.</span>
        <span class="n">new_epsg</span> <span class="o">=</span> <span class="n">crs</span><span class="o">.</span><span class="n">to_epsg</span><span class="p">()</span> <span class="k">if</span> <span class="n">crs</span> <span class="k">else</span> <span class="mi">0</span>

        <span class="n">spark_col</span> <span class="o">=</span> <span class="n">stf</span><span class="o">.</span><span class="n">ST_SetSRID</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">spark</span><span class="o">.</span><span class="n">column</span><span class="p">,</span> <span class="n">new_epsg</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_query_geometry_column</span><span class="p">(</span><span class="n">spark_col</span><span class="p">,</span> <span class="n">keep_name</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">inplace</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_update_inplace</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">invalidate_sindex</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="k">return</span> <span class="n">result</span></div>


    <span class="c1"># ============================================================================</span>
    <span class="c1"># INTERNAL HELPER METHODS</span>
    <span class="c1"># ============================================================================</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_query_geometry_column</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">spark_col</span><span class="p">:</span> <span class="n">PySparkColumn</span><span class="p">,</span>
        <span class="n">df</span><span class="p">:</span> <span class="n">pyspark</span><span class="o">.</span><span class="n">sql</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">returns_geom</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">is_aggr</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">keep_name</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="s2">&quot;GeoSeries&quot;</span><span class="p">,</span> <span class="n">pspd</span><span class="o">.</span><span class="n">Series</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Helper method to query a single geometry column with a specified operation.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        spark_col : str</span>
<span class="sd">            The query to apply to the geometry column.</span>
<span class="sd">        df : pyspark.sql.DataFrame</span>
<span class="sd">            The dataframe to query. If not provided, the internal dataframe will be used.</span>
<span class="sd">        returns_geom : bool, default True</span>
<span class="sd">            If True, the geometry column will be converted back to EWKB format.</span>
<span class="sd">        is_aggr : bool, default False</span>
<span class="sd">            If True, the query is an aggregation query.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        GeoSeries</span>
<span class="sd">            A GeoSeries with the operation applied to the geometry column.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_internal</span><span class="o">.</span><span class="n">spark_frame</span> <span class="k">if</span> <span class="n">df</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">df</span>

        <span class="n">rename</span> <span class="o">=</span> <span class="n">SPARK_DEFAULT_SERIES_NAME</span>

        <span class="k">if</span> <span class="n">keep_name</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">:</span>
            <span class="n">rename</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>

        <span class="n">col_expr</span> <span class="o">=</span> <span class="n">spark_col</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="n">rename</span><span class="p">)</span>

        <span class="n">exprs</span> <span class="o">=</span> <span class="p">[</span><span class="n">col_expr</span><span class="p">]</span>

        <span class="n">index_spark_columns</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">index_fields</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">is_aggr</span><span class="p">:</span>
            <span class="c1"># We always select NATURAL_ORDER_COLUMN_NAME, to avoid having to regenerate it in the result.</span>
            <span class="c1"># We always select SPARK_DEFAULT_INDEX_NAME, to retain series index info.</span>

            <span class="n">exprs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">scol_for</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">SPARK_DEFAULT_INDEX_NAME</span><span class="p">))</span>
            <span class="n">exprs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">scol_for</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">NATURAL_ORDER_COLUMN_NAME</span><span class="p">))</span>

            <span class="n">index_spark_columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">scol_for</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">SPARK_DEFAULT_INDEX_NAME</span><span class="p">)]</span>
            <span class="n">index_fields</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_internal</span><span class="o">.</span><span class="n">index_fields</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
            <span class="n">sdf</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span>
                <span class="n">col_expr</span><span class="p">,</span>
                <span class="n">scol_for</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">SPARK_DEFAULT_INDEX_NAME</span><span class="p">),</span>
                <span class="n">scol_for</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">NATURAL_ORDER_COLUMN_NAME</span><span class="p">),</span>
            <span class="p">)</span>
        <span class="c1"># Otherwise, if is_aggr, we don&#39;t select the index columns.</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">sdf</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="o">*</span><span class="n">exprs</span><span class="p">)</span>

        <span class="n">internal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_internal</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span>
            <span class="n">spark_frame</span><span class="o">=</span><span class="n">sdf</span><span class="p">,</span>
            <span class="n">index_fields</span><span class="o">=</span><span class="n">index_fields</span><span class="p">,</span>
            <span class="n">index_spark_columns</span><span class="o">=</span><span class="n">index_spark_columns</span><span class="p">,</span>
            <span class="n">data_spark_columns</span><span class="o">=</span><span class="p">[</span><span class="n">scol_for</span><span class="p">(</span><span class="n">sdf</span><span class="p">,</span> <span class="n">rename</span><span class="p">)],</span>
            <span class="n">data_fields</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_internal</span><span class="o">.</span><span class="n">data_fields</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">rename</span><span class="p">)],</span>
            <span class="n">column_label_names</span><span class="o">=</span><span class="p">[(</span><span class="n">rename</span><span class="p">,)],</span>
        <span class="p">)</span>
        <span class="n">ps_series</span> <span class="o">=</span> <span class="n">first_series</span><span class="p">(</span><span class="n">PandasOnSparkDataFrame</span><span class="p">(</span><span class="n">internal</span><span class="p">))</span>

        <span class="c1"># Convert Spark series default name to pandas series default name (None) if needed.</span>
        <span class="n">series_name</span> <span class="o">=</span> <span class="kc">None</span> <span class="k">if</span> <span class="n">rename</span> <span class="o">==</span> <span class="n">SPARK_DEFAULT_SERIES_NAME</span> <span class="k">else</span> <span class="n">rename</span>
        <span class="n">ps_series</span> <span class="o">=</span> <span class="n">ps_series</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">series_name</span><span class="p">)</span>

        <span class="n">result</span> <span class="o">=</span> <span class="n">GeoSeries</span><span class="p">(</span><span class="n">ps_series</span><span class="p">)</span> <span class="k">if</span> <span class="n">returns_geom</span> <span class="k">else</span> <span class="n">ps_series</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="c1"># ============================================================================</span>
    <span class="c1"># CONVERSION AND SERIALIZATION METHODS</span>
    <span class="c1"># ============================================================================</span>

<div class="viewcode-block" id="GeoSeries.to_geopandas">
<a class="viewcode-back" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.to_geopandas">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">to_geopandas</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoSeries</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Convert the GeoSeries to a GeoPandas GeoSeries.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        geopandas.GeoSeries</span>
<span class="sd">            A GeoPandas GeoSeries.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">pyspark.pandas.utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">log_advice</span>

        <span class="n">log_advice</span><span class="p">(</span>
            <span class="s2">&quot;`to_geopandas` loads all data into the driver&#39;s memory. &quot;</span>
            <span class="s2">&quot;It should only be used if the resulting GeoPandas GeoSeries is expected to be small.&quot;</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_to_geopandas</span><span class="p">()</span></div>


    <span class="k">def</span><span class="w"> </span><span class="nf">_to_geopandas</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoSeries</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Same as `to_geopandas()`, without issuing the advice log for internal usage.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">pd_series</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_to_internal_pandas</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoSeries</span><span class="p">(</span><span class="n">pd_series</span><span class="p">,</span> <span class="n">crs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">crs</span><span class="p">)</span>

<div class="viewcode-block" id="GeoSeries.to_spark_pandas">
<a class="viewcode-back" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.to_spark_pandas">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">to_spark_pandas</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pspd</span><span class="o">.</span><span class="n">Series</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">pspd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">pspd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_psdf</span><span class="o">.</span><span class="n">_internal</span><span class="p">))</span></div>


    <span class="c1"># ============================================================================</span>
    <span class="c1"># PROPERTIES AND ATTRIBUTES</span>
    <span class="c1"># ============================================================================</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">geometry</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;GeoSeries&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">sindex</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SpatialIndex</span><span class="p">:</span>
        <span class="n">geometry_column</span> <span class="o">=</span> <span class="n">_get_series_col_name</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">geometry_column</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;No geometry column found in GeoSeries&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sindex</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_sindex</span> <span class="o">=</span> <span class="n">SpatialIndex</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sindex</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">has_sindex</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sindex</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>

<div class="viewcode-block" id="GeoSeries.copy">
<a class="viewcode-back" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.copy">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">deep</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Make a copy of this GeoSeries object.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        deep : bool, default False</span>
<span class="sd">            If True, a deep copy of the data is made. Otherwise, a shallow</span>
<span class="sd">            copy is made.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        GeoSeries</span>
<span class="sd">            A copy of this GeoSeries object.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; from shapely.geometry import Point</span>
<span class="sd">        &gt;&gt;&gt; from sedona.spark.geopandas import GeoSeries</span>
<span class="sd">        &gt;&gt;&gt; gs = GeoSeries([Point(1, 1), Point(2, 2)])</span>
<span class="sd">        &gt;&gt;&gt; gs_copy = gs.copy()</span>
<span class="sd">        &gt;&gt;&gt; print(gs_copy)</span>
<span class="sd">        0    POINT (1 1)</span>
<span class="sd">        1    POINT (2 2)</span>
<span class="sd">        dtype: geometry</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">deep</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">GeoSeries</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_anchor</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span> <span class="n">dtype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_col_label</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span></div>


    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">area</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pspd</span><span class="o">.</span><span class="n">Series</span><span class="p">:</span>
        <span class="n">spark_col</span> <span class="o">=</span> <span class="n">stf</span><span class="o">.</span><span class="n">ST_Area</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">spark</span><span class="o">.</span><span class="n">column</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_query_geometry_column</span><span class="p">(</span>
            <span class="n">spark_col</span><span class="p">,</span>
            <span class="n">returns_geom</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">geom_type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pspd</span><span class="o">.</span><span class="n">Series</span><span class="p">:</span>
        <span class="n">spark_col</span> <span class="o">=</span> <span class="n">stf</span><span class="o">.</span><span class="n">GeometryType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">spark</span><span class="o">.</span><span class="n">column</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_query_geometry_column</span><span class="p">(</span>
            <span class="n">spark_col</span><span class="p">,</span>
            <span class="n">returns_geom</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="c1"># Sedona returns the string in all caps unlike GeoPandas.</span>
        <span class="n">sgpd_to_gpg_name_map</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;POINT&quot;</span><span class="p">:</span> <span class="s2">&quot;Point&quot;</span><span class="p">,</span>
            <span class="s2">&quot;LINESTRING&quot;</span><span class="p">:</span> <span class="s2">&quot;LineString&quot;</span><span class="p">,</span>
            <span class="s2">&quot;POLYGON&quot;</span><span class="p">:</span> <span class="s2">&quot;Polygon&quot;</span><span class="p">,</span>
            <span class="s2">&quot;MULTIPOINT&quot;</span><span class="p">:</span> <span class="s2">&quot;MultiPoint&quot;</span><span class="p">,</span>
            <span class="s2">&quot;MULTILINESTRING&quot;</span><span class="p">:</span> <span class="s2">&quot;MultiLineString&quot;</span><span class="p">,</span>
            <span class="s2">&quot;MULTIPOLYGON&quot;</span><span class="p">:</span> <span class="s2">&quot;MultiPolygon&quot;</span><span class="p">,</span>
            <span class="s2">&quot;GEOMETRYCOLLECTION&quot;</span><span class="p">:</span> <span class="s2">&quot;GeometryCollection&quot;</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">sgpd_to_gpg_name_map</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">type</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Implementation of the abstract method.</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
            <span class="n">_not_implemented_error</span><span class="p">(</span><span class="s2">&quot;type&quot;</span><span class="p">,</span> <span class="s2">&quot;Returns numeric geometry type codes.&quot;</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">length</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pspd</span><span class="o">.</span><span class="n">Series</span><span class="p">:</span>
        <span class="n">spark_expr</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">F</span><span class="o">.</span><span class="n">when</span><span class="p">(</span>
                <span class="n">stf</span><span class="o">.</span><span class="n">GeometryType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">spark</span><span class="o">.</span><span class="n">column</span><span class="p">)</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span>
                    <span class="p">[</span><span class="s2">&quot;LINESTRING&quot;</span><span class="p">,</span> <span class="s2">&quot;MULTILINESTRING&quot;</span><span class="p">]</span>
                <span class="p">),</span>
                <span class="n">stf</span><span class="o">.</span><span class="n">ST_Length</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">spark</span><span class="o">.</span><span class="n">column</span><span class="p">),</span>
            <span class="p">)</span>
            <span class="o">.</span><span class="n">when</span><span class="p">(</span>
                <span class="n">stf</span><span class="o">.</span><span class="n">GeometryType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">spark</span><span class="o">.</span><span class="n">column</span><span class="p">)</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="s2">&quot;POLYGON&quot;</span><span class="p">,</span> <span class="s2">&quot;MULTIPOLYGON&quot;</span><span class="p">]),</span>
                <span class="n">stf</span><span class="o">.</span><span class="n">ST_Perimeter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">spark</span><span class="o">.</span><span class="n">column</span><span class="p">),</span>
            <span class="p">)</span>
            <span class="o">.</span><span class="n">when</span><span class="p">(</span>
                <span class="n">stf</span><span class="o">.</span><span class="n">GeometryType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">spark</span><span class="o">.</span><span class="n">column</span><span class="p">)</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="s2">&quot;POINT&quot;</span><span class="p">,</span> <span class="s2">&quot;MULTIPOINT&quot;</span><span class="p">]),</span>
                <span class="mf">0.0</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="o">.</span><span class="n">when</span><span class="p">(</span>
                <span class="n">stf</span><span class="o">.</span><span class="n">GeometryType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">spark</span><span class="o">.</span><span class="n">column</span><span class="p">)</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="s2">&quot;GEOMETRYCOLLECTION&quot;</span><span class="p">]),</span>
                <span class="n">stf</span><span class="o">.</span><span class="n">ST_Length</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">spark</span><span class="o">.</span><span class="n">column</span><span class="p">)</span> <span class="o">+</span> <span class="n">stf</span><span class="o">.</span><span class="n">ST_Perimeter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">spark</span><span class="o">.</span><span class="n">column</span><span class="p">),</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_query_geometry_column</span><span class="p">(</span>
            <span class="n">spark_expr</span><span class="p">,</span>
            <span class="n">returns_geom</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">is_valid</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pspd</span><span class="o">.</span><span class="n">Series</span><span class="p">:</span>
        <span class="n">spark_col</span> <span class="o">=</span> <span class="n">stf</span><span class="o">.</span><span class="n">ST_IsValid</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">spark</span><span class="o">.</span><span class="n">column</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_query_geometry_column</span><span class="p">(</span>
            <span class="n">spark_col</span><span class="p">,</span>
            <span class="n">returns_geom</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">_to_bool</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>

<div class="viewcode-block" id="GeoSeries.is_valid_reason">
<a class="viewcode-back" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.is_valid_reason">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">is_valid_reason</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pspd</span><span class="o">.</span><span class="n">Series</span><span class="p">:</span>
        <span class="n">spark_col</span> <span class="o">=</span> <span class="n">stf</span><span class="o">.</span><span class="n">ST_IsValidReason</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">spark</span><span class="o">.</span><span class="n">column</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_query_geometry_column</span><span class="p">(</span>
            <span class="n">spark_col</span><span class="p">,</span>
            <span class="n">returns_geom</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="p">)</span></div>


    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">is_empty</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pspd</span><span class="o">.</span><span class="n">Series</span><span class="p">:</span>
        <span class="n">spark_expr</span> <span class="o">=</span> <span class="n">stf</span><span class="o">.</span><span class="n">ST_IsEmpty</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">spark</span><span class="o">.</span><span class="n">column</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_query_geometry_column</span><span class="p">(</span>
            <span class="n">spark_expr</span><span class="p">,</span>
            <span class="n">returns_geom</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">_to_bool</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>

<div class="viewcode-block" id="GeoSeries.count_coordinates">
<a class="viewcode-back" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.count_coordinates">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">count_coordinates</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Implementation of the abstract method.</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
            <span class="n">_not_implemented_error</span><span class="p">(</span>
                <span class="s2">&quot;count_coordinates&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Counts the number of coordinate tuples in each geometry.&quot;</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="GeoSeries.count_geometries">
<a class="viewcode-back" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.count_geometries">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">count_geometries</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Implementation of the abstract method.</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
            <span class="n">_not_implemented_error</span><span class="p">(</span>
                <span class="s2">&quot;count_geometries&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Counts the number of geometries in each multi-geometry or collection.&quot;</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="GeoSeries.count_interior_rings">
<a class="viewcode-back" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.count_interior_rings">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">count_interior_rings</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Implementation of the abstract method.</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
            <span class="n">_not_implemented_error</span><span class="p">(</span>
                <span class="s2">&quot;count_interior_rings&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Counts the number of interior rings (holes) in each polygon.&quot;</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="GeoSeries.dwithin">
<a class="viewcode-back" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.dwithin">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">dwithin</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="n">distance</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">distance</span><span class="p">,</span> <span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
                <span class="s2">&quot;Array-like distance for dwithin not implemented yet.&quot;</span>
            <span class="p">)</span>

        <span class="n">other_series</span><span class="p">,</span> <span class="n">extended</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_series_of_val</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
        <span class="n">align</span> <span class="o">=</span> <span class="kc">False</span> <span class="k">if</span> <span class="n">extended</span> <span class="k">else</span> <span class="n">align</span>

        <span class="n">spark_expr</span> <span class="o">=</span> <span class="n">stp</span><span class="o">.</span><span class="n">ST_DWithin</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;L&quot;</span><span class="p">),</span> <span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;R&quot;</span><span class="p">),</span> <span class="n">F</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="n">distance</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_row_wise_operation</span><span class="p">(</span>
            <span class="n">spark_expr</span><span class="p">,</span>
            <span class="n">other_series</span><span class="p">,</span>
            <span class="n">align</span><span class="o">=</span><span class="n">align</span><span class="p">,</span>
            <span class="n">returns_geom</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">default_val</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="GeoSeries.difference">
<a class="viewcode-back" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.difference">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">difference</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;GeoSeries&quot;</span><span class="p">:</span>
        <span class="n">other_series</span><span class="p">,</span> <span class="n">extended</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_series_of_val</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
        <span class="n">align</span> <span class="o">=</span> <span class="kc">False</span> <span class="k">if</span> <span class="n">extended</span> <span class="k">else</span> <span class="n">align</span>

        <span class="n">spark_expr</span> <span class="o">=</span> <span class="n">stf</span><span class="o">.</span><span class="n">ST_Difference</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;L&quot;</span><span class="p">),</span> <span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;R&quot;</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_row_wise_operation</span><span class="p">(</span>
            <span class="n">spark_expr</span><span class="p">,</span>
            <span class="n">other_series</span><span class="p">,</span>
            <span class="n">align</span><span class="o">=</span><span class="n">align</span><span class="p">,</span>
            <span class="n">returns_geom</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span></div>


    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">is_simple</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pspd</span><span class="o">.</span><span class="n">Series</span><span class="p">:</span>
        <span class="n">spark_expr</span> <span class="o">=</span> <span class="n">stf</span><span class="o">.</span><span class="n">ST_IsSimple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">spark</span><span class="o">.</span><span class="n">column</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_query_geometry_column</span><span class="p">(</span>
            <span class="n">spark_expr</span><span class="p">,</span>
            <span class="n">returns_geom</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">_to_bool</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">is_ring</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">spark_expr</span> <span class="o">=</span> <span class="n">stf</span><span class="o">.</span><span class="n">ST_IsRing</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">spark</span><span class="o">.</span><span class="n">column</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_query_geometry_column</span><span class="p">(</span>
            <span class="n">spark_expr</span><span class="p">,</span>
            <span class="n">returns_geom</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">_to_bool</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">is_ccw</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Implementation of the abstract method.</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
            <span class="n">_not_implemented_error</span><span class="p">(</span>
                <span class="s2">&quot;is_ccw&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Tests if LinearRing geometries are oriented counter-clockwise.&quot;</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">is_closed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">spark_expr</span> <span class="o">=</span> <span class="n">stf</span><span class="o">.</span><span class="n">ST_IsClosed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">spark</span><span class="o">.</span><span class="n">column</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_query_geometry_column</span><span class="p">(</span>
            <span class="n">spark_expr</span><span class="p">,</span>
            <span class="n">returns_geom</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">_to_bool</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">has_z</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pspd</span><span class="o">.</span><span class="n">Series</span><span class="p">:</span>
        <span class="n">spark_expr</span> <span class="o">=</span> <span class="n">stf</span><span class="o">.</span><span class="n">ST_HasZ</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">spark</span><span class="o">.</span><span class="n">column</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_query_geometry_column</span><span class="p">(</span>
            <span class="n">spark_expr</span><span class="p">,</span>
            <span class="n">returns_geom</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="p">)</span>

<div class="viewcode-block" id="GeoSeries.get_precision">
<a class="viewcode-back" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.get_precision">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_precision</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Implementation of the abstract method.</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;This method is not implemented yet.&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="GeoSeries.get_geometry">
<a class="viewcode-back" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.get_geometry">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_geometry</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;GeoSeries&quot;</span><span class="p">:</span>
        <span class="c1"># Sedona errors on negative indexes, so we use a case statement to handle it ourselves.</span>
        <span class="n">spark_expr</span> <span class="o">=</span> <span class="n">stf</span><span class="o">.</span><span class="n">ST_GeometryN</span><span class="p">(</span>
            <span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;L&quot;</span><span class="p">),</span>
            <span class="n">F</span><span class="o">.</span><span class="n">when</span><span class="p">(</span>
                <span class="n">stf</span><span class="o">.</span><span class="n">ST_NumGeometries</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;L&quot;</span><span class="p">))</span> <span class="o">+</span> <span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;R&quot;</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">,</span>
                <span class="kc">None</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="o">.</span><span class="n">when</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;R&quot;</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">,</span> <span class="n">stf</span><span class="o">.</span><span class="n">ST_NumGeometries</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;L&quot;</span><span class="p">))</span> <span class="o">+</span> <span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;R&quot;</span><span class="p">))</span>
            <span class="o">.</span><span class="n">otherwise</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;R&quot;</span><span class="p">)),</span>
        <span class="p">)</span>

        <span class="n">other</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_series_of_val</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>

        <span class="c1"># align = False either way</span>
        <span class="n">align</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_row_wise_operation</span><span class="p">(</span>
            <span class="n">spark_expr</span><span class="p">,</span>
            <span class="n">other</span><span class="p">,</span>
            <span class="n">align</span><span class="o">=</span><span class="n">align</span><span class="p">,</span>
            <span class="n">returns_geom</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">default_val</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="p">)</span></div>


    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">boundary</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;GeoSeries&quot;</span><span class="p">:</span>
        <span class="c1"># Geopandas and shapely return NULL for GeometryCollections, so we handle it separately</span>
        <span class="c1"># https://shapely.readthedocs.io/en/stable/reference/shapely.boundary.html</span>
        <span class="n">spark_expr</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">when</span><span class="p">(</span>
            <span class="n">stf</span><span class="o">.</span><span class="n">GeometryType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">spark</span><span class="o">.</span><span class="n">column</span><span class="p">)</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="s2">&quot;GEOMETRYCOLLECTION&quot;</span><span class="p">]),</span>
            <span class="kc">None</span><span class="p">,</span>
        <span class="p">)</span><span class="o">.</span><span class="n">otherwise</span><span class="p">(</span><span class="n">stf</span><span class="o">.</span><span class="n">ST_Boundary</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">spark</span><span class="o">.</span><span class="n">column</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_query_geometry_column</span><span class="p">(</span>
            <span class="n">spark_expr</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">centroid</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;GeoSeries&quot;</span><span class="p">:</span>
        <span class="n">spark_expr</span> <span class="o">=</span> <span class="n">stf</span><span class="o">.</span><span class="n">ST_Centroid</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">spark</span><span class="o">.</span><span class="n">column</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_query_geometry_column</span><span class="p">(</span>
            <span class="n">spark_expr</span><span class="p">,</span>
            <span class="n">returns_geom</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span>

<div class="viewcode-block" id="GeoSeries.concave_hull">
<a class="viewcode-back" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.concave_hull">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">concave_hull</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ratio</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">allow_holes</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="c1"># Implementation of the abstract method.</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;This method is not implemented yet.&quot;</span><span class="p">)</span></div>


    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">convex_hull</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Implementation of the abstract method.</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
            <span class="n">_not_implemented_error</span><span class="p">(</span>
                <span class="s2">&quot;convex_hull&quot;</span><span class="p">,</span> <span class="s2">&quot;Computes the convex hull of each geometry.&quot;</span>
            <span class="p">)</span>
        <span class="p">)</span>

<div class="viewcode-block" id="GeoSeries.delaunay_triangles">
<a class="viewcode-back" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.delaunay_triangles">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">delaunay_triangles</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tolerance</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">only_edges</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="c1"># Implementation of the abstract method.</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;This method is not implemented yet.&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="GeoSeries.voronoi_polygons">
<a class="viewcode-back" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.voronoi_polygons">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">voronoi_polygons</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tolerance</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">extend_to</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">only_edges</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="c1"># Implementation of the abstract method.</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;This method is not implemented yet.&quot;</span><span class="p">)</span></div>


    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">envelope</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;GeoSeries&quot;</span><span class="p">:</span>
        <span class="n">spark_expr</span> <span class="o">=</span> <span class="n">stf</span><span class="o">.</span><span class="n">ST_Envelope</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">spark</span><span class="o">.</span><span class="n">column</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_query_geometry_column</span><span class="p">(</span>
            <span class="n">spark_expr</span><span class="p">,</span>
            <span class="n">returns_geom</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span>

<div class="viewcode-block" id="GeoSeries.minimum_rotated_rectangle">
<a class="viewcode-back" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.minimum_rotated_rectangle">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">minimum_rotated_rectangle</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Implementation of the abstract method.</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;This method is not implemented yet.&quot;</span><span class="p">)</span></div>


    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">exterior</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Implementation of the abstract method.</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;This method is not implemented yet.&quot;</span><span class="p">)</span>

<div class="viewcode-block" id="GeoSeries.extract_unique_points">
<a class="viewcode-back" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.extract_unique_points">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">extract_unique_points</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Implementation of the abstract method.</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;This method is not implemented yet.&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="GeoSeries.offset_curve">
<a class="viewcode-back" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.offset_curve">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">offset_curve</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">distance</span><span class="p">,</span> <span class="n">quad_segs</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">join_style</span><span class="o">=</span><span class="s2">&quot;round&quot;</span><span class="p">,</span> <span class="n">mitre_limit</span><span class="o">=</span><span class="mf">5.0</span><span class="p">):</span>
        <span class="c1"># Implementation of the abstract method.</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;This method is not implemented yet.&quot;</span><span class="p">)</span></div>


    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">interiors</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Implementation of the abstract method.</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;This method is not implemented yet.&quot;</span><span class="p">)</span>

<div class="viewcode-block" id="GeoSeries.remove_repeated_points">
<a class="viewcode-back" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.remove_repeated_points">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">remove_repeated_points</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tolerance</span><span class="o">=</span><span class="mf">0.0</span><span class="p">):</span>
        <span class="c1"># Implementation of the abstract method.</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;This method is not implemented yet.&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="GeoSeries.set_precision">
<a class="viewcode-back" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.set_precision">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">set_precision</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">grid_size</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;valid_output&quot;</span><span class="p">):</span>
        <span class="c1"># Implementation of the abstract method.</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;This method is not implemented yet.&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="GeoSeries.representative_point">
<a class="viewcode-back" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.representative_point">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">representative_point</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Implementation of the abstract method.</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;This method is not implemented yet.&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="GeoSeries.minimum_bounding_circle">
<a class="viewcode-back" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.minimum_bounding_circle">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">minimum_bounding_circle</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Implementation of the abstract method.</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;This method is not implemented yet.&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="GeoSeries.minimum_bounding_radius">
<a class="viewcode-back" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.minimum_bounding_radius">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">minimum_bounding_radius</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Implementation of the abstract method.</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;This method is not implemented yet.&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="GeoSeries.minimum_clearance">
<a class="viewcode-back" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.minimum_clearance">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">minimum_clearance</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Implementation of the abstract method.</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;This method is not implemented yet.&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="GeoSeries.normalize">
<a class="viewcode-back" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.normalize">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">normalize</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Implementation of the abstract method.</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;This method is not implemented yet.&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="GeoSeries.make_valid">
<a class="viewcode-back" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.make_valid">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">make_valid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;linework&quot;</span><span class="p">,</span> <span class="n">keep_collapsed</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;GeoSeries&quot;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">method</span> <span class="o">!=</span> <span class="s2">&quot;structure&quot;</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;Sedona only supports the &#39;structure&#39; method for make_valid&quot;</span>
            <span class="p">)</span>

        <span class="n">spark_expr</span> <span class="o">=</span> <span class="n">stf</span><span class="o">.</span><span class="n">ST_MakeValid</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">spark</span><span class="o">.</span><span class="n">column</span><span class="p">,</span> <span class="n">keep_collapsed</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_query_geometry_column</span><span class="p">(</span>
            <span class="n">spark_expr</span><span class="p">,</span>
            <span class="n">returns_geom</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="GeoSeries.reverse">
<a class="viewcode-back" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.reverse">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">reverse</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Implementation of the abstract method.</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;This method is not implemented yet.&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="GeoSeries.segmentize">
<a class="viewcode-back" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.segmentize">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">segmentize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">max_segment_length</span><span class="p">):</span>
        <span class="n">other_series</span><span class="p">,</span> <span class="n">extended</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_series_of_val</span><span class="p">(</span><span class="n">max_segment_length</span><span class="p">)</span>
        <span class="n">align</span> <span class="o">=</span> <span class="kc">False</span> <span class="k">if</span> <span class="n">extended</span> <span class="k">else</span> <span class="n">align</span>

        <span class="n">spark_expr</span> <span class="o">=</span> <span class="n">stf</span><span class="o">.</span><span class="n">ST_Segmentize</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;L&quot;</span><span class="p">),</span> <span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;R&quot;</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_row_wise_operation</span><span class="p">(</span>
            <span class="n">spark_expr</span><span class="p">,</span>
            <span class="n">other_series</span><span class="p">,</span>
            <span class="n">align</span><span class="o">=</span><span class="n">align</span><span class="p">,</span>
            <span class="n">returns_geom</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="GeoSeries.transform">
<a class="viewcode-back" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.transform">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">transform</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">transformation</span><span class="p">,</span> <span class="n">include_z</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="c1"># Implementation of the abstract method.</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;This method is not implemented yet.&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="GeoSeries.force_2d">
<a class="viewcode-back" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.force_2d">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">force_2d</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Implementation of the abstract method.</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;This method is not implemented yet.&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="GeoSeries.force_3d">
<a class="viewcode-back" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.force_3d">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">force_3d</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="c1"># Implementation of the abstract method.</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;This method is not implemented yet.&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="GeoSeries.line_merge">
<a class="viewcode-back" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.line_merge">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">line_merge</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">directed</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="c1"># Implementation of the abstract method.</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;This method is not implemented yet.&quot;</span><span class="p">)</span></div>


    <span class="c1"># ============================================================================</span>
    <span class="c1"># GEOMETRIC OPERATIONS</span>
    <span class="c1"># ============================================================================</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">unary_union</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Implementation of the abstract method.</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;This method is not implemented yet.&quot;</span><span class="p">)</span>

<div class="viewcode-block" id="GeoSeries.union_all">
<a class="viewcode-back" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.union_all">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">union_all</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;unary&quot;</span><span class="p">,</span> <span class="n">grid_size</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">BaseGeometry</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">grid_size</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;Sedona does not support the grid_size argument&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">method</span> <span class="o">!=</span> <span class="s2">&quot;unary&quot;</span><span class="p">:</span>
            <span class="kn">import</span><span class="w"> </span><span class="nn">warnings</span>

            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Sedona does not support manually specifying different union methods. Ignoring non-default method argument of </span><span class="si">{</span><span class="n">method</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c1"># While it&#39;s not explicitly defined in GeoPandas docs, this is what GeoPandas returns for empty GeoSeries.</span>
            <span class="c1"># If it ever changes for some reason, we&#39;ll catch that with the test</span>
            <span class="kn">from</span><span class="w"> </span><span class="nn">shapely.geometry</span><span class="w"> </span><span class="kn">import</span> <span class="n">GeometryCollection</span>

            <span class="k">return</span> <span class="n">GeometryCollection</span><span class="p">()</span>

        <span class="n">spark_expr</span> <span class="o">=</span> <span class="n">sta</span><span class="o">.</span><span class="n">ST_Union_Aggr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">spark</span><span class="o">.</span><span class="n">column</span><span class="p">)</span>
        <span class="n">tmp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_query_geometry_column</span><span class="p">(</span><span class="n">spark_expr</span><span class="p">,</span> <span class="n">returns_geom</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">is_aggr</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="n">ps_series</span> <span class="o">=</span> <span class="n">tmp</span><span class="o">.</span><span class="n">take</span><span class="p">([</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">geom</span> <span class="o">=</span> <span class="n">ps_series</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">geom</span></div>


<div class="viewcode-block" id="GeoSeries.crosses">
<a class="viewcode-back" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.crosses">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">crosses</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pspd</span><span class="o">.</span><span class="n">Series</span><span class="p">:</span>
        <span class="c1"># Sedona does not support GeometryCollection (errors), so we return NULL for now to avoid error.</span>
        <span class="n">other_series</span><span class="p">,</span> <span class="n">extended</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_series_of_val</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
        <span class="n">align</span> <span class="o">=</span> <span class="kc">False</span> <span class="k">if</span> <span class="n">extended</span> <span class="k">else</span> <span class="n">align</span>

        <span class="n">spark_expr</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">when</span><span class="p">(</span>
            <span class="p">(</span><span class="n">stf</span><span class="o">.</span><span class="n">GeometryType</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;L&quot;</span><span class="p">))</span> <span class="o">==</span> <span class="s2">&quot;GEOMETRYCOLLECTION&quot;</span><span class="p">)</span>
            <span class="o">|</span> <span class="p">(</span><span class="n">stf</span><span class="o">.</span><span class="n">GeometryType</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;R&quot;</span><span class="p">))</span> <span class="o">==</span> <span class="s2">&quot;GEOMETRYCOLLECTION&quot;</span><span class="p">),</span>
            <span class="kc">None</span><span class="p">,</span>
        <span class="p">)</span><span class="o">.</span><span class="n">otherwise</span><span class="p">(</span><span class="n">stp</span><span class="o">.</span><span class="n">ST_Crosses</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;L&quot;</span><span class="p">),</span> <span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;R&quot;</span><span class="p">)))</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_row_wise_operation</span><span class="p">(</span>
            <span class="n">spark_expr</span><span class="p">,</span>
            <span class="n">other_series</span><span class="p">,</span>
            <span class="n">align</span><span class="p">,</span>
            <span class="n">default_val</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">_to_bool</span><span class="p">(</span><span class="n">result</span><span class="p">)</span></div>


<div class="viewcode-block" id="GeoSeries.disjoint">
<a class="viewcode-back" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.disjoint">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">disjoint</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="c1"># Implementation of the abstract method.</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;This method is not implemented yet.&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="GeoSeries.intersects">
<a class="viewcode-back" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.intersects">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">intersects</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="s2">&quot;GeoSeries&quot;</span><span class="p">,</span> <span class="n">BaseGeometry</span><span class="p">],</span> <span class="n">align</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pspd</span><span class="o">.</span><span class="n">Series</span><span class="p">:</span>
        <span class="n">other_series</span><span class="p">,</span> <span class="n">extended</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_series_of_val</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
        <span class="n">align</span> <span class="o">=</span> <span class="kc">False</span> <span class="k">if</span> <span class="n">extended</span> <span class="k">else</span> <span class="n">align</span>

        <span class="n">spark_expr</span> <span class="o">=</span> <span class="n">stp</span><span class="o">.</span><span class="n">ST_Intersects</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;L&quot;</span><span class="p">),</span> <span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;R&quot;</span><span class="p">))</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_row_wise_operation</span><span class="p">(</span>
            <span class="n">spark_expr</span><span class="p">,</span>
            <span class="n">other_series</span><span class="p">,</span>
            <span class="n">align</span><span class="p">,</span>
            <span class="n">default_val</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">_to_bool</span><span class="p">(</span><span class="n">result</span><span class="p">)</span></div>


<div class="viewcode-block" id="GeoSeries.overlaps">
<a class="viewcode-back" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.overlaps">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">overlaps</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pspd</span><span class="o">.</span><span class="n">Series</span><span class="p">:</span>
        <span class="c1"># Note: We cannot efficiently match GeoPandas behavior because Sedona&#39;s ST_Overlaps returns True for equal geometries.</span>
        <span class="c1"># ST_Overlaps(`L`, `R`) AND ST_Equals(`L`, `R`) does not work because ST_Equals errors on invalid geometries</span>

        <span class="n">other_series</span><span class="p">,</span> <span class="n">extended</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_series_of_val</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
        <span class="n">align</span> <span class="o">=</span> <span class="kc">False</span> <span class="k">if</span> <span class="n">extended</span> <span class="k">else</span> <span class="n">align</span>

        <span class="n">spark_expr</span> <span class="o">=</span> <span class="n">stp</span><span class="o">.</span><span class="n">ST_Overlaps</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;L&quot;</span><span class="p">),</span> <span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;R&quot;</span><span class="p">))</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_row_wise_operation</span><span class="p">(</span>
            <span class="n">spark_expr</span><span class="p">,</span>
            <span class="n">other_series</span><span class="p">,</span>
            <span class="n">align</span><span class="p">,</span>
            <span class="n">default_val</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">_to_bool</span><span class="p">(</span><span class="n">result</span><span class="p">)</span></div>


<div class="viewcode-block" id="GeoSeries.touches">
<a class="viewcode-back" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.touches">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">touches</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pspd</span><span class="o">.</span><span class="n">Series</span><span class="p">:</span>
        <span class="n">other_series</span><span class="p">,</span> <span class="n">extended</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_series_of_val</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
        <span class="n">align</span> <span class="o">=</span> <span class="kc">False</span> <span class="k">if</span> <span class="n">extended</span> <span class="k">else</span> <span class="n">align</span>

        <span class="n">spark_expr</span> <span class="o">=</span> <span class="n">stp</span><span class="o">.</span><span class="n">ST_Touches</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;L&quot;</span><span class="p">),</span> <span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;R&quot;</span><span class="p">))</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_row_wise_operation</span><span class="p">(</span>
            <span class="n">spark_expr</span><span class="p">,</span>
            <span class="n">other_series</span><span class="p">,</span>
            <span class="n">align</span><span class="p">,</span>
            <span class="n">default_val</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">_to_bool</span><span class="p">(</span><span class="n">result</span><span class="p">)</span></div>


<div class="viewcode-block" id="GeoSeries.within">
<a class="viewcode-back" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.within">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">within</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pspd</span><span class="o">.</span><span class="n">Series</span><span class="p">:</span>
        <span class="n">other_series</span><span class="p">,</span> <span class="n">extended</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_series_of_val</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
        <span class="n">align</span> <span class="o">=</span> <span class="kc">False</span> <span class="k">if</span> <span class="n">extended</span> <span class="k">else</span> <span class="n">align</span>

        <span class="n">spark_expr</span> <span class="o">=</span> <span class="n">stp</span><span class="o">.</span><span class="n">ST_Within</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;L&quot;</span><span class="p">),</span> <span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;R&quot;</span><span class="p">))</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_row_wise_operation</span><span class="p">(</span>
            <span class="n">spark_expr</span><span class="p">,</span>
            <span class="n">other_series</span><span class="p">,</span>
            <span class="n">align</span><span class="p">,</span>
            <span class="n">default_val</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">_to_bool</span><span class="p">(</span><span class="n">result</span><span class="p">)</span></div>


<div class="viewcode-block" id="GeoSeries.covers">
<a class="viewcode-back" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.covers">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">covers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pspd</span><span class="o">.</span><span class="n">Series</span><span class="p">:</span>
        <span class="n">other_series</span><span class="p">,</span> <span class="n">extended</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_series_of_val</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
        <span class="n">align</span> <span class="o">=</span> <span class="kc">False</span> <span class="k">if</span> <span class="n">extended</span> <span class="k">else</span> <span class="n">align</span>

        <span class="n">spark_expr</span> <span class="o">=</span> <span class="n">stp</span><span class="o">.</span><span class="n">ST_Covers</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;L&quot;</span><span class="p">),</span> <span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;R&quot;</span><span class="p">))</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_row_wise_operation</span><span class="p">(</span>
            <span class="n">spark_expr</span><span class="p">,</span>
            <span class="n">other_series</span><span class="p">,</span>
            <span class="n">align</span><span class="p">,</span>
            <span class="n">default_val</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">_to_bool</span><span class="p">(</span><span class="n">result</span><span class="p">)</span></div>


<div class="viewcode-block" id="GeoSeries.covered_by">
<a class="viewcode-back" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.covered_by">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">covered_by</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pspd</span><span class="o">.</span><span class="n">Series</span><span class="p">:</span>
        <span class="n">other_series</span><span class="p">,</span> <span class="n">extended</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_series_of_val</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
        <span class="n">align</span> <span class="o">=</span> <span class="kc">False</span> <span class="k">if</span> <span class="n">extended</span> <span class="k">else</span> <span class="n">align</span>

        <span class="n">spark_expr</span> <span class="o">=</span> <span class="n">stp</span><span class="o">.</span><span class="n">ST_CoveredBy</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;L&quot;</span><span class="p">),</span> <span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;R&quot;</span><span class="p">))</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_row_wise_operation</span><span class="p">(</span>
            <span class="n">spark_expr</span><span class="p">,</span>
            <span class="n">other_series</span><span class="p">,</span>
            <span class="n">align</span><span class="p">,</span>
            <span class="n">default_val</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">_to_bool</span><span class="p">(</span><span class="n">result</span><span class="p">)</span></div>


<div class="viewcode-block" id="GeoSeries.distance">
<a class="viewcode-back" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.distance">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">distance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pspd</span><span class="o">.</span><span class="n">Series</span><span class="p">:</span>
        <span class="n">other_series</span><span class="p">,</span> <span class="n">extended</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_series_of_val</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
        <span class="n">align</span> <span class="o">=</span> <span class="kc">False</span> <span class="k">if</span> <span class="n">extended</span> <span class="k">else</span> <span class="n">align</span>

        <span class="n">spark_expr</span> <span class="o">=</span> <span class="n">stf</span><span class="o">.</span><span class="n">ST_Distance</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;L&quot;</span><span class="p">),</span> <span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;R&quot;</span><span class="p">))</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_row_wise_operation</span><span class="p">(</span>
            <span class="n">spark_expr</span><span class="p">,</span>
            <span class="n">other_series</span><span class="p">,</span>
            <span class="n">align</span><span class="p">,</span>
            <span class="n">default_val</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span></div>


<div class="viewcode-block" id="GeoSeries.intersection">
<a class="viewcode-back" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.intersection">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">intersection</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="s2">&quot;GeoSeries&quot;</span><span class="p">,</span> <span class="n">BaseGeometry</span><span class="p">],</span> <span class="n">align</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;GeoSeries&quot;</span><span class="p">:</span>
        <span class="n">other_series</span><span class="p">,</span> <span class="n">extended</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_series_of_val</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
        <span class="n">align</span> <span class="o">=</span> <span class="kc">False</span> <span class="k">if</span> <span class="n">extended</span> <span class="k">else</span> <span class="n">align</span>

        <span class="n">spark_expr</span> <span class="o">=</span> <span class="n">stf</span><span class="o">.</span><span class="n">ST_Intersection</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;L&quot;</span><span class="p">),</span> <span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;R&quot;</span><span class="p">))</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_row_wise_operation</span><span class="p">(</span>
            <span class="n">spark_expr</span><span class="p">,</span>
            <span class="n">other_series</span><span class="p">,</span>
            <span class="n">align</span><span class="p">,</span>
            <span class="n">returns_geom</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">default_val</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span></div>


<div class="viewcode-block" id="GeoSeries.snap">
<a class="viewcode-back" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.snap">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">snap</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="n">tolerance</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;GeoSeries&quot;</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">tolerance</span><span class="p">,</span> <span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
                <span class="s2">&quot;Array-like values for tolerance are not supported yet.&quot;</span>
            <span class="p">)</span>

        <span class="c1"># Both sgpd and gpd implementations simply call the snap functions</span>
        <span class="c1"># in JTS and GEOs, respectively. The results often differ slightly, but these</span>
        <span class="c1"># must be differences inside of the engines themselves.</span>

        <span class="n">other_series</span><span class="p">,</span> <span class="n">extended</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_series_of_val</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
        <span class="n">align</span> <span class="o">=</span> <span class="kc">False</span> <span class="k">if</span> <span class="n">extended</span> <span class="k">else</span> <span class="n">align</span>

        <span class="n">spark_expr</span> <span class="o">=</span> <span class="n">stf</span><span class="o">.</span><span class="n">ST_Snap</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;L&quot;</span><span class="p">),</span> <span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;R&quot;</span><span class="p">),</span> <span class="n">tolerance</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_row_wise_operation</span><span class="p">(</span>
            <span class="n">spark_expr</span><span class="p">,</span>
            <span class="n">other_series</span><span class="p">,</span>
            <span class="n">align</span><span class="p">,</span>
            <span class="n">returns_geom</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span></div>


    <span class="k">def</span><span class="w"> </span><span class="nf">_row_wise_operation</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">spark_col</span><span class="p">:</span> <span class="n">PySparkColumn</span><span class="p">,</span>
        <span class="n">other</span><span class="p">:</span> <span class="n">pspd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span>
        <span class="n">align</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="kc">None</span><span class="p">],</span>
        <span class="n">returns_geom</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">default_val</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">keep_name</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Helper function to perform a row-wise operation on two GeoSeries.</span>
<span class="sd">        The self column and other column are aliased to `L` and `R`, respectively.</span>

<span class="sd">        align : bool or None (default None)</span>
<span class="sd">            If True, automatically aligns GeoSeries based on their indices. None defaults to True.</span>
<span class="sd">            If False, the order of elements is preserved.</span>
<span class="sd">            Note: align should also be set to False when &#39;other&#39; a geoseries created from a single object</span>
<span class="sd">            (e.g. GeoSeries([Point(0, 0) * len(self)])), so that we align based on natural ordering in case</span>
<span class="sd">            the index is not the default range index from 0.</span>
<span class="sd">            Alternatively, we could create &#39;other&#39; using the same index as self,</span>
<span class="sd">            but that would require index=self.index.to_pandas() which is less scalable.</span>

<span class="sd">        default_val : Any (default None)</span>
<span class="sd">            The value to use if either L or R is null. If None, nulls are not handled.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">pyspark.sql.functions</span><span class="w"> </span><span class="kn">import</span> <span class="n">col</span>

        <span class="c1"># Note: this is specifically False. None is valid since it defaults to True similar to GeoPandas.</span>
        <span class="n">index_col</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">NATURAL_ORDER_COLUMN_NAME</span> <span class="k">if</span> <span class="n">align</span> <span class="ow">is</span> <span class="kc">False</span> <span class="k">else</span> <span class="n">SPARK_DEFAULT_INDEX_NAME</span>
        <span class="p">)</span>

        <span class="c1"># This code assumes there is only one index (SPARK_DEFAULT_INDEX_NAME)</span>
        <span class="c1"># and would need to be updated if Sedona later supports multi-index.</span>

        <span class="n">sdf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_internal</span><span class="o">.</span><span class="n">spark_frame</span>
        <span class="n">other_sdf</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">_internal</span><span class="o">.</span><span class="n">spark_frame</span>

        <span class="k">if</span> <span class="n">index_col</span> <span class="o">==</span> <span class="n">NATURAL_ORDER_COLUMN_NAME</span><span class="p">:</span>
            <span class="c1"># NATURAL_ORDER_COLUMN_NAME is not deterministic or sequential, so we instead replace it with a</span>
            <span class="c1"># new column of row_numbers to perform the alignment. This mimics the following code.</span>
            <span class="c1"># sdf.withColumn(index_col, F.row_number().over(Window.orderBy(NATURAL_ORDER_COLUMN_NAME)))</span>
            <span class="n">sdf</span> <span class="o">=</span> <span class="n">sdf</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">index_col</span><span class="p">)</span>
            <span class="n">other_sdf</span> <span class="o">=</span> <span class="n">other_sdf</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">index_col</span><span class="p">)</span>
            <span class="n">sdf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_internal</span><span class="o">.</span><span class="n">attach_distributed_sequence_column</span><span class="p">(</span><span class="n">sdf</span><span class="p">,</span> <span class="n">index_col</span><span class="p">)</span>
            <span class="n">other_sdf</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">_internal</span><span class="o">.</span><span class="n">attach_distributed_sequence_column</span><span class="p">(</span>
                <span class="n">other_sdf</span><span class="p">,</span> <span class="n">index_col</span>
            <span class="p">)</span>

        <span class="n">sdf</span> <span class="o">=</span> <span class="n">sdf</span><span class="o">.</span><span class="n">select</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">spark</span><span class="o">.</span><span class="n">column</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;L&quot;</span><span class="p">),</span>
            <span class="c1"># For the left side:</span>
            <span class="c1"># - We always select NATURAL_ORDER_COLUMN_NAME, to avoid having to regenerate it in the result</span>
            <span class="c1"># - We always select SPARK_DEFAULT_INDEX_NAME, to retain series index info</span>
            <span class="n">col</span><span class="p">(</span><span class="n">NATURAL_ORDER_COLUMN_NAME</span><span class="p">),</span>
            <span class="n">col</span><span class="p">(</span><span class="n">SPARK_DEFAULT_INDEX_NAME</span><span class="p">),</span>
        <span class="p">)</span>
        <span class="n">other_sdf</span> <span class="o">=</span> <span class="n">other_sdf</span><span class="o">.</span><span class="n">select</span><span class="p">(</span>
            <span class="n">other</span><span class="o">.</span><span class="n">spark</span><span class="o">.</span><span class="n">column</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;R&quot;</span><span class="p">),</span>
            <span class="c1"># for the right side, we only need the column that we are joining on</span>
            <span class="n">col</span><span class="p">(</span><span class="n">index_col</span><span class="p">),</span>
        <span class="p">)</span>

        <span class="n">joined_df</span> <span class="o">=</span> <span class="n">sdf</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">other_sdf</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="n">index_col</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;outer&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">default_val</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># ps.Series.fillna() doesn&#39;t always work for the output for some reason</span>
            <span class="c1"># so we manually handle the nulls here.</span>
            <span class="n">spark_col</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">when</span><span class="p">(</span>
                <span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;L&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">isNull</span><span class="p">()</span> <span class="o">|</span> <span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;R&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">isNull</span><span class="p">(),</span>
                <span class="n">default_val</span><span class="p">,</span>
            <span class="p">)</span><span class="o">.</span><span class="n">otherwise</span><span class="p">(</span><span class="n">spark_col</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_query_geometry_column</span><span class="p">(</span>
            <span class="n">spark_col</span><span class="p">,</span>
            <span class="n">joined_df</span><span class="p">,</span>
            <span class="n">returns_geom</span><span class="o">=</span><span class="n">returns_geom</span><span class="p">,</span>
            <span class="n">keep_name</span><span class="o">=</span><span class="n">keep_name</span><span class="p">,</span>
        <span class="p">)</span>

<div class="viewcode-block" id="GeoSeries.intersection_all">
<a class="viewcode-back" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.intersection_all">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">intersection_all</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Implementation of the abstract method.</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;This method is not implemented yet.&quot;</span><span class="p">)</span></div>


    <span class="c1"># ============================================================================</span>
    <span class="c1"># SPATIAL PREDICATES</span>
    <span class="c1"># ============================================================================</span>

<div class="viewcode-block" id="GeoSeries.contains">
<a class="viewcode-back" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.contains">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">contains</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pspd</span><span class="o">.</span><span class="n">Series</span><span class="p">:</span>
        <span class="n">other</span><span class="p">,</span> <span class="n">extended</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_series_of_val</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
        <span class="n">align</span> <span class="o">=</span> <span class="kc">False</span> <span class="k">if</span> <span class="n">extended</span> <span class="k">else</span> <span class="n">align</span>

        <span class="n">spark_col</span> <span class="o">=</span> <span class="n">stp</span><span class="o">.</span><span class="n">ST_Contains</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;L&quot;</span><span class="p">),</span> <span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;R&quot;</span><span class="p">))</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_row_wise_operation</span><span class="p">(</span>
            <span class="n">spark_col</span><span class="p">,</span>
            <span class="n">other</span><span class="p">,</span>
            <span class="n">align</span><span class="p">,</span>
            <span class="n">returns_geom</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">default_val</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">_to_bool</span><span class="p">(</span><span class="n">result</span><span class="p">)</span></div>


<div class="viewcode-block" id="GeoSeries.contains_properly">
<a class="viewcode-back" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.contains_properly">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">contains_properly</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="c1"># Implementation of the abstract method.</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
            <span class="n">_not_implemented_error</span><span class="p">(</span>
                <span class="s2">&quot;contains_properly&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Tests if geometries properly contain other geometries (no boundary contact).&quot;</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="GeoSeries.buffer">
<a class="viewcode-back" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.buffer">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">buffer</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">distance</span><span class="p">,</span>
        <span class="n">resolution</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span>
        <span class="n">cap_style</span><span class="o">=</span><span class="s2">&quot;round&quot;</span><span class="p">,</span>
        <span class="n">join_style</span><span class="o">=</span><span class="s2">&quot;round&quot;</span><span class="p">,</span>
        <span class="n">mitre_limit</span><span class="o">=</span><span class="mf">5.0</span><span class="p">,</span>
        <span class="n">single_sided</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;GeoSeries&quot;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">single_sided</span><span class="p">:</span>
            <span class="c1"># Reverse the following logic in common/src/main/java/org/apache/sedona/common/Functions.java buffer() to avoid negating the distance.</span>
            <span class="c1">#   if (bufferParameters.isSingleSided()</span>
            <span class="c1">#       &amp;&amp; (params.toLowerCase().contains(&quot;left&quot;) &amp;&amp; radius &lt; 0</span>
            <span class="c1">#           || params.toLowerCase().contains(&quot;right&quot;) &amp;&amp; radius &gt; 0)) {</span>
            <span class="c1">#     radius = -radius;</span>
            <span class="c1">#   }</span>
            <span class="n">side</span> <span class="o">=</span> <span class="s2">&quot;left&quot;</span> <span class="k">if</span> <span class="n">distance</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="k">else</span> <span class="s2">&quot;right&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">side</span> <span class="o">=</span> <span class="s2">&quot;both&quot;</span>
        <span class="k">assert</span> <span class="n">side</span> <span class="ow">in</span> <span class="p">[</span>
            <span class="s2">&quot;left&quot;</span><span class="p">,</span>
            <span class="s2">&quot;right&quot;</span><span class="p">,</span>
            <span class="s2">&quot;both&quot;</span><span class="p">,</span>
        <span class="p">],</span> <span class="s2">&quot;single-sided must be one of &#39;left&#39;, &#39;right&#39;, or &#39;both&#39;, True, or False&quot;</span>

        <span class="n">parameters</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;quad_segs=</span><span class="si">{</span><span class="n">resolution</span><span class="si">}</span><span class="s2"> endcap=</span><span class="si">{</span><span class="n">cap_style</span><span class="si">}</span><span class="s2"> join=</span><span class="si">{</span><span class="n">join_style</span><span class="si">}</span><span class="s2"> mitre_limit=</span><span class="si">{</span><span class="n">mitre_limit</span><span class="si">}</span><span class="s2"> side=</span><span class="si">{</span><span class="n">side</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>
        <span class="n">spark_col</span> <span class="o">=</span> <span class="n">stf</span><span class="o">.</span><span class="n">ST_Buffer</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">spark</span><span class="o">.</span><span class="n">column</span><span class="p">,</span> <span class="n">distance</span><span class="p">,</span> <span class="n">useSpheroid</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">parameters</span><span class="o">=</span><span class="n">parameters</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_query_geometry_column</span><span class="p">(</span>
            <span class="n">spark_col</span><span class="p">,</span>
            <span class="n">returns_geom</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="GeoSeries.simplify">
<a class="viewcode-back" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.simplify">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">simplify</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tolerance</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">preserve_topology</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;GeoSeries&quot;</span><span class="p">:</span>
        <span class="n">spark_expr</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">stf</span><span class="o">.</span><span class="n">ST_SimplifyPreserveTopology</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">spark</span><span class="o">.</span><span class="n">column</span><span class="p">,</span> <span class="n">tolerance</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">preserve_topology</span>
            <span class="k">else</span> <span class="n">stf</span><span class="o">.</span><span class="n">ST_Simplify</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">spark</span><span class="o">.</span><span class="n">column</span><span class="p">,</span> <span class="n">tolerance</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_query_geometry_column</span><span class="p">(</span><span class="n">spark_expr</span><span class="p">)</span></div>


<div class="viewcode-block" id="GeoSeries.plot">
<a class="viewcode-back" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.plot">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plot a GeoSeries.</span>

<span class="sd">        Generate a plot of a GeoSeries geometry with matplotlib.</span>

<span class="sd">        Note: This method is not scalable and requires collecting all data to the driver.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        s : Series</span>
<span class="sd">            The GeoSeries to be plotted. Currently Polygon,</span>
<span class="sd">            MultiPolygon, LineString, MultiLineString, Point and MultiPoint</span>
<span class="sd">            geometries can be plotted.</span>
<span class="sd">        cmap : str (default None)</span>
<span class="sd">            The name of a colormap recognized by matplotlib. Any</span>
<span class="sd">            colormap will work, but categorical colormaps are</span>
<span class="sd">            generally recommended. Examples of useful discrete</span>
<span class="sd">            colormaps include:</span>

<span class="sd">                tab10, tab20, Accent, Dark2, Paired, Pastel1, Set1, Set2</span>

<span class="sd">        color : str, np.array, pd.Series, List (default None)</span>
<span class="sd">            If specified, all objects will be colored uniformly.</span>
<span class="sd">        ax : matplotlib.pyplot.Artist (default None)</span>
<span class="sd">            axes on which to draw the plot</span>
<span class="sd">        figsize : pair of floats (default None)</span>
<span class="sd">            Size of the resulting matplotlib.figure.Figure. If the argument</span>
<span class="sd">            ax is given explicitly, figsize is ignored.</span>
<span class="sd">        aspect : &#39;auto&#39;, &#39;equal&#39;, None or float (default &#39;auto&#39;)</span>
<span class="sd">            Set aspect of axis. If &#39;auto&#39;, the default aspect for map plots is &#39;equal&#39;; if</span>
<span class="sd">            however data are not projected (coordinates are long/lat), the aspect is by</span>
<span class="sd">            default set to 1/cos(s_y * pi/180) with s_y the y coordinate of the middle of</span>
<span class="sd">            the GeoSeries (the mean of the y range of bounding box) so that a long/lat</span>
<span class="sd">            square appears square in the middle of the plot. This implies an</span>
<span class="sd">            Equirectangular projection. If None, the aspect of `ax` won&#39;t be changed. It can</span>
<span class="sd">            also be set manually (float) as the ratio of y-unit to x-unit.</span>
<span class="sd">        autolim : bool (default True)</span>
<span class="sd">            Update axes data limits to contain the new geometries.</span>
<span class="sd">        **style_kwds : dict</span>
<span class="sd">            Color options to be passed on to the actual plot function, such</span>
<span class="sd">            as ``edgecolor``, ``facecolor``, ``linewidth``, ``markersize``,</span>
<span class="sd">            ``alpha``.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        ax : matplotlib axes instance</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_geopandas</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">geometry</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;GeoSeries&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="c1"># GeoSeries-only (not in GeoDataFrame)</span>
    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">x</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pspd</span><span class="o">.</span><span class="n">Series</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the x location of point geometries in a GeoSeries</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        pandas.Series</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>

<span class="sd">        &gt;&gt;&gt; from sedona.spark.geopandas import GeoSeries</span>
<span class="sd">        &gt;&gt;&gt; from shapely.geometry import Point</span>
<span class="sd">        &gt;&gt;&gt; s = GeoSeries([Point(1, 1), Point(2, 2), Point(3, 3)])</span>
<span class="sd">        &gt;&gt;&gt; s.x</span>
<span class="sd">        0    1.0</span>
<span class="sd">        1    2.0</span>
<span class="sd">        2    3.0</span>
<span class="sd">        dtype: float64</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>

<span class="sd">        GeoSeries.y</span>
<span class="sd">        GeoSeries.z</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">spark_col</span> <span class="o">=</span> <span class="n">stf</span><span class="o">.</span><span class="n">ST_X</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">spark</span><span class="o">.</span><span class="n">column</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_query_geometry_column</span><span class="p">(</span>
            <span class="n">spark_col</span><span class="p">,</span>
            <span class="n">returns_geom</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="c1"># GeoSeries-only (not in GeoDataFrame)</span>
    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">y</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pspd</span><span class="o">.</span><span class="n">Series</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the y location of point geometries in a GeoSeries</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        pandas.Series</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>

<span class="sd">        &gt;&gt;&gt; from sedona.spark.geopandas import GeoSeries</span>
<span class="sd">        &gt;&gt;&gt; from shapely.geometry import Point</span>
<span class="sd">        &gt;&gt;&gt; s = GeoSeries([Point(1, 1), Point(2, 2), Point(3, 3)])</span>
<span class="sd">        &gt;&gt;&gt; s.y</span>
<span class="sd">        0    1.0</span>
<span class="sd">        1    2.0</span>
<span class="sd">        2    3.0</span>
<span class="sd">        dtype: float64</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>

<span class="sd">        GeoSeries.x</span>
<span class="sd">        GeoSeries.z</span>
<span class="sd">        GeoSeries.m</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">spark_col</span> <span class="o">=</span> <span class="n">stf</span><span class="o">.</span><span class="n">ST_Y</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">spark</span><span class="o">.</span><span class="n">column</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_query_geometry_column</span><span class="p">(</span>
            <span class="n">spark_col</span><span class="p">,</span>
            <span class="n">returns_geom</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="c1"># GeoSeries-only (not in GeoDataFrame)</span>
    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">z</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pspd</span><span class="o">.</span><span class="n">Series</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the z location of point geometries in a GeoSeries</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        pandas.Series</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>

<span class="sd">        &gt;&gt;&gt; from sedona.spark.geopandas import GeoSeries</span>
<span class="sd">        &gt;&gt;&gt; from shapely.geometry import Point</span>
<span class="sd">        &gt;&gt;&gt; s = GeoSeries([Point(1, 1, 1), Point(2, 2, 2), Point(3, 3, 3)])</span>
<span class="sd">        &gt;&gt;&gt; s.z</span>
<span class="sd">        0    1.0</span>
<span class="sd">        1    2.0</span>
<span class="sd">        2    3.0</span>
<span class="sd">        dtype: float64</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>

<span class="sd">        GeoSeries.x</span>
<span class="sd">        GeoSeries.y</span>
<span class="sd">        GeoSeries.m</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">spark_col</span> <span class="o">=</span> <span class="n">stf</span><span class="o">.</span><span class="n">ST_Z</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">spark</span><span class="o">.</span><span class="n">column</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_query_geometry_column</span><span class="p">(</span>
            <span class="n">spark_col</span><span class="p">,</span>
            <span class="n">returns_geom</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="c1"># GeoSeries-only (not in GeoDataFrame)</span>
    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">m</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pspd</span><span class="o">.</span><span class="n">Series</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;GeoSeries.m() is not implemented yet.&quot;</span><span class="p">)</span>

    <span class="c1"># ============================================================================</span>
    <span class="c1"># CONSTRUCTION METHODS</span>
    <span class="c1"># ============================================================================</span>

    <span class="c1"># GeoSeries-only (not in GeoDataFrame)</span>
<div class="viewcode-block" id="GeoSeries.from_file">
<a class="viewcode-back" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.from_file">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">from_file</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">format</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;GeoSeries&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Alternate constructor to create a ``GeoDataFrame`` from a file.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        filename : str</span>
<span class="sd">            File path or file handle to read from. If the path is a directory,</span>
<span class="sd">            Sedona will read all files in that directory.</span>
<span class="sd">        format : str, optional</span>
<span class="sd">            The format of the file to read, by default None. If None, Sedona</span>
<span class="sd">            infers the format from the file extension. Note that format</span>
<span class="sd">            inference is not supported for directories. Available formats are</span>
<span class="sd">            &quot;shapefile&quot;, &quot;geojson&quot;, &quot;geopackage&quot;, and &quot;geoparquet&quot;.</span>
<span class="sd">        table_name : str, optional</span>
<span class="sd">            The name of the table to read from a GeoPackage file, by default</span>
<span class="sd">            None. This is required if ``format`` is &quot;geopackage&quot;.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        GeoDataFrame.to_file : Write a ``GeoDataFrame`` to a file.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">sgpd</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="nb">format</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">GeoSeries</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">geometry</span><span class="p">,</span> <span class="n">crs</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">crs</span><span class="p">)</span></div>


    <span class="c1"># GeoSeries-only (not in GeoDataFrame)</span>
<div class="viewcode-block" id="GeoSeries.from_wkb">
<a class="viewcode-back" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.from_wkb">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">from_wkb</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span>
        <span class="n">data</span><span class="p">,</span>
        <span class="n">index</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">crs</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">on_invalid</span><span class="o">=</span><span class="s2">&quot;raise&quot;</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;GeoSeries&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Alternate constructor to create a ``GeoSeries``</span>
<span class="sd">        from a list or array of WKB objects</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        data : array-like or Series</span>
<span class="sd">            Series, list or array of WKB objects</span>
<span class="sd">        index : array-like or Index</span>
<span class="sd">            The index for the GeoSeries.</span>
<span class="sd">        crs : value, optional</span>
<span class="sd">            Coordinate Reference System of the geometry objects. Can be anything</span>
<span class="sd">            accepted by</span>
<span class="sd">            :meth:`pyproj.CRS.from_user_input() &lt;pyproj.crs.CRS.from_user_input&gt;`,</span>
<span class="sd">            such as an authority string (eg &quot;EPSG:4326&quot;) or a WKT string.</span>
<span class="sd">        on_invalid: {&quot;raise&quot;, &quot;warn&quot;, &quot;ignore&quot;}, default &quot;raise&quot;</span>
<span class="sd">            - raise: an exception will be raised if a WKB input geometry is invalid.</span>
<span class="sd">            - warn: a warning will be raised and invalid WKB geometries will be returned</span>
<span class="sd">              as None.</span>
<span class="sd">            - ignore: invalid WKB geometries will be returned as None without a warning.</span>
<span class="sd">            - fix: an effort is made to fix invalid input geometries (e.g. close</span>
<span class="sd">              unclosed rings). If this is not possible, they are returned as ``None``</span>
<span class="sd">              without a warning. Requires GEOS &gt;= 3.11 and shapely &gt;= 2.1.</span>

<span class="sd">        kwargs</span>
<span class="sd">            Additional arguments passed to the Series constructor,</span>
<span class="sd">            e.g. ``name``.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        GeoSeries</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        GeoSeries.from_wkt</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>

<span class="sd">        &gt;&gt;&gt; wkbs = [</span>
<span class="sd">        ... (</span>
<span class="sd">        ...     b&quot;\x01\x01\x00\x00\x00\x00\x00\x00\x00&quot;</span>
<span class="sd">        ...     b&quot;\x00\x00\xf0?\x00\x00\x00\x00\x00\x00\xf0?&quot;</span>
<span class="sd">        ... ),</span>
<span class="sd">        ... (</span>
<span class="sd">        ...     b&quot;\x01\x01\x00\x00\x00\x00\x00\x00\x00&quot;</span>
<span class="sd">        ...     b&quot;\x00\x00\x00@\x00\x00\x00\x00\x00\x00\x00@&quot;</span>
<span class="sd">        ... ),</span>
<span class="sd">        ... (</span>
<span class="sd">        ...    b&quot;\x01\x01\x00\x00\x00\x00\x00\x00\x00\x00&quot;</span>
<span class="sd">        ...    b&quot;\x00\x08@\x00\x00\x00\x00\x00\x00\x08@&quot;</span>
<span class="sd">        ... ),</span>
<span class="sd">        ... ]</span>
<span class="sd">        &gt;&gt;&gt; s = GeoSeries.from_wkb(wkbs)</span>
<span class="sd">        &gt;&gt;&gt; s</span>
<span class="sd">        0    POINT (1 1)</span>
<span class="sd">        1    POINT (2 2)</span>
<span class="sd">        2    POINT (3 3)</span>
<span class="sd">        dtype: geometry</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">on_invalid</span> <span class="o">!=</span> <span class="s2">&quot;raise&quot;</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
                <span class="s2">&quot;GeoSeries.from_wkb(): only on_invalid=&#39;raise&#39; is implemented&quot;</span>
            <span class="p">)</span>

        <span class="kn">from</span><span class="w"> </span><span class="nn">pyspark.sql.types</span><span class="w"> </span><span class="kn">import</span> <span class="n">StructType</span><span class="p">,</span> <span class="n">StructField</span><span class="p">,</span> <span class="n">BinaryType</span>

        <span class="n">schema</span> <span class="o">=</span> <span class="n">StructType</span><span class="p">([</span><span class="n">StructField</span><span class="p">(</span><span class="s2">&quot;data&quot;</span><span class="p">,</span> <span class="n">BinaryType</span><span class="p">(),</span> <span class="kc">True</span><span class="p">)])</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_create_from_select</span><span class="p">(</span>
            <span class="n">stc</span><span class="o">.</span><span class="n">ST_GeomFromWKB</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;data&quot;</span><span class="p">)),</span>
            <span class="n">data</span><span class="p">,</span>
            <span class="n">schema</span><span class="p">,</span>
            <span class="n">index</span><span class="p">,</span>
            <span class="n">crs</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span></div>


    <span class="c1"># GeoSeries-only (not in GeoDataFrame)</span>
<div class="viewcode-block" id="GeoSeries.from_wkt">
<a class="viewcode-back" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.from_wkt">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">from_wkt</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span>
        <span class="n">data</span><span class="p">,</span>
        <span class="n">index</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">crs</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">on_invalid</span><span class="o">=</span><span class="s2">&quot;raise&quot;</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;GeoSeries&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Alternate constructor to create a ``GeoSeries``</span>
<span class="sd">        from a list or array of WKT objects</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        data : array-like, Series</span>
<span class="sd">            Series, list, or array of WKT objects</span>
<span class="sd">        index : array-like or Index</span>
<span class="sd">            The index for the GeoSeries.</span>
<span class="sd">        crs : value, optional</span>
<span class="sd">            Coordinate Reference System of the geometry objects. Can be anything</span>
<span class="sd">            accepted by</span>
<span class="sd">            :meth:`pyproj.CRS.from_user_input() &lt;pyproj.crs.CRS.from_user_input&gt;`,</span>
<span class="sd">            such as an authority string (eg &quot;EPSG:4326&quot;) or a WKT string.</span>
<span class="sd">        on_invalid : {&quot;raise&quot;, &quot;warn&quot;, &quot;ignore&quot;}, default &quot;raise&quot;</span>
<span class="sd">            - raise: an exception will be raised if a WKT input geometry is invalid.</span>
<span class="sd">            - warn: a warning will be raised and invalid WKT geometries will be</span>
<span class="sd">              returned as ``None``.</span>
<span class="sd">            - ignore: invalid WKT geometries will be returned as ``None`` without a</span>
<span class="sd">              warning.</span>
<span class="sd">            - fix: an effort is made to fix invalid input geometries (e.g. close</span>
<span class="sd">              unclosed rings). If this is not possible, they are returned as ``None``</span>
<span class="sd">              without a warning. Requires GEOS &gt;= 3.11 and shapely &gt;= 2.1.</span>

<span class="sd">        kwargs</span>
<span class="sd">            Additional arguments passed to the Series constructor,</span>
<span class="sd">            e.g. ``name``.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        GeoSeries</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        GeoSeries.from_wkb</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>

<span class="sd">        &gt;&gt;&gt; from sedona.spark.geopandas import GeoSeries</span>
<span class="sd">        &gt;&gt;&gt; wkts = [</span>
<span class="sd">        ... &#39;POINT (1 1)&#39;,</span>
<span class="sd">        ... &#39;POINT (2 2)&#39;,</span>
<span class="sd">        ... &#39;POINT (3 3)&#39;,</span>
<span class="sd">        ... ]</span>
<span class="sd">        &gt;&gt;&gt; s = GeoSeries.from_wkt(wkts)</span>
<span class="sd">        &gt;&gt;&gt; s</span>
<span class="sd">        0    POINT (1 1)</span>
<span class="sd">        1    POINT (2 2)</span>
<span class="sd">        2    POINT (3 3)</span>
<span class="sd">        dtype: geometry</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">on_invalid</span> <span class="o">!=</span> <span class="s2">&quot;raise&quot;</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
                <span class="s2">&quot;GeoSeries.from_wkt(): only on_invalid=&#39;raise&#39; is implemented&quot;</span>
            <span class="p">)</span>

        <span class="kn">from</span><span class="w"> </span><span class="nn">pyspark.sql.types</span><span class="w"> </span><span class="kn">import</span> <span class="n">StructType</span><span class="p">,</span> <span class="n">StructField</span><span class="p">,</span> <span class="n">StringType</span>

        <span class="n">schema</span> <span class="o">=</span> <span class="n">StructType</span><span class="p">([</span><span class="n">StructField</span><span class="p">(</span><span class="s2">&quot;data&quot;</span><span class="p">,</span> <span class="n">StringType</span><span class="p">(),</span> <span class="kc">True</span><span class="p">)])</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_create_from_select</span><span class="p">(</span>
            <span class="n">stc</span><span class="o">.</span><span class="n">ST_GeomFromText</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;data&quot;</span><span class="p">)),</span>
            <span class="n">data</span><span class="p">,</span>
            <span class="n">schema</span><span class="p">,</span>
            <span class="n">index</span><span class="p">,</span>
            <span class="n">crs</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span></div>


    <span class="c1"># GeoSeries-only (not in GeoDataFrame)</span>
<div class="viewcode-block" id="GeoSeries.from_xy">
<a class="viewcode-back" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.from_xy">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">from_xy</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">crs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;GeoSeries&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Alternate constructor to create a :class:`~geopandas.GeoSeries` of Point</span>
<span class="sd">        geometries from lists or arrays of x, y(, z) coordinates</span>

<span class="sd">        In case of geographic coordinates, it is assumed that longitude is captured</span>
<span class="sd">        by ``x`` coordinates and latitude by ``y``.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        x, y, z : iterable</span>
<span class="sd">        index : array-like or Index, optional</span>
<span class="sd">            The index for the GeoSeries. If not given and all coordinate inputs</span>
<span class="sd">            are Series with an equal index, that index is used.</span>
<span class="sd">        crs : value, optional</span>
<span class="sd">            Coordinate Reference System of the geometry objects. Can be anything</span>
<span class="sd">            accepted by</span>
<span class="sd">            :meth:`pyproj.CRS.from_user_input() &lt;pyproj.crs.CRS.from_user_input&gt;`,</span>
<span class="sd">            such as an authority string (eg &quot;EPSG:4326&quot;) or a WKT string.</span>
<span class="sd">        **kwargs</span>
<span class="sd">            Additional arguments passed to the Series constructor,</span>
<span class="sd">            e.g. ``name``.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        GeoSeries</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        GeoSeries.from_wkt</span>
<span class="sd">        points_from_xy</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>

<span class="sd">        &gt;&gt;&gt; x = [2.5, 5, -3.0]</span>
<span class="sd">        &gt;&gt;&gt; y = [0.5, 1, 1.5]</span>
<span class="sd">        &gt;&gt;&gt; s = GeoSeries.from_xy(x, y, crs=&quot;EPSG:4326&quot;)</span>
<span class="sd">        &gt;&gt;&gt; s</span>
<span class="sd">        0    POINT (2.5 0.5)</span>
<span class="sd">        1    POINT (5 1)</span>
<span class="sd">        2    POINT (-3 1.5)</span>
<span class="sd">        dtype: geometry</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">pyspark.sql.types</span><span class="w"> </span><span class="kn">import</span> <span class="n">StructType</span><span class="p">,</span> <span class="n">StructField</span><span class="p">,</span> <span class="n">DoubleType</span>

        <span class="n">schema</span> <span class="o">=</span> <span class="n">StructType</span><span class="p">(</span>
            <span class="p">[</span><span class="n">StructField</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">DoubleType</span><span class="p">(),</span> <span class="kc">True</span><span class="p">),</span> <span class="n">StructField</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="n">DoubleType</span><span class="p">(),</span> <span class="kc">True</span><span class="p">)]</span>
        <span class="p">)</span>

        <span class="c1"># Spark doesn&#39;t automatically cast ints to floats for us</span>
        <span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">num</span><span class="p">)</span> <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="n">x</span><span class="p">]</span>
        <span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">num</span><span class="p">)</span> <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="n">y</span><span class="p">]</span>
        <span class="n">z</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">num</span><span class="p">)</span> <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="n">z</span><span class="p">]</span> <span class="k">if</span> <span class="n">z</span> <span class="k">else</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="n">z</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">))</span>
            <span class="n">select</span> <span class="o">=</span> <span class="n">stc</span><span class="o">.</span><span class="n">ST_PointZ</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">),</span> <span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">),</span> <span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;z&quot;</span><span class="p">))</span>
            <span class="n">schema</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">StructField</span><span class="p">(</span><span class="s2">&quot;z&quot;</span><span class="p">,</span> <span class="n">DoubleType</span><span class="p">(),</span> <span class="kc">True</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>
            <span class="n">select</span> <span class="o">=</span> <span class="n">stc</span><span class="o">.</span><span class="n">ST_Point</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">),</span> <span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">))</span>

        <span class="n">geoseries</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_create_from_select</span><span class="p">(</span>
            <span class="n">select</span><span class="p">,</span>
            <span class="n">data</span><span class="p">,</span>
            <span class="n">schema</span><span class="p">,</span>
            <span class="n">index</span><span class="p">,</span>
            <span class="n">crs</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">crs</span><span class="p">:</span>
            <span class="kn">from</span><span class="w"> </span><span class="nn">pyproj</span><span class="w"> </span><span class="kn">import</span> <span class="n">CRS</span>

            <span class="n">geoseries</span><span class="o">.</span><span class="n">crs</span> <span class="o">=</span> <span class="n">CRS</span><span class="o">.</span><span class="n">from_user_input</span><span class="p">(</span><span class="n">crs</span><span class="p">)</span><span class="o">.</span><span class="n">to_epsg</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">geoseries</span></div>


<div class="viewcode-block" id="GeoSeries.from_shapely">
<a class="viewcode-back" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.from_shapely">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">from_shapely</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">crs</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;GeoSeries&quot;</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
            <span class="n">_not_implemented_error</span><span class="p">(</span>
                <span class="s2">&quot;from_shapely&quot;</span><span class="p">,</span> <span class="s2">&quot;Creates GeoSeries from Shapely geometry objects.&quot;</span>
            <span class="p">)</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="GeoSeries.from_arrow">
<a class="viewcode-back" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.from_arrow">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">from_arrow</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">arr</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;GeoSeries&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Construct a GeoSeries from a Arrow array object with a GeoArrow</span>
<span class="sd">        extension type.</span>

<span class="sd">        See https://geoarrow.org/ for details on the GeoArrow specification.</span>

<span class="sd">        This functions accepts any Arrow array object implementing</span>
<span class="sd">        the `Arrow PyCapsule Protocol`_ (i.e. having an ``__arrow_c_array__``</span>
<span class="sd">        method).</span>

<span class="sd">        .. _Arrow PyCapsule Protocol: https://arrow.apache.org/docs/format/CDataInterface/PyCapsuleInterface.html</span>

<span class="sd">        Note: Requires geopandas versions &gt;= 1.0.0 to use with Sedona.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        arr : pyarrow.Array, Arrow array</span>
<span class="sd">            Any array object implementing the Arrow PyCapsule Protocol</span>
<span class="sd">            (i.e. has an ``__arrow_c_array__`` or ``__arrow_c_stream__``</span>
<span class="sd">            method). The type of the array should be one of the</span>
<span class="sd">            geoarrow geometry types.</span>
<span class="sd">        **kwargs</span>
<span class="sd">            Other parameters passed to the GeoSeries constructor.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        GeoSeries</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        GeoSeries.to_arrow</span>
<span class="sd">        GeoDataFrame.from_arrow</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>

<span class="sd">        &gt;&gt;&gt; from sedona.spark.geopandas import GeoSeries</span>
<span class="sd">        &gt;&gt;&gt; import geoarrow.pyarrow as ga</span>
<span class="sd">        &gt;&gt;&gt; array = ga.as_geoarrow([None, &quot;POLYGON ((0 0, 1 1, 0 1, 0 0))&quot;, &quot;LINESTRING (0 0, -1 1, 0 -1)&quot;])</span>
<span class="sd">        &gt;&gt;&gt; geoseries = GeoSeries.from_arrow(array)</span>
<span class="sd">        &gt;&gt;&gt; geoseries</span>
<span class="sd">        0                              None</span>
<span class="sd">        1    POLYGON ((0 0, 1 1, 0 1, 0 0))</span>
<span class="sd">        2      LINESTRING (0 0, -1 1, 0 -1)</span>
<span class="sd">        dtype: geometry</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">gpd_series</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoSeries</span><span class="o">.</span><span class="n">from_arrow</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">GeoSeries</span><span class="p">(</span><span class="n">gpd_series</span><span class="p">)</span></div>


    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_create_from_select</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span> <span class="n">spark_col</span><span class="p">:</span> <span class="n">PySparkColumn</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">schema</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">crs</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;GeoSeries&quot;</span><span class="p">:</span>

        <span class="kn">from</span><span class="w"> </span><span class="nn">pyspark.pandas.utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">default_session</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">pyspark.pandas.internal</span><span class="w"> </span><span class="kn">import</span> <span class="n">InternalField</span>
        <span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="p">(</span><span class="nb">tuple</span><span class="p">,</span> <span class="nb">list</span><span class="p">)):</span>
            <span class="n">data</span> <span class="o">=</span> <span class="p">[(</span><span class="n">obj</span><span class="p">,)</span> <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">data</span><span class="p">]</span>

        <span class="n">name</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="n">SPARK_DEFAULT_SERIES_NAME</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">pspd</span><span class="o">.</span><span class="n">Series</span><span class="p">):</span>
            <span class="n">spark_df</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">_internal</span><span class="o">.</span><span class="n">spark_frame</span>
            <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">schema</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>
            <span class="n">spark_df</span> <span class="o">=</span> <span class="n">spark_df</span><span class="o">.</span><span class="n">withColumnRenamed</span><span class="p">(</span>
                <span class="n">_get_series_col_name</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="n">schema</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">name</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">spark_df</span> <span class="o">=</span> <span class="n">default_session</span><span class="p">()</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">schema</span><span class="o">=</span><span class="n">schema</span><span class="p">)</span>

        <span class="n">spark_df</span> <span class="o">=</span> <span class="n">spark_df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">spark_col</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="n">name</span><span class="p">))</span>

        <span class="n">internal</span> <span class="o">=</span> <span class="n">InternalFrame</span><span class="p">(</span>
            <span class="n">spark_frame</span><span class="o">=</span><span class="n">spark_df</span><span class="p">,</span>
            <span class="n">index_spark_columns</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">column_labels</span><span class="o">=</span><span class="p">[(</span><span class="n">name</span><span class="p">,)],</span>
            <span class="n">data_spark_columns</span><span class="o">=</span><span class="p">[</span><span class="n">scol_for</span><span class="p">(</span><span class="n">spark_df</span><span class="p">,</span> <span class="n">name</span><span class="p">)],</span>
            <span class="n">data_fields</span><span class="o">=</span><span class="p">[</span><span class="n">InternalField</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dtype</span><span class="p">(</span><span class="s2">&quot;object&quot;</span><span class="p">),</span> <span class="n">spark_df</span><span class="o">.</span><span class="n">schema</span><span class="p">[</span><span class="n">name</span><span class="p">])],</span>
            <span class="n">column_label_names</span><span class="o">=</span><span class="p">[(</span><span class="n">name</span><span class="p">,)],</span>
        <span class="p">)</span>
        <span class="n">ps_series</span> <span class="o">=</span> <span class="n">first_series</span><span class="p">(</span><span class="n">PandasOnSparkDataFrame</span><span class="p">(</span><span class="n">internal</span><span class="p">))</span>
        <span class="n">name</span> <span class="o">=</span> <span class="kc">None</span> <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="n">SPARK_DEFAULT_SERIES_NAME</span> <span class="k">else</span> <span class="n">name</span>
        <span class="n">ps_series</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">GeoSeries</span><span class="p">(</span><span class="n">ps_series</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">crs</span><span class="o">=</span><span class="n">crs</span><span class="p">)</span>

    <span class="c1"># ============================================================================</span>
    <span class="c1"># DATA ACCESS AND MANIPULATION</span>
    <span class="c1"># ============================================================================</span>

    <span class="c1"># GeoSeries-only (not in GeoDataFrame)</span>
<div class="viewcode-block" id="GeoSeries.isna">
<a class="viewcode-back" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.isna">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">isna</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pspd</span><span class="o">.</span><span class="n">Series</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Detect missing values.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        A boolean Series of the same size as the GeoSeries,</span>
<span class="sd">        True where a value is NA.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>

<span class="sd">        &gt;&gt;&gt; from sedona.spark.geopandas import GeoSeries</span>
<span class="sd">        &gt;&gt;&gt; from shapely.geometry import Polygon</span>
<span class="sd">        &gt;&gt;&gt; s = GeoSeries(</span>
<span class="sd">        ...     [Polygon([(0, 0), (1, 1), (0, 1)]), None, Polygon([])]</span>
<span class="sd">        ... )</span>
<span class="sd">        &gt;&gt;&gt; s</span>
<span class="sd">        0    POLYGON ((0 0, 1 1, 0 1, 0 0))</span>
<span class="sd">        1                              None</span>
<span class="sd">        2                     POLYGON EMPTY</span>
<span class="sd">        dtype: geometry</span>

<span class="sd">        &gt;&gt;&gt; s.isna()</span>
<span class="sd">        0    False</span>
<span class="sd">        1     True</span>
<span class="sd">        2    False</span>
<span class="sd">        dtype: bool</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        GeoSeries.notna : inverse of isna</span>
<span class="sd">        GeoSeries.is_empty : detect empty geometries</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">spark_expr</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">isnull</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">spark</span><span class="o">.</span><span class="n">column</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_query_geometry_column</span><span class="p">(</span>
            <span class="n">spark_expr</span><span class="p">,</span>
            <span class="n">returns_geom</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">_to_bool</span><span class="p">(</span><span class="n">result</span><span class="p">)</span></div>


    <span class="c1"># GeoSeries-only (not in GeoDataFrame)</span>
<div class="viewcode-block" id="GeoSeries.isnull">
<a class="viewcode-back" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.isnull">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">isnull</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pspd</span><span class="o">.</span><span class="n">Series</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Alias for `isna` method. See `isna` for more detail.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span></div>


    <span class="c1"># GeoSeries-only (not in GeoDataFrame)</span>
<div class="viewcode-block" id="GeoSeries.notna">
<a class="viewcode-back" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.notna">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">notna</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pspd</span><span class="o">.</span><span class="n">Series</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Detect non-missing values.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        A boolean pandas Series of the same size as the GeoSeries,</span>
<span class="sd">        False where a value is NA.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>

<span class="sd">        &gt;&gt;&gt; from sedona.spark.geopandas import GeoSeries</span>
<span class="sd">        &gt;&gt;&gt; from shapely.geometry import Polygon</span>
<span class="sd">        &gt;&gt;&gt; s = GeoSeries(</span>
<span class="sd">        ...     [Polygon([(0, 0), (1, 1), (0, 1)]), None, Polygon([])]</span>
<span class="sd">        ... )</span>
<span class="sd">        &gt;&gt;&gt; s</span>
<span class="sd">        0    POLYGON ((0 0, 1 1, 0 1, 0 0))</span>
<span class="sd">        1                              None</span>
<span class="sd">        2                     POLYGON EMPTY</span>
<span class="sd">        dtype: geometry</span>

<span class="sd">        &gt;&gt;&gt; s.notna()</span>
<span class="sd">        0     True</span>
<span class="sd">        1    False</span>
<span class="sd">        2     True</span>
<span class="sd">        dtype: bool</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        GeoSeries.isna : inverse of notna</span>
<span class="sd">        GeoSeries.is_empty : detect empty geometries</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># After Sedona&#39;s minimum Spark version is 3.5.0, we can use F.isnotnull(self.spark.column) instead.</span>
        <span class="n">spark_expr</span> <span class="o">=</span> <span class="o">~</span><span class="n">F</span><span class="o">.</span><span class="n">isnull</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">spark</span><span class="o">.</span><span class="n">column</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_query_geometry_column</span><span class="p">(</span>
            <span class="n">spark_expr</span><span class="p">,</span>
            <span class="n">returns_geom</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">_to_bool</span><span class="p">(</span><span class="n">result</span><span class="p">)</span></div>


    <span class="c1"># GeoSeries-only (not in GeoDataFrame)</span>
<div class="viewcode-block" id="GeoSeries.notnull">
<a class="viewcode-back" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.notnull">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">notnull</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pspd</span><span class="o">.</span><span class="n">Series</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Alias for `notna` method. See `notna` for more detail.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">notna</span><span class="p">()</span></div>


    <span class="c1"># GeoSeries-only (not in GeoDataFrame)</span>
<div class="viewcode-block" id="GeoSeries.fillna">
<a class="viewcode-back" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.fillna">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">fillna</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">inplace</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="s2">&quot;GeoSeries&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Fill NA values with geometry (or geometries).</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        value : shapely geometry or GeoSeries, default None</span>
<span class="sd">            If None is passed, NA values will be filled with GEOMETRYCOLLECTION EMPTY.</span>
<span class="sd">            If a shapely geometry object is passed, it will be</span>
<span class="sd">            used to fill all missing values. If a ``GeoSeries``</span>
<span class="sd">            is passed, missing values will be filled based on the corresponding index</span>
<span class="sd">            locations. If pd.NA or np.nan are passed, values will be filled with</span>
<span class="sd">            ``None`` (not GEOMETRYCOLLECTION EMPTY).</span>
<span class="sd">        limit : int, default None</span>
<span class="sd">            This is the maximum number of entries along the entire axis</span>
<span class="sd">            where NaNs will be filled. Must be greater than 0 if not None.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        GeoSeries</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>

<span class="sd">        &gt;&gt;&gt; from sedona.spark.geopandas import GeoSeries</span>
<span class="sd">        &gt;&gt;&gt; from shapely.geometry import Polygon</span>
<span class="sd">        &gt;&gt;&gt; s = GeoSeries(</span>
<span class="sd">        ...     [</span>
<span class="sd">        ...         Polygon([(0, 0), (1, 1), (0, 1)]),</span>
<span class="sd">        ...         None,</span>
<span class="sd">        ...         Polygon([(0, 0), (-1, 1), (0, -1)]),</span>
<span class="sd">        ...     ]</span>
<span class="sd">        ... )</span>
<span class="sd">        &gt;&gt;&gt; s</span>
<span class="sd">        0      POLYGON ((0 0, 1 1, 0 1, 0 0))</span>
<span class="sd">        1                                None</span>
<span class="sd">        2    POLYGON ((0 0, -1 1, 0 -1, 0 0))</span>
<span class="sd">        dtype: geometry</span>

<span class="sd">        Filled with an empty polygon.</span>

<span class="sd">        &gt;&gt;&gt; s.fillna()</span>
<span class="sd">        0      POLYGON ((0 0, 1 1, 0 1, 0 0))</span>
<span class="sd">        1            GEOMETRYCOLLECTION EMPTY</span>
<span class="sd">        2    POLYGON ((0 0, -1 1, 0 -1, 0 0))</span>
<span class="sd">        dtype: geometry</span>

<span class="sd">        Filled with a specific polygon.</span>

<span class="sd">        &gt;&gt;&gt; s.fillna(Polygon([(0, 1), (2, 1), (1, 2)]))</span>
<span class="sd">        0      POLYGON ((0 0, 1 1, 0 1, 0 0))</span>
<span class="sd">        1      POLYGON ((0 1, 2 1, 1 2, 0 1))</span>
<span class="sd">        2    POLYGON ((0 0, -1 1, 0 -1, 0 0))</span>
<span class="sd">        dtype: geometry</span>

<span class="sd">        Filled with another GeoSeries.</span>

<span class="sd">        &gt;&gt;&gt; from shapely.geometry import Point</span>
<span class="sd">        &gt;&gt;&gt; s_fill = GeoSeries(</span>
<span class="sd">        ...     [</span>
<span class="sd">        ...         Point(0, 0),</span>
<span class="sd">        ...         Point(1, 1),</span>
<span class="sd">        ...         Point(2, 2),</span>
<span class="sd">        ...     ]</span>
<span class="sd">        ... )</span>
<span class="sd">        &gt;&gt;&gt; s.fillna(s_fill)</span>
<span class="sd">        0      POLYGON ((0 0, 1 1, 0 1, 0 0))</span>
<span class="sd">        1                         POINT (1 1)</span>
<span class="sd">        2    POLYGON ((0 0, -1 1, 0 -1, 0 0))</span>
<span class="sd">        dtype: geometry</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        GeoSeries.isna : detect missing values</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">shapely.geometry.base</span><span class="w"> </span><span class="kn">import</span> <span class="n">BaseGeometry</span>

        <span class="c1"># TODO: Implement limit https://github.com/apache/sedona/issues/2068</span>
        <span class="k">if</span> <span class="n">limit</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
                <span class="s2">&quot;GeoSeries.fillna() with limit is not implemented yet.&quot;</span>
            <span class="p">)</span>

        <span class="n">align</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">==</span> <span class="kc">True</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">BaseGeometry</span><span class="p">):</span>
            <span class="k">if</span> <span class="p">(</span>
                <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">==</span> <span class="kc">True</span>
            <span class="p">):</span>  <span class="c1"># ie. value is np.nan or pd.NA:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="kn">from</span><span class="w"> </span><span class="nn">shapely.geometry</span><span class="w"> </span><span class="kn">import</span> <span class="n">GeometryCollection</span>

                    <span class="n">value</span> <span class="o">=</span> <span class="n">GeometryCollection</span><span class="p">()</span>

            <span class="n">other</span><span class="p">,</span> <span class="n">extended</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_series_of_val</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            <span class="n">align</span> <span class="o">=</span> <span class="kc">False</span> <span class="k">if</span> <span class="n">extended</span> <span class="k">else</span> <span class="n">align</span>

        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="p">(</span><span class="n">GeoSeries</span><span class="p">,</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoSeries</span><span class="p">)):</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">GeoSeries</span><span class="p">):</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">GeoSeries</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

            <span class="c1"># Replace all None&#39;s with empty geometries (this is a recursive call)</span>
            <span class="n">other</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid value type: </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="c1"># Coalesce: If the value in L is null, use the corresponding value in R for that row</span>
        <span class="n">spark_expr</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">coalesce</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;L&quot;</span><span class="p">),</span> <span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;R&quot;</span><span class="p">))</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_row_wise_operation</span><span class="p">(</span>
            <span class="n">spark_expr</span><span class="p">,</span>
            <span class="n">other</span><span class="p">,</span>
            <span class="n">align</span><span class="o">=</span><span class="n">align</span><span class="p">,</span>
            <span class="n">returns_geom</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">default_val</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">keep_name</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">inplace</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_update_inplace</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="k">return</span> <span class="n">result</span></div>


<div class="viewcode-block" id="GeoSeries.explode">
<a class="viewcode-back" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.explode">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">explode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">index_parts</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;GeoSeries&quot;</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
            <span class="n">_not_implemented_error</span><span class="p">(</span>
                <span class="s2">&quot;explode&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Explodes multi-part geometries into separate single-part geometries.&quot;</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="GeoSeries.to_crs">
<a class="viewcode-back" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.to_crs">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">to_crs</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">crs</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">epsg</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;GeoSeries&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns a ``GeoSeries`` with all geometries transformed to a new</span>
<span class="sd">        coordinate reference system.</span>

<span class="sd">        Transform all geometries in a GeoSeries to a different coordinate</span>
<span class="sd">        reference system.  The ``crs`` attribute on the current GeoSeries must</span>
<span class="sd">        be set.  Either ``crs`` or ``epsg`` may be specified for output.</span>

<span class="sd">        This method will transform all points in all objects.  It has no notion</span>
<span class="sd">        of projecting entire geometries.  All segments joining points are</span>
<span class="sd">        assumed to be lines in the current projection, not geodesics.  Objects</span>
<span class="sd">        crossing the dateline (or other projection boundary) will have</span>
<span class="sd">        undesirable behavior.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        crs : pyproj.CRS, optional if `epsg` is specified</span>
<span class="sd">            The value can be anything accepted</span>
<span class="sd">            by :meth:`pyproj.CRS.from_user_input() &lt;pyproj.crs.CRS.from_user_input&gt;`,</span>
<span class="sd">            such as an authority string (eg &quot;EPSG:4326&quot;) or a WKT string.</span>
<span class="sd">        epsg : int, optional if `crs` is specified</span>
<span class="sd">            EPSG code specifying output projection.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        GeoSeries</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; from shapely.geometry import Point</span>
<span class="sd">        &gt;&gt;&gt; from sedona.spark.geopandas import GeoSeries</span>
<span class="sd">        &gt;&gt;&gt; geoseries = GeoSeries([Point(1, 1), Point(2, 2), Point(3, 3)], crs=4326)</span>
<span class="sd">        &gt;&gt;&gt; geoseries.crs</span>
<span class="sd">        &lt;Geographic 2D CRS: EPSG:4326&gt;</span>
<span class="sd">        Name: WGS 84</span>
<span class="sd">        Axis Info [ellipsoidal]:</span>
<span class="sd">        - Lat[north]: Geodetic latitude (degree)</span>
<span class="sd">        - Lon[east]: Geodetic longitude (degree)</span>
<span class="sd">        Area of Use:</span>
<span class="sd">        - name: World</span>
<span class="sd">        - bounds: (-180.0, -90.0, 180.0, 90.0)</span>
<span class="sd">        Datum: World Geodetic System 1984</span>
<span class="sd">        - Ellipsoid: WGS 84</span>
<span class="sd">        - Prime Meridian: Greenwich</span>

<span class="sd">        &gt;&gt;&gt; geoseries = geoseries.to_crs(3857)</span>
<span class="sd">        &gt;&gt;&gt; print(geoseries)</span>
<span class="sd">        0    POINT (111319.491 111325.143)</span>
<span class="sd">        1    POINT (222638.982 222684.209)</span>
<span class="sd">        2    POINT (333958.472 334111.171)</span>
<span class="sd">        dtype: geometry</span>
<span class="sd">        &gt;&gt;&gt; geoseries.crs</span>
<span class="sd">        &lt;Projected CRS: EPSG:3857&gt;</span>
<span class="sd">        Name: WGS 84 / Pseudo-Mercator</span>
<span class="sd">        Axis Info [cartesian]:</span>
<span class="sd">        - X[east]: Easting (metre)</span>
<span class="sd">        - Y[north]: Northing (metre)</span>
<span class="sd">        Area of Use:</span>
<span class="sd">        - name: World - 85°S to 85°N</span>
<span class="sd">        - bounds: (-180.0, -85.06, 180.0, 85.06)</span>
<span class="sd">        Coordinate Operation:</span>
<span class="sd">        - name: Popular Visualisation Pseudo-Mercator</span>
<span class="sd">        - method: Popular Visualisation Pseudo Mercator</span>
<span class="sd">        Datum: World Geodetic System 1984</span>
<span class="sd">        - Ellipsoid: WGS 84</span>
<span class="sd">        - Prime Meridian: Greenwich</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="kn">from</span><span class="w"> </span><span class="nn">pyproj</span><span class="w"> </span><span class="kn">import</span> <span class="n">CRS</span>

        <span class="k">if</span> <span class="n">crs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">crs</span> <span class="o">=</span> <span class="n">CRS</span><span class="o">.</span><span class="n">from_user_input</span><span class="p">(</span><span class="n">crs</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">epsg</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">crs</span> <span class="o">=</span> <span class="n">CRS</span><span class="o">.</span><span class="n">from_epsg</span><span class="p">(</span><span class="n">epsg</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Must pass either crs or epsg.&quot;</span><span class="p">)</span>

        <span class="n">spark_expr</span> <span class="o">=</span> <span class="n">stf</span><span class="o">.</span><span class="n">ST_Transform</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">spark</span><span class="o">.</span><span class="n">column</span><span class="p">,</span>
            <span class="n">F</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;EPSG:</span><span class="si">{</span><span class="n">crs</span><span class="o">.</span><span class="n">to_epsg</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">),</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_query_geometry_column</span><span class="p">(</span>
            <span class="n">spark_expr</span><span class="p">,</span>
            <span class="n">keep_name</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span></div>


    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">bounds</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pspd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
        <span class="n">selects</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">stf</span><span class="o">.</span><span class="n">ST_XMin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">spark</span><span class="o">.</span><span class="n">column</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;minx&quot;</span><span class="p">),</span>
            <span class="n">stf</span><span class="o">.</span><span class="n">ST_YMin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">spark</span><span class="o">.</span><span class="n">column</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;miny&quot;</span><span class="p">),</span>
            <span class="n">stf</span><span class="o">.</span><span class="n">ST_XMax</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">spark</span><span class="o">.</span><span class="n">column</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;maxx&quot;</span><span class="p">),</span>
            <span class="n">stf</span><span class="o">.</span><span class="n">ST_YMax</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">spark</span><span class="o">.</span><span class="n">column</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;maxy&quot;</span><span class="p">),</span>
        <span class="p">]</span>

        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_internal</span><span class="o">.</span><span class="n">spark_frame</span>

        <span class="n">sdf</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="o">*</span><span class="n">selects</span><span class="p">)</span>
        <span class="n">internal</span> <span class="o">=</span> <span class="n">InternalFrame</span><span class="p">(</span>
            <span class="n">spark_frame</span><span class="o">=</span><span class="n">sdf</span><span class="p">,</span>
            <span class="n">index_spark_columns</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">column_labels</span><span class="o">=</span><span class="p">[(</span><span class="s2">&quot;minx&quot;</span><span class="p">,),</span> <span class="p">(</span><span class="s2">&quot;miny&quot;</span><span class="p">,),</span> <span class="p">(</span><span class="s2">&quot;maxx&quot;</span><span class="p">,),</span> <span class="p">(</span><span class="s2">&quot;maxy&quot;</span><span class="p">,)],</span>
            <span class="n">data_spark_columns</span><span class="o">=</span><span class="p">[</span>
                <span class="n">scol_for</span><span class="p">(</span><span class="n">sdf</span><span class="p">,</span> <span class="s2">&quot;minx&quot;</span><span class="p">),</span>
                <span class="n">scol_for</span><span class="p">(</span><span class="n">sdf</span><span class="p">,</span> <span class="s2">&quot;miny&quot;</span><span class="p">),</span>
                <span class="n">scol_for</span><span class="p">(</span><span class="n">sdf</span><span class="p">,</span> <span class="s2">&quot;maxx&quot;</span><span class="p">),</span>
                <span class="n">scol_for</span><span class="p">(</span><span class="n">sdf</span><span class="p">,</span> <span class="s2">&quot;maxy&quot;</span><span class="p">),</span>
            <span class="p">],</span>
            <span class="n">column_label_names</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">pspd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">internal</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">total_bounds</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
        <span class="kn">import</span><span class="w"> </span><span class="nn">warnings</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">pyspark.sql</span><span class="w"> </span><span class="kn">import</span> <span class="n">functions</span> <span class="k">as</span> <span class="n">F</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c1"># numpy &#39;min&#39; cannot handle empty arrays</span>
            <span class="c1"># TODO with numpy &gt;= 1.15, the &#39;initial&#39; argument can be used</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">])</span>
        <span class="n">ps_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bounds</span>
        <span class="k">with</span> <span class="n">warnings</span><span class="o">.</span><span class="n">catch_warnings</span><span class="p">():</span>
            <span class="c1"># if all rows are empty geometry / none, nan is expected</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span>
                <span class="s2">&quot;ignore&quot;</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;All-NaN slice encountered&quot;</span><span class="p">,</span> <span class="ne">RuntimeWarning</span>
            <span class="p">)</span>
            <span class="n">total_bounds_df</span> <span class="o">=</span> <span class="n">ps_df</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span>
                <span class="p">{</span>
                    <span class="s2">&quot;minx&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;min&quot;</span><span class="p">],</span>
                    <span class="s2">&quot;miny&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;min&quot;</span><span class="p">],</span>
                    <span class="s2">&quot;maxx&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;max&quot;</span><span class="p">],</span>
                    <span class="s2">&quot;maxy&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;max&quot;</span><span class="p">],</span>
                <span class="p">}</span>
            <span class="p">)</span>

            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
                <span class="p">(</span>
                    <span class="n">np</span><span class="o">.</span><span class="n">nanmin</span><span class="p">(</span><span class="n">total_bounds_df</span><span class="p">[</span><span class="s2">&quot;minx&quot;</span><span class="p">][</span><span class="s2">&quot;min&quot;</span><span class="p">]),</span>  <span class="c1"># minx</span>
                    <span class="n">np</span><span class="o">.</span><span class="n">nanmin</span><span class="p">(</span><span class="n">total_bounds_df</span><span class="p">[</span><span class="s2">&quot;miny&quot;</span><span class="p">][</span><span class="s2">&quot;min&quot;</span><span class="p">]),</span>  <span class="c1"># miny</span>
                    <span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">total_bounds_df</span><span class="p">[</span><span class="s2">&quot;maxx&quot;</span><span class="p">][</span><span class="s2">&quot;max&quot;</span><span class="p">]),</span>  <span class="c1"># maxx</span>
                    <span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">total_bounds_df</span><span class="p">[</span><span class="s2">&quot;maxy&quot;</span><span class="p">][</span><span class="s2">&quot;max&quot;</span><span class="p">]),</span>  <span class="c1"># maxy</span>
                <span class="p">)</span>
            <span class="p">)</span>

    <span class="c1"># GeoSeries-only (not in GeoDataFrame)</span>
<div class="viewcode-block" id="GeoSeries.estimate_utm_crs">
<a class="viewcode-back" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.estimate_utm_crs">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">estimate_utm_crs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">datum_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;WGS 84&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;CRS&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the estimated UTM CRS based on the bounds of the dataset.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        datum_name : str, optional</span>
<span class="sd">            The name of the datum to use in the query. Default is WGS 84.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        pyproj.CRS</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; import geodatasets  # requires: pip install geodatasets</span>
<span class="sd">        &gt;&gt;&gt; import geopandas as gpd</span>
<span class="sd">        &gt;&gt;&gt; df = gpd.read_file(</span>
<span class="sd">        ...     geodatasets.get_path(&quot;geoda.chicago_commpop&quot;)</span>
<span class="sd">        ... )</span>
<span class="sd">        &gt;&gt;&gt; df.geometry.values.estimate_utm_crs()  # doctest: +SKIP</span>
<span class="sd">        &lt;Derived Projected CRS: EPSG:32616&gt;</span>
<span class="sd">        Name: WGS 84 / UTM zone 16N</span>
<span class="sd">        Axis Info [cartesian]:</span>
<span class="sd">        - E[east]: Easting (metre)</span>
<span class="sd">        - N[north]: Northing (metre)</span>
<span class="sd">        Area of Use:</span>
<span class="sd">        - name: Between 90°W and 84°W, northern hemisphere between equator and 84°N,...</span>
<span class="sd">        - bounds: (-90.0, 0.0, -84.0, 84.0)</span>
<span class="sd">        Coordinate Operation:</span>
<span class="sd">        - name: UTM zone 16N</span>
<span class="sd">        - method: Transverse Mercator</span>
<span class="sd">        Datum: World Geodetic System 1984 ensemble</span>
<span class="sd">        - Ellipsoid: WGS 84</span>
<span class="sd">        - Prime Meridian: Greenwich</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">pyproj</span><span class="w"> </span><span class="kn">import</span> <span class="n">CRS</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">pyproj.aoi</span><span class="w"> </span><span class="kn">import</span> <span class="n">AreaOfInterest</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">pyproj.database</span><span class="w"> </span><span class="kn">import</span> <span class="n">query_utm_crs_info</span>

        <span class="c1"># This implementation replicates the implementation in GeoPandas&#39;s implementation exactly.</span>
        <span class="c1"># https://github.com/geopandas/geopandas/blob/main/geopandas/array.py</span>
        <span class="c1"># The only difference is that we use Sedona&#39;s total_bounds property which is more efficient and scalable</span>
        <span class="c1"># than the GeoPandas implementation. The rest of the implementation always executes on 4 points (minx, miny, maxx, maxy),</span>
        <span class="c1"># so the numpy and pyproj implementations are reasonable.</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">crs</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;crs must be set to estimate UTM CRS.&quot;</span><span class="p">)</span>

        <span class="n">minx</span><span class="p">,</span> <span class="n">miny</span><span class="p">,</span> <span class="n">maxx</span><span class="p">,</span> <span class="n">maxy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">total_bounds</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">crs</span><span class="o">.</span><span class="n">is_geographic</span><span class="p">:</span>
            <span class="n">x_center</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">([</span><span class="n">minx</span><span class="p">,</span> <span class="n">maxx</span><span class="p">])</span>
            <span class="n">y_center</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">([</span><span class="n">miny</span><span class="p">,</span> <span class="n">maxy</span><span class="p">])</span>
        <span class="c1"># ensure using geographic coordinates</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="kn">from</span><span class="w"> </span><span class="nn">pyproj</span><span class="w"> </span><span class="kn">import</span> <span class="n">Transformer</span>
            <span class="kn">from</span><span class="w"> </span><span class="nn">functools</span><span class="w"> </span><span class="kn">import</span> <span class="n">lru_cache</span>

            <span class="n">TransformerFromCRS</span> <span class="o">=</span> <span class="n">lru_cache</span><span class="p">(</span><span class="n">Transformer</span><span class="o">.</span><span class="n">from_crs</span><span class="p">)</span>

            <span class="n">transformer</span> <span class="o">=</span> <span class="n">TransformerFromCRS</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">crs</span><span class="p">,</span> <span class="s2">&quot;EPSG:4326&quot;</span><span class="p">,</span> <span class="n">always_xy</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">minx</span><span class="p">,</span> <span class="n">miny</span><span class="p">,</span> <span class="n">maxx</span><span class="p">,</span> <span class="n">maxy</span> <span class="o">=</span> <span class="n">transformer</span><span class="o">.</span><span class="n">transform_bounds</span><span class="p">(</span>
                <span class="n">minx</span><span class="p">,</span> <span class="n">miny</span><span class="p">,</span> <span class="n">maxx</span><span class="p">,</span> <span class="n">maxy</span>
            <span class="p">)</span>
            <span class="n">y_center</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">([</span><span class="n">miny</span><span class="p">,</span> <span class="n">maxy</span><span class="p">])</span>
            <span class="c1"># crossed the antimeridian</span>
            <span class="k">if</span> <span class="n">minx</span> <span class="o">&gt;</span> <span class="n">maxx</span><span class="p">:</span>
                <span class="c1"># shift maxx from [-180,180] to [0,360]</span>
                <span class="c1"># so both numbers are positive for center calculation</span>
                <span class="c1"># Example: -175 to 185</span>
                <span class="n">maxx</span> <span class="o">+=</span> <span class="mi">360</span>
                <span class="n">x_center</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">([</span><span class="n">minx</span><span class="p">,</span> <span class="n">maxx</span><span class="p">])</span>
                <span class="c1"># shift back to [-180,180]</span>
                <span class="n">x_center</span> <span class="o">=</span> <span class="p">((</span><span class="n">x_center</span> <span class="o">+</span> <span class="mi">180</span><span class="p">)</span> <span class="o">%</span> <span class="mi">360</span><span class="p">)</span> <span class="o">-</span> <span class="mi">180</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">x_center</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">([</span><span class="n">minx</span><span class="p">,</span> <span class="n">maxx</span><span class="p">])</span>

        <span class="n">utm_crs_list</span> <span class="o">=</span> <span class="n">query_utm_crs_info</span><span class="p">(</span>
            <span class="n">datum_name</span><span class="o">=</span><span class="n">datum_name</span><span class="p">,</span>
            <span class="n">area_of_interest</span><span class="o">=</span><span class="n">AreaOfInterest</span><span class="p">(</span>
                <span class="n">west_lon_degree</span><span class="o">=</span><span class="n">x_center</span><span class="p">,</span>
                <span class="n">south_lat_degree</span><span class="o">=</span><span class="n">y_center</span><span class="p">,</span>
                <span class="n">east_lon_degree</span><span class="o">=</span><span class="n">x_center</span><span class="p">,</span>
                <span class="n">north_lat_degree</span><span class="o">=</span><span class="n">y_center</span><span class="p">,</span>
            <span class="p">),</span>
        <span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">CRS</span><span class="o">.</span><span class="n">from_epsg</span><span class="p">(</span><span class="n">utm_crs_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">code</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Unable to determine UTM CRS&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="GeoSeries.to_json">
<a class="viewcode-back" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.to_json">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">to_json</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">show_bbox</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">drop_id</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">to_wgs84</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a GeoJSON string representation of the GeoSeries.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        show_bbox : bool, optional, default: True</span>
<span class="sd">            Include bbox (bounds) in the geojson</span>
<span class="sd">        drop_id : bool, default: False</span>
<span class="sd">            Whether to retain the index of the GeoSeries as the id property</span>
<span class="sd">            in the generated GeoJSON. Default is False, but may want True</span>
<span class="sd">            if the index is just arbitrary row numbers.</span>
<span class="sd">        to_wgs84: bool, optional, default: False</span>
<span class="sd">            If the CRS is set on the active geometry column it is exported as</span>
<span class="sd">            WGS84 (EPSG:4326) to meet the `2016 GeoJSON specification</span>
<span class="sd">            &lt;https://tools.ietf.org/html/rfc7946&gt;`_.</span>
<span class="sd">            Set to True to force re-projection and set to False to ignore CRS. False by</span>
<span class="sd">            default.</span>

<span class="sd">        *kwargs* that will be passed to json.dumps().</span>

<span class="sd">        Note: Unlike geopandas, Sedona&#39;s implementation will replace &#39;LinearRing&#39;</span>
<span class="sd">        with &#39;LineString&#39; in the GeoJSON output.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        JSON string</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; from sedona.spark.geopandas import GeoSeries</span>
<span class="sd">        &gt;&gt;&gt; from shapely.geometry import Point</span>
<span class="sd">        &gt;&gt;&gt; s = GeoSeries([Point(1, 1), Point(2, 2), Point(3, 3)])</span>
<span class="sd">        &gt;&gt;&gt; s</span>
<span class="sd">        0    POINT (1 1)</span>
<span class="sd">        1    POINT (2 2)</span>
<span class="sd">        2    POINT (3 3)</span>
<span class="sd">        dtype: geometry</span>

<span class="sd">        &gt;&gt;&gt; s.to_json()</span>
<span class="sd">        &#39;{&quot;type&quot;: &quot;FeatureCollection&quot;, &quot;features&quot;: [{&quot;id&quot;: &quot;0&quot;, &quot;type&quot;: &quot;Feature&quot;, &quot;pr\</span>
<span class="sd">operties&quot;: {}, &quot;geometry&quot;: {&quot;type&quot;: &quot;Point&quot;, &quot;coordinates&quot;: [1.0, 1.0]}, &quot;bbox&quot;: [1.0,\</span>
<span class="sd"> 1.0, 1.0, 1.0]}, {&quot;id&quot;: &quot;1&quot;, &quot;type&quot;: &quot;Feature&quot;, &quot;properties&quot;: {}, &quot;geometry&quot;: {&quot;type&quot;\</span>
<span class="sd">: &quot;Point&quot;, &quot;coordinates&quot;: [2.0, 2.0]}, &quot;bbox&quot;: [2.0, 2.0, 2.0, 2.0]}, {&quot;id&quot;: &quot;2&quot;, &quot;typ\</span>
<span class="sd">e&quot;: &quot;Feature&quot;, &quot;properties&quot;: {}, &quot;geometry&quot;: {&quot;type&quot;: &quot;Point&quot;, &quot;coordinates&quot;: [3.0, 3.\</span>
<span class="sd">0]}, &quot;bbox&quot;: [3.0, 3.0, 3.0, 3.0]}], &quot;bbox&quot;: [1.0, 1.0, 3.0, 3.0]}&#39;</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        GeoSeries.to_file : write GeoSeries to file</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_geoframe</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;geometry&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">to_json</span><span class="p">(</span>
            <span class="n">na</span><span class="o">=</span><span class="s2">&quot;null&quot;</span><span class="p">,</span> <span class="n">show_bbox</span><span class="o">=</span><span class="n">show_bbox</span><span class="p">,</span> <span class="n">drop_id</span><span class="o">=</span><span class="n">drop_id</span><span class="p">,</span> <span class="n">to_wgs84</span><span class="o">=</span><span class="n">to_wgs84</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="GeoSeries.to_wkb">
<a class="viewcode-back" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.to_wkb">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">to_wkb</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">hex</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pspd</span><span class="o">.</span><span class="n">Series</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Convert GeoSeries geometries to WKB</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        hex : bool</span>
<span class="sd">            If true, export the WKB as a hexadecimal string.</span>
<span class="sd">            The default is to return a binary bytes object.</span>
<span class="sd">        kwargs</span>
<span class="sd">            Additional keyword args will be passed to</span>
<span class="sd">            :func:`shapely.to_wkb`.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Series</span>
<span class="sd">            WKB representations of the geometries</span>

<span class="sd">        See also</span>
<span class="sd">        --------</span>
<span class="sd">        GeoSeries.to_wkt</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; from shapely.geometry import Point, Polygon</span>
<span class="sd">        &gt;&gt;&gt; s = GeoSeries(</span>
<span class="sd">        ...     [</span>
<span class="sd">        ...         Point(0, 0),</span>
<span class="sd">        ...         Polygon(),</span>
<span class="sd">        ...         Polygon([(0, 0), (1, 1), (1, 0)]),</span>
<span class="sd">        ...         None,</span>
<span class="sd">        ...     ]</span>
<span class="sd">        ... )</span>

<span class="sd">        &gt;&gt;&gt; s.to_wkb()</span>
<span class="sd">        0    b&#39;\x01\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00...</span>
<span class="sd">        1              b&#39;\x01\x03\x00\x00\x00\x00\x00\x00\x00&#39;</span>
<span class="sd">        2    b&#39;\x01\x03\x00\x00\x00\x01\x00\x00\x00\x04\x00...</span>
<span class="sd">        3                                                 None</span>
<span class="sd">        dtype: object</span>

<span class="sd">        &gt;&gt;&gt; s.to_wkb(hex=True)</span>
<span class="sd">        0           010100000000000000000000000000000000000000</span>
<span class="sd">        1                                   010300000000000000</span>
<span class="sd">        2    0103000000010000000400000000000000000000000000...</span>
<span class="sd">        3                                                 None</span>
<span class="sd">        dtype: object</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">spark_expr</span> <span class="o">=</span> <span class="n">stf</span><span class="o">.</span><span class="n">ST_AsBinary</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">spark</span><span class="o">.</span><span class="n">column</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">hex</span><span class="p">:</span>
            <span class="n">spark_expr</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">hex</span><span class="p">(</span><span class="n">spark_expr</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_query_geometry_column</span><span class="p">(</span>
            <span class="n">spark_expr</span><span class="p">,</span>
            <span class="n">returns_geom</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="GeoSeries.to_wkt">
<a class="viewcode-back" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.to_wkt">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">to_wkt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pspd</span><span class="o">.</span><span class="n">Series</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Convert GeoSeries geometries to WKT</span>

<span class="sd">        Note: Using shapely &lt; 1.0.0 may return different geometries for empty geometries.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        kwargs</span>
<span class="sd">            Keyword args will be passed to :func:`shapely.to_wkt`.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Series</span>
<span class="sd">            WKT representations of the geometries</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; from shapely.geometry import Point</span>
<span class="sd">        &gt;&gt;&gt; s = GeoSeries([Point(1, 1), Point(2, 2), Point(3, 3)])</span>
<span class="sd">        &gt;&gt;&gt; s</span>
<span class="sd">        0    POINT (1 1)</span>
<span class="sd">        1    POINT (2 2)</span>
<span class="sd">        2    POINT (3 3)</span>
<span class="sd">        dtype: geometry</span>

<span class="sd">        &gt;&gt;&gt; s.to_wkt()</span>
<span class="sd">        0    POINT (1 1)</span>
<span class="sd">        1    POINT (2 2)</span>
<span class="sd">        2    POINT (3 3)</span>
<span class="sd">        dtype: object</span>

<span class="sd">        See also</span>
<span class="sd">        --------</span>
<span class="sd">        GeoSeries.to_wkb</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">spark_expr</span> <span class="o">=</span> <span class="n">stf</span><span class="o">.</span><span class="n">ST_AsText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">spark</span><span class="o">.</span><span class="n">column</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_query_geometry_column</span><span class="p">(</span>
            <span class="n">spark_expr</span><span class="p">,</span>
            <span class="n">returns_geom</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="GeoSeries.to_arrow">
<a class="viewcode-back" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.to_arrow">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">to_arrow</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">geometry_encoding</span><span class="o">=</span><span class="s2">&quot;WKB&quot;</span><span class="p">,</span> <span class="n">interleaved</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">include_z</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Encode a GeoSeries to GeoArrow format.</span>

<span class="sd">        See https://geoarrow.org/ for details on the GeoArrow specification.</span>

<span class="sd">        This functions returns a generic Arrow array object implementing</span>
<span class="sd">        the `Arrow PyCapsule Protocol`_ (i.e. having an ``__arrow_c_array__``</span>
<span class="sd">        method). This object can then be consumed by your Arrow implementation</span>
<span class="sd">        of choice that supports this protocol.</span>

<span class="sd">        .. _Arrow PyCapsule Protocol: https://arrow.apache.org/docs/format/CDataInterface/PyCapsuleInterface.html</span>

<span class="sd">        Note: Requires geopandas versions &gt;= 1.0.0 to use with Sedona.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        geometry_encoding : {&#39;WKB&#39;, &#39;geoarrow&#39; }, default &#39;WKB&#39;</span>
<span class="sd">            The GeoArrow encoding to use for the data conversion.</span>
<span class="sd">        interleaved : bool, default True</span>
<span class="sd">            Only relevant for &#39;geoarrow&#39; encoding. If True, the geometries&#39;</span>
<span class="sd">            coordinates are interleaved in a single fixed size list array.</span>
<span class="sd">            If False, the coordinates are stored as separate arrays in a</span>
<span class="sd">            struct type.</span>
<span class="sd">        include_z : bool, default None</span>
<span class="sd">            Only relevant for &#39;geoarrow&#39; encoding (for WKB, the dimensionality</span>
<span class="sd">            of the individual geometries is preserved).</span>
<span class="sd">            If False, return 2D geometries. If True, include the third dimension</span>
<span class="sd">            in the output (if a geometry has no third dimension, the z-coordinates</span>
<span class="sd">            will be NaN). By default, will infer the dimensionality from the</span>
<span class="sd">            input geometries. Note that this inference can be unreliable with</span>
<span class="sd">            empty geometries (for a guaranteed result, it is recommended to</span>
<span class="sd">            specify the keyword).</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        GeoArrowArray</span>
<span class="sd">            A generic Arrow array object with geometry data encoded to GeoArrow.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; from sedona.spark.geopandas import GeoSeries</span>
<span class="sd">        &gt;&gt;&gt; from shapely.geometry import Point</span>
<span class="sd">        &gt;&gt;&gt; gser = GeoSeries([Point(1, 2), Point(2, 1)])</span>
<span class="sd">        &gt;&gt;&gt; gser</span>
<span class="sd">        0    POINT (1 2)</span>
<span class="sd">        1    POINT (2 1)</span>
<span class="sd">        dtype: geometry</span>

<span class="sd">        &gt;&gt;&gt; arrow_array = gser.to_arrow()</span>
<span class="sd">        &gt;&gt;&gt; arrow_array</span>
<span class="sd">        &lt;geopandas.io._geoarrow.GeoArrowArray object at ...&gt;</span>

<span class="sd">        The returned array object needs to be consumed by a library implementing</span>
<span class="sd">        the Arrow PyCapsule Protocol. For example, wrapping the data as a</span>
<span class="sd">        pyarrow.Array (requires pyarrow &gt;= 14.0):</span>

<span class="sd">        &gt;&gt;&gt; import pyarrow as pa</span>
<span class="sd">        &gt;&gt;&gt; array = pa.array(arrow_array)</span>
<span class="sd">        &gt;&gt;&gt; array</span>
<span class="sd">        &lt;pyarrow.lib.BinaryArray object at ...&gt;</span>
<span class="sd">        [</span>
<span class="sd">          0101000000000000000000F03F0000000000000040,</span>
<span class="sd">          01010000000000000000000040000000000000F03F</span>
<span class="sd">        ]</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Because this function returns the Arrow array in memory, we simply rely on GeoPandas&#39;s implementation.</span>
        <span class="c1"># This also returns a GeoPandas-specific data type, which can be converted to an actual PyArrow array,</span>
        <span class="c1"># so there is no direct Sedona equivalent. This way we also get all of the arguments implemented for free.</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_geopandas</span><span class="p">()</span><span class="o">.</span><span class="n">to_arrow</span><span class="p">(</span>
            <span class="n">geometry_encoding</span><span class="o">=</span><span class="n">geometry_encoding</span><span class="p">,</span>
            <span class="n">interleaved</span><span class="o">=</span><span class="n">interleaved</span><span class="p">,</span>
            <span class="n">include_z</span><span class="o">=</span><span class="n">include_z</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="GeoSeries.clip">
<a class="viewcode-back" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.clip">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">clip</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mask</span><span class="p">,</span> <span class="n">keep_geom_type</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">sort</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;GeoSeries&quot;</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
            <span class="n">_not_implemented_error</span><span class="p">(</span>
                <span class="s2">&quot;clip&quot;</span><span class="p">,</span> <span class="s2">&quot;Clips geometries to the bounds of a mask geometry.&quot;</span>
            <span class="p">)</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="GeoSeries.to_file">
<a class="viewcode-back" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.to_file">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">to_file</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">driver</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">schema</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">dict</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">index</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Write the ``GeoSeries`` to a file.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        path : str</span>
<span class="sd">            File path or file handle to write to.</span>
<span class="sd">        driver : str, optional</span>
<span class="sd">            The format driver used to write the file, by default None. If not</span>
<span class="sd">            specified, it&#39;s inferred from the file extension. Available formats</span>
<span class="sd">            are &quot;geojson&quot;, &quot;geopackage&quot;, and &quot;geoparquet&quot;.</span>
<span class="sd">        index : bool, optional</span>
<span class="sd">            If True, writes the index as a column. If False, no index is</span>
<span class="sd">            written. By default None, the index is written only if it is named,</span>
<span class="sd">            is a MultiIndex, or has a non-integer data type.</span>
<span class="sd">        mode : str, default &#39;w&#39;</span>
<span class="sd">            The write mode: &#39;w&#39; to overwrite the existing file or &#39;a&#39; to append.</span>
<span class="sd">        crs : pyproj.CRS, optional</span>
<span class="sd">            The coordinate reference system to write. If None, it is determined</span>
<span class="sd">            from the ``GeoSeries`` `crs` attribute. The value can be anything</span>
<span class="sd">            accepted by :meth:`pyproj.CRS.from_user_input()`, such as an</span>
<span class="sd">            authority string (e.g., &quot;EPSG:4326&quot;) or a WKT string.</span>
<span class="sd">        **kwargs</span>
<span class="sd">            Additional keyword arguments passed to the underlying writing engine.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; from shapely.geometry import Point, LineString</span>
<span class="sd">        &gt;&gt;&gt; from sedona.spark.geopandas import GeoSeries</span>
<span class="sd">        &gt;&gt;&gt; # Note: Examples write to temporary files for demonstration</span>
<span class="sd">        &gt;&gt;&gt; import tempfile</span>
<span class="sd">        &gt;&gt;&gt; import os</span>

<span class="sd">        Create a GeoSeries:</span>
<span class="sd">        &gt;&gt;&gt; gs = GeoSeries(</span>
<span class="sd">        ...     [Point(0, 0), LineString([(1, 1), (2, 2)])],</span>
<span class="sd">        ...     index=[&quot;a&quot;, &quot;b&quot;]</span>
<span class="sd">        ... )</span>

<span class="sd">        Save to a GeoParquet file:</span>
<span class="sd">        &gt;&gt;&gt; path_parquet = os.path.join(tempfile.gettempdir(), &quot;data.parquet&quot;)</span>
<span class="sd">        &gt;&gt;&gt; gs.to_file(path_parquet, driver=&quot;geoparquet&quot;)</span>

<span class="sd">        Append to a GeoJSON file:</span>
<span class="sd">        &gt;&gt;&gt; path_json = os.path.join(tempfile.gettempdir(), &quot;data.json&quot;)</span>
<span class="sd">        &gt;&gt;&gt; gs.to_file(path_json, driver=&quot;geojson&quot;, mode=&#39;a&#39;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">to_geoframe</span><span class="p">()</span><span class="o">.</span><span class="n">to_file</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">driver</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="GeoSeries.to_parquet">
<a class="viewcode-back" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.to_parquet">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">to_parquet</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Write the GeoSeries to a GeoParquet file.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        path : str</span>
<span class="sd">            The file path where the GeoParquet file will be written.</span>
<span class="sd">        **kwargs</span>
<span class="sd">            Additional keyword arguments passed to the underlying writing function.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; from shapely.geometry import Point</span>
<span class="sd">        &gt;&gt;&gt; from sedona.spark.geopandas import GeoSeries</span>
<span class="sd">        &gt;&gt;&gt; import tempfile</span>
<span class="sd">        &gt;&gt;&gt; import os</span>
<span class="sd">        &gt;&gt;&gt; gs = GeoSeries([Point(1, 1), Point(2, 2)])</span>
<span class="sd">        &gt;&gt;&gt; file_path = os.path.join(tempfile.gettempdir(), &quot;my_geodata.parquet&quot;)</span>
<span class="sd">        &gt;&gt;&gt; gs.to_parquet(file_path)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">to_geoframe</span><span class="p">()</span><span class="o">.</span><span class="n">to_file</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">driver</span><span class="o">=</span><span class="s2">&quot;geoparquet&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


    <span class="c1"># -----------------------------------------------------------------------------</span>
    <span class="c1"># # Utils</span>
    <span class="c1"># -----------------------------------------------------------------------------</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_update_inplace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">result</span><span class="p">:</span> <span class="s2">&quot;GeoSeries&quot;</span><span class="p">,</span> <span class="n">invalidate_sindex</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_update_anchor</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">_anchor</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">invalidate_sindex</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_sindex</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_make_series_of_val</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">Any</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A helper method to turn single objects into series (ps.Series or GeoSeries when possible)</span>
<span class="sd">        Returns:</span>
<span class="sd">            tuple[pspd.Series, bool]:</span>
<span class="sd">                - The series of the value</span>
<span class="sd">                - Whether returned value was a single object extended into a series (useful for row-wise &#39;align&#39; parameter)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># generator instead of a in-memory list</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">GeoDataFrame</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">value</span><span class="o">.</span><span class="n">geometry</span><span class="p">,</span> <span class="kc">False</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">pspd</span><span class="o">.</span><span class="n">Series</span><span class="p">):</span>
            <span class="n">lst</span> <span class="o">=</span> <span class="p">[</span><span class="n">value</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">))]</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">BaseGeometry</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">GeoSeries</span><span class="p">(</span><span class="n">lst</span><span class="p">),</span> <span class="kc">True</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># e.g int input</span>
                <span class="k">return</span> <span class="n">pspd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">lst</span><span class="p">),</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">value</span><span class="p">,</span> <span class="kc">False</span>

<div class="viewcode-block" id="GeoSeries.to_geoframe">
<a class="viewcode-back" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.to_geoframe">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">to_geoframe</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">renamed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_column_label</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_column_label</span> <span class="o">==</span> <span class="p">(</span><span class="kc">None</span><span class="p">,):</span>
            <span class="n">renamed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s2">&quot;geometry&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">renamed</span> <span class="o">=</span> <span class="bp">self</span>

        <span class="n">index_col</span> <span class="o">=</span> <span class="n">SPARK_DEFAULT_INDEX_NAME</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">GeoDataFrame</span><span class="p">(</span>
            <span class="n">pspd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">renamed</span><span class="o">.</span><span class="n">_internal</span><span class="p">)</span><span class="o">.</span><span class="n">to_spark</span><span class="p">(</span><span class="n">index_col</span><span class="p">)</span><span class="o">.</span><span class="n">pandas_api</span><span class="p">(</span><span class="n">index_col</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">result</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span>
        <span class="k">return</span> <span class="n">result</span></div>
</div>



<span class="c1"># -----------------------------------------------------------------------------</span>
<span class="c1"># # Utils</span>
<span class="c1"># -----------------------------------------------------------------------------</span>


<span class="k">def</span><span class="w"> </span><span class="nf">_get_series_col_name</span><span class="p">(</span><span class="n">ps_series</span><span class="p">:</span> <span class="n">pspd</span><span class="o">.</span><span class="n">Series</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">ps_series</span><span class="o">.</span><span class="n">name</span> <span class="k">if</span> <span class="n">ps_series</span><span class="o">.</span><span class="n">name</span> <span class="k">else</span> <span class="n">SPARK_DEFAULT_SERIES_NAME</span>


<span class="k">def</span><span class="w"> </span><span class="nf">_to_bool</span><span class="p">(</span><span class="n">ps_series</span><span class="p">:</span> <span class="n">pspd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">default</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pspd</span><span class="o">.</span><span class="n">Series</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Cast a ps.Series to bool type if it&#39;s not one, converting None values to the default value.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">ps_series</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">name</span> <span class="o">!=</span> <span class="s2">&quot;bool&quot;</span><span class="p">:</span>
        <span class="c1"># fill None values with the default value</span>
        <span class="n">ps_series</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">default</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">ps_series</span>
</pre></div>

           </div>
          </div>
    </div>

          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Apache Software Foundation.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>