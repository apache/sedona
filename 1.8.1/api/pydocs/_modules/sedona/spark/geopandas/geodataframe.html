

<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>sedona.spark.geopandas.geodataframe &mdash; Apache Sedona Python Documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css" />
      <link rel="stylesheet" type="text/css" href="../../../../_static/css/theme.css" />
      <link rel="stylesheet" type="text/css" href="../../../../_static/custom.css" />

  
      <script src="../../../../_static/jquery.js"></script>
      <script src="../../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
      <script data-url_root="../../../../" id="documentation_options" src="../../../../_static/documentation_options.js"></script>
      <script src="../../../../_static/doctools.js"></script>
      <script src="../../../../_static/sphinx_highlight.js"></script>
    <script src="../../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
     
    <!-- Google Fonts for Apache Sedona styling -->
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&family=Roboto+Mono:wght@400;500&display=swap" rel="stylesheet">

    <!-- Additional meta tags for better rendering -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#1565c0">

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #ff5722" >

          
          
          <a href="../../../../index.html" class="icon icon-home">
            Apache Sedona Python
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../modules.html">sedona</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../sedona.html">sedona package</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../sedona.html#subpackages">Subpackages</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.core.html">sedona.core package</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.flink.html">sedona.flink package</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.geoarrow.html">sedona.geoarrow package</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.maps.html">sedona.maps package</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.raster.html">sedona.raster package</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.raster_utils.html">sedona.raster_utils package</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.register.html">sedona.register package</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.html">sedona.spark package</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.sql.html">sedona.sql package</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.stac.html">sedona.stac package</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.stats.html">sedona.stats package</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.utils.html">sedona.utils package</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../sedona.html#submodules">Submodules</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../sedona.html#module-sedona.exceptions">sedona.exceptions module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.html#sedona.exceptions.InvalidParametersException"><code class="docutils literal notranslate"><span class="pre">InvalidParametersException</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../sedona.html#module-sedona.version">sedona.version module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../sedona.html#module-sedona">Module contents</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../sedona.flink.html">sedona.flink package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../sedona.flink.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../sedona.flink.html#module-sedona.flink.context">sedona.flink.context module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../sedona.flink.html#sedona.flink.context.SedonaContext"><code class="docutils literal notranslate"><span class="pre">SedonaContext</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.flink.html#sedona.flink.context.SedonaContext.create"><code class="docutils literal notranslate"><span class="pre">SedonaContext.create()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../sedona.flink.html#module-sedona.flink">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../sedona.spark.html">sedona.spark package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../sedona.spark.html#subpackages">Subpackages</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../sedona.spark.core.html">sedona.spark.core package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.core.html#subpackages">Subpackages</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.core.html#submodules">Submodules</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.core.html#module-sedona.spark.core.utils">sedona.spark.core.utils module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.core.html#module-sedona.spark.core">Module contents</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../sedona.spark.geoarrow.html">sedona.spark.geoarrow package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geoarrow.html#submodules">Submodules</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geoarrow.html#module-sedona.spark.geoarrow.geoarrow">sedona.spark.geoarrow.geoarrow module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geoarrow.html#module-sedona.spark.geoarrow">Module contents</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../sedona.spark.geopandas.html">sedona.spark.geopandas package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html">sedona.spark.geopandas core</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.io.html">sedona.spark.geopandas.io</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.tools.html">sedona.spark.geopandas.tools</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../sedona.spark.maps.html">sedona.spark.maps package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.maps.html#submodules">Submodules</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.maps.html#module-sedona.spark.maps.SedonaKepler">sedona.spark.maps.SedonaKepler module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.maps.html#module-sedona.spark.maps.SedonaMapUtils">sedona.spark.maps.SedonaMapUtils module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.maps.html#module-sedona.spark.maps.SedonaPyDeck">sedona.spark.maps.SedonaPyDeck module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.maps.html#module-sedona.spark.maps">Module contents</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../sedona.spark.raster.html">sedona.spark.raster package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.raster.html#submodules">Submodules</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.raster.html#module-sedona.spark.raster.awt_raster">sedona.spark.raster.awt_raster module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.raster.html#module-sedona.spark.raster.data_buffer">sedona.spark.raster.data_buffer module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.raster.html#module-sedona.spark.raster.meta">sedona.spark.raster.meta module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.raster.html#module-sedona.spark.raster.raster_serde">sedona.spark.raster.raster_serde module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.raster.html#module-sedona.spark.raster.sample_model">sedona.spark.raster.sample_model module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.raster.html#module-sedona.spark.raster.sedona_raster">sedona.spark.raster.sedona_raster module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.raster.html#module-sedona.spark.raster">Module contents</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../sedona.spark.raster_utils.html">sedona.spark.raster_utils package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.raster_utils.html#submodules">Submodules</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.raster_utils.html#module-sedona.spark.raster_utils.SedonaUtils">sedona.spark.raster_utils.SedonaUtils module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.raster_utils.html#module-sedona.spark.raster_utils">Module contents</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../sedona.spark.register.html">sedona.spark.register package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.register.html#submodules">Submodules</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.register.html#module-sedona.spark.register.geo_registrator">sedona.spark.register.geo_registrator module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.register.html#module-sedona.spark.register.java_libs">sedona.spark.register.java_libs module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.register.html#module-sedona.spark.register">Module contents</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../sedona.spark.sql.html">sedona.spark.sql package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.sql.html#submodules">Submodules</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.sql.html#sedona-spark-sql-connect-module">sedona.spark.sql.connect module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.sql.html#module-sedona.spark.sql.dataframe_api">sedona.spark.sql.dataframe_api module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.sql.html#module-sedona.spark.sql.exceptions">sedona.spark.sql.exceptions module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.sql.html#module-sedona.spark.sql.functions">sedona.spark.sql.functions module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.sql.html#module-sedona.spark.sql.st_aggregates">sedona.spark.sql.st_aggregates module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.sql.html#module-sedona.spark.sql.st_constructors">sedona.spark.sql.st_constructors module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.sql.html#module-sedona.spark.sql.st_functions">sedona.spark.sql.st_functions module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.sql.html#module-sedona.spark.sql.st_predicates">sedona.spark.sql.st_predicates module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.sql.html#module-sedona.spark.sql.types">sedona.spark.sql.types module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.sql.html#module-sedona.spark.sql">Module contents</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../sedona.spark.stac.html">sedona.spark.stac package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.stac.html#submodules">Submodules</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.stac.html#module-sedona.spark.stac.client">sedona.spark.stac.client module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.stac.html#module-sedona.spark.stac.collection_client">sedona.spark.stac.collection_client module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.stac.html#module-sedona.spark.stac">Module contents</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../sedona.spark.stats.html">sedona.spark.stats package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.stats.html#subpackages">Subpackages</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.stats.html#submodules">Submodules</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.stats.html#module-sedona.spark.stats.weighting">sedona.spark.stats.weighting module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.stats.html#module-sedona.spark.stats">Module contents</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../sedona.spark.utils.html">sedona.spark.utils package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.utils.html#submodules">Submodules</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.utils.html#module-sedona.spark.utils.abstract_parser">sedona.spark.utils.abstract_parser module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.utils.html#module-sedona.spark.utils.adapter">sedona.spark.utils.adapter module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.utils.html#module-sedona.spark.utils.binary_parser">sedona.spark.utils.binary_parser module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.utils.html#module-sedona.spark.utils.decorators">sedona.spark.utils.decorators module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.utils.html#module-sedona.spark.utils.geometry_adapter">sedona.spark.utils.geometry_adapter module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.utils.html#module-sedona.spark.utils.geometry_serde">sedona.spark.utils.geometry_serde module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.utils.html#module-sedona.spark.utils.geometry_serde_general">sedona.spark.utils.geometry_serde_general module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.utils.html#module-sedona.spark.utils.geomserde_speedup">sedona.spark.utils.geomserde_speedup module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.utils.html#module-sedona.spark.utils.jvm">sedona.spark.utils.jvm module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.utils.html#module-sedona.spark.utils.meta">sedona.spark.utils.meta module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.utils.html#module-sedona.spark.utils.prep">sedona.spark.utils.prep module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.utils.html#module-sedona.spark.utils.serde">sedona.spark.utils.serde module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.utils.html#module-sedona.spark.utils.spatial_rdd_parser">sedona.spark.utils.spatial_rdd_parser module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.utils.html#module-sedona.spark.utils.structured_adapter">sedona.spark.utils.structured_adapter module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.utils.html#module-sedona.spark.utils.types">sedona.spark.utils.types module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.utils.html#module-sedona.spark.utils">Module contents</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../sedona.spark.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../sedona.spark.html#module-sedona.spark.SedonaContext">sedona.spark.SedonaContext module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../sedona.spark.html#sedona.spark.SedonaContext.SedonaContext"><code class="docutils literal notranslate"><span class="pre">SedonaContext</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.html#sedona.spark.SedonaContext.SedonaContext.__init__"><code class="docutils literal notranslate"><span class="pre">SedonaContext.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.html#sedona.spark.SedonaContext.SedonaContext.builder"><code class="docutils literal notranslate"><span class="pre">SedonaContext.builder()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.html#sedona.spark.SedonaContext.SedonaContext.create"><code class="docutils literal notranslate"><span class="pre">SedonaContext.create()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../sedona.spark.html#module-sedona.spark">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../sedona.spark.geopandas.html">sedona.spark.geopandas package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html">sedona.spark.geopandas core</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries"><code class="docutils literal notranslate"><span class="pre">GeoSeries</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.__init__"><code class="docutils literal notranslate"><span class="pre">GeoSeries.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.area"><code class="docutils literal notranslate"><span class="pre">GeoSeries.area</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.boundary"><code class="docutils literal notranslate"><span class="pre">GeoSeries.boundary</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.bounds"><code class="docutils literal notranslate"><span class="pre">GeoSeries.bounds</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.buffer"><code class="docutils literal notranslate"><span class="pre">GeoSeries.buffer()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.centroid"><code class="docutils literal notranslate"><span class="pre">GeoSeries.centroid</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.clip"><code class="docutils literal notranslate"><span class="pre">GeoSeries.clip()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.concave_hull"><code class="docutils literal notranslate"><span class="pre">GeoSeries.concave_hull()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.contains"><code class="docutils literal notranslate"><span class="pre">GeoSeries.contains()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.contains_properly"><code class="docutils literal notranslate"><span class="pre">GeoSeries.contains_properly()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.convex_hull"><code class="docutils literal notranslate"><span class="pre">GeoSeries.convex_hull</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.copy"><code class="docutils literal notranslate"><span class="pre">GeoSeries.copy()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.count_coordinates"><code class="docutils literal notranslate"><span class="pre">GeoSeries.count_coordinates()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.count_geometries"><code class="docutils literal notranslate"><span class="pre">GeoSeries.count_geometries()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.count_interior_rings"><code class="docutils literal notranslate"><span class="pre">GeoSeries.count_interior_rings()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.covered_by"><code class="docutils literal notranslate"><span class="pre">GeoSeries.covered_by()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.covers"><code class="docutils literal notranslate"><span class="pre">GeoSeries.covers()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.crosses"><code class="docutils literal notranslate"><span class="pre">GeoSeries.crosses()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.crs"><code class="docutils literal notranslate"><span class="pre">GeoSeries.crs</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.delaunay_triangles"><code class="docutils literal notranslate"><span class="pre">GeoSeries.delaunay_triangles()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.difference"><code class="docutils literal notranslate"><span class="pre">GeoSeries.difference()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.disjoint"><code class="docutils literal notranslate"><span class="pre">GeoSeries.disjoint()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.distance"><code class="docutils literal notranslate"><span class="pre">GeoSeries.distance()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.dwithin"><code class="docutils literal notranslate"><span class="pre">GeoSeries.dwithin()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.envelope"><code class="docutils literal notranslate"><span class="pre">GeoSeries.envelope</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.estimate_utm_crs"><code class="docutils literal notranslate"><span class="pre">GeoSeries.estimate_utm_crs()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.explode"><code class="docutils literal notranslate"><span class="pre">GeoSeries.explode()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.exterior"><code class="docutils literal notranslate"><span class="pre">GeoSeries.exterior</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.extract_unique_points"><code class="docutils literal notranslate"><span class="pre">GeoSeries.extract_unique_points()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.fillna"><code class="docutils literal notranslate"><span class="pre">GeoSeries.fillna()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.force_2d"><code class="docutils literal notranslate"><span class="pre">GeoSeries.force_2d()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.force_3d"><code class="docutils literal notranslate"><span class="pre">GeoSeries.force_3d()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.from_arrow"><code class="docutils literal notranslate"><span class="pre">GeoSeries.from_arrow()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.from_file"><code class="docutils literal notranslate"><span class="pre">GeoSeries.from_file()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.from_shapely"><code class="docutils literal notranslate"><span class="pre">GeoSeries.from_shapely()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.from_wkb"><code class="docutils literal notranslate"><span class="pre">GeoSeries.from_wkb()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.from_wkt"><code class="docutils literal notranslate"><span class="pre">GeoSeries.from_wkt()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.from_xy"><code class="docutils literal notranslate"><span class="pre">GeoSeries.from_xy()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.geom_type"><code class="docutils literal notranslate"><span class="pre">GeoSeries.geom_type</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.geometry"><code class="docutils literal notranslate"><span class="pre">GeoSeries.geometry</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.get_geometry"><code class="docutils literal notranslate"><span class="pre">GeoSeries.get_geometry()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.get_precision"><code class="docutils literal notranslate"><span class="pre">GeoSeries.get_precision()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.has_sindex"><code class="docutils literal notranslate"><span class="pre">GeoSeries.has_sindex</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.has_z"><code class="docutils literal notranslate"><span class="pre">GeoSeries.has_z</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.interiors"><code class="docutils literal notranslate"><span class="pre">GeoSeries.interiors</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.intersection"><code class="docutils literal notranslate"><span class="pre">GeoSeries.intersection()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.intersection_all"><code class="docutils literal notranslate"><span class="pre">GeoSeries.intersection_all()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.intersects"><code class="docutils literal notranslate"><span class="pre">GeoSeries.intersects()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.is_ccw"><code class="docutils literal notranslate"><span class="pre">GeoSeries.is_ccw</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.is_closed"><code class="docutils literal notranslate"><span class="pre">GeoSeries.is_closed</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.is_empty"><code class="docutils literal notranslate"><span class="pre">GeoSeries.is_empty</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.is_ring"><code class="docutils literal notranslate"><span class="pre">GeoSeries.is_ring</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.is_simple"><code class="docutils literal notranslate"><span class="pre">GeoSeries.is_simple</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.is_valid"><code class="docutils literal notranslate"><span class="pre">GeoSeries.is_valid</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.is_valid_reason"><code class="docutils literal notranslate"><span class="pre">GeoSeries.is_valid_reason()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.isna"><code class="docutils literal notranslate"><span class="pre">GeoSeries.isna()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.isnull"><code class="docutils literal notranslate"><span class="pre">GeoSeries.isnull()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.length"><code class="docutils literal notranslate"><span class="pre">GeoSeries.length</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.line_merge"><code class="docutils literal notranslate"><span class="pre">GeoSeries.line_merge()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.m"><code class="docutils literal notranslate"><span class="pre">GeoSeries.m</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.make_valid"><code class="docutils literal notranslate"><span class="pre">GeoSeries.make_valid()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.minimum_bounding_circle"><code class="docutils literal notranslate"><span class="pre">GeoSeries.minimum_bounding_circle()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.minimum_bounding_radius"><code class="docutils literal notranslate"><span class="pre">GeoSeries.minimum_bounding_radius()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.minimum_clearance"><code class="docutils literal notranslate"><span class="pre">GeoSeries.minimum_clearance()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.minimum_rotated_rectangle"><code class="docutils literal notranslate"><span class="pre">GeoSeries.minimum_rotated_rectangle()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.normalize"><code class="docutils literal notranslate"><span class="pre">GeoSeries.normalize()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.notna"><code class="docutils literal notranslate"><span class="pre">GeoSeries.notna()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.notnull"><code class="docutils literal notranslate"><span class="pre">GeoSeries.notnull()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.offset_curve"><code class="docutils literal notranslate"><span class="pre">GeoSeries.offset_curve()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.overlaps"><code class="docutils literal notranslate"><span class="pre">GeoSeries.overlaps()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.plot"><code class="docutils literal notranslate"><span class="pre">GeoSeries.plot()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.relate"><code class="docutils literal notranslate"><span class="pre">GeoSeries.relate()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.remove_repeated_points"><code class="docutils literal notranslate"><span class="pre">GeoSeries.remove_repeated_points()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.representative_point"><code class="docutils literal notranslate"><span class="pre">GeoSeries.representative_point()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.reverse"><code class="docutils literal notranslate"><span class="pre">GeoSeries.reverse()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.segmentize"><code class="docutils literal notranslate"><span class="pre">GeoSeries.segmentize()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.set_crs"><code class="docutils literal notranslate"><span class="pre">GeoSeries.set_crs()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.set_precision"><code class="docutils literal notranslate"><span class="pre">GeoSeries.set_precision()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.simplify"><code class="docutils literal notranslate"><span class="pre">GeoSeries.simplify()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.sindex"><code class="docutils literal notranslate"><span class="pre">GeoSeries.sindex</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.snap"><code class="docutils literal notranslate"><span class="pre">GeoSeries.snap()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.symmetric_difference"><code class="docutils literal notranslate"><span class="pre">GeoSeries.symmetric_difference()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.to_arrow"><code class="docutils literal notranslate"><span class="pre">GeoSeries.to_arrow()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.to_crs"><code class="docutils literal notranslate"><span class="pre">GeoSeries.to_crs()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.to_file"><code class="docutils literal notranslate"><span class="pre">GeoSeries.to_file()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.to_geoframe"><code class="docutils literal notranslate"><span class="pre">GeoSeries.to_geoframe()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.to_geopandas"><code class="docutils literal notranslate"><span class="pre">GeoSeries.to_geopandas()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.to_json"><code class="docutils literal notranslate"><span class="pre">GeoSeries.to_json()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.to_parquet"><code class="docutils literal notranslate"><span class="pre">GeoSeries.to_parquet()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.to_spark_pandas"><code class="docutils literal notranslate"><span class="pre">GeoSeries.to_spark_pandas()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.to_wkb"><code class="docutils literal notranslate"><span class="pre">GeoSeries.to_wkb()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.to_wkt"><code class="docutils literal notranslate"><span class="pre">GeoSeries.to_wkt()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.total_bounds"><code class="docutils literal notranslate"><span class="pre">GeoSeries.total_bounds</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.touches"><code class="docutils literal notranslate"><span class="pre">GeoSeries.touches()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.transform"><code class="docutils literal notranslate"><span class="pre">GeoSeries.transform()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.type"><code class="docutils literal notranslate"><span class="pre">GeoSeries.type</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.unary_union"><code class="docutils literal notranslate"><span class="pre">GeoSeries.unary_union</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.union"><code class="docutils literal notranslate"><span class="pre">GeoSeries.union()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.union_all"><code class="docutils literal notranslate"><span class="pre">GeoSeries.union_all()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.voronoi_polygons"><code class="docutils literal notranslate"><span class="pre">GeoSeries.voronoi_polygons()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.within"><code class="docutils literal notranslate"><span class="pre">GeoSeries.within()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.x"><code class="docutils literal notranslate"><span class="pre">GeoSeries.x</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.y"><code class="docutils literal notranslate"><span class="pre">GeoSeries.y</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoSeries.z"><code class="docutils literal notranslate"><span class="pre">GeoSeries.z</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoDataFrame"><code class="docutils literal notranslate"><span class="pre">GeoDataFrame</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoDataFrame.__init__"><code class="docutils literal notranslate"><span class="pre">GeoDataFrame.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoDataFrame.active_geometry_name"><code class="docutils literal notranslate"><span class="pre">GeoDataFrame.active_geometry_name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoDataFrame.copy"><code class="docutils literal notranslate"><span class="pre">GeoDataFrame.copy()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoDataFrame.crs"><code class="docutils literal notranslate"><span class="pre">GeoDataFrame.crs</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoDataFrame.from_arrow"><code class="docutils literal notranslate"><span class="pre">GeoDataFrame.from_arrow()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoDataFrame.from_dict"><code class="docutils literal notranslate"><span class="pre">GeoDataFrame.from_dict()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoDataFrame.from_features"><code class="docutils literal notranslate"><span class="pre">GeoDataFrame.from_features()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoDataFrame.from_file"><code class="docutils literal notranslate"><span class="pre">GeoDataFrame.from_file()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoDataFrame.from_postgis"><code class="docutils literal notranslate"><span class="pre">GeoDataFrame.from_postgis()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoDataFrame.geometry"><code class="docutils literal notranslate"><span class="pre">GeoDataFrame.geometry</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoDataFrame.iterfeatures"><code class="docutils literal notranslate"><span class="pre">GeoDataFrame.iterfeatures()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoDataFrame.plot"><code class="docutils literal notranslate"><span class="pre">GeoDataFrame.plot()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoDataFrame.rename_geometry"><code class="docutils literal notranslate"><span class="pre">GeoDataFrame.rename_geometry()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoDataFrame.set_crs"><code class="docutils literal notranslate"><span class="pre">GeoDataFrame.set_crs()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoDataFrame.set_geometry"><code class="docutils literal notranslate"><span class="pre">GeoDataFrame.set_geometry()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoDataFrame.sjoin"><code class="docutils literal notranslate"><span class="pre">GeoDataFrame.sjoin()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoDataFrame.to_arrow"><code class="docutils literal notranslate"><span class="pre">GeoDataFrame.to_arrow()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoDataFrame.to_crs"><code class="docutils literal notranslate"><span class="pre">GeoDataFrame.to_crs()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoDataFrame.to_feather"><code class="docutils literal notranslate"><span class="pre">GeoDataFrame.to_feather()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoDataFrame.to_file"><code class="docutils literal notranslate"><span class="pre">GeoDataFrame.to_file()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoDataFrame.to_geo_dict"><code class="docutils literal notranslate"><span class="pre">GeoDataFrame.to_geo_dict()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoDataFrame.to_geopandas"><code class="docutils literal notranslate"><span class="pre">GeoDataFrame.to_geopandas()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoDataFrame.to_json"><code class="docutils literal notranslate"><span class="pre">GeoDataFrame.to_json()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoDataFrame.to_parquet"><code class="docutils literal notranslate"><span class="pre">GeoDataFrame.to_parquet()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoDataFrame.to_spark_pandas"><code class="docutils literal notranslate"><span class="pre">GeoDataFrame.to_spark_pandas()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoDataFrame.to_wkb"><code class="docutils literal notranslate"><span class="pre">GeoDataFrame.to_wkb()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoDataFrame.to_wkt"><code class="docutils literal notranslate"><span class="pre">GeoDataFrame.to_wkt()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoDataFrame.type"><code class="docutils literal notranslate"><span class="pre">GeoDataFrame.type</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.sindex.SpatialIndex"><code class="docutils literal notranslate"><span class="pre">SpatialIndex</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.sindex.SpatialIndex.__init__"><code class="docutils literal notranslate"><span class="pre">SpatialIndex.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.sindex.SpatialIndex.intersection"><code class="docutils literal notranslate"><span class="pre">SpatialIndex.intersection()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.sindex.SpatialIndex.is_empty"><code class="docutils literal notranslate"><span class="pre">SpatialIndex.is_empty</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.sindex.SpatialIndex.nearest"><code class="docutils literal notranslate"><span class="pre">SpatialIndex.nearest()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.sindex.SpatialIndex.query"><code class="docutils literal notranslate"><span class="pre">SpatialIndex.query()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.sindex.SpatialIndex.size"><code class="docutils literal notranslate"><span class="pre">SpatialIndex.size</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../sedona.spark.geopandas.io.html">sedona.spark.geopandas.io</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../sedona.spark.geopandas.io.html#sedona.spark.geopandas.io.read_file"><code class="docutils literal notranslate"><span class="pre">read_file()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../sedona.spark.geopandas.io.html#sedona.spark.geopandas.io.read_parquet"><code class="docutils literal notranslate"><span class="pre">read_parquet()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../sedona.spark.geopandas.tools.html">sedona.spark.geopandas.tools</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../sedona.spark.geopandas.tools.html#sedona.spark.geopandas.tools.sjoin.sjoin"><code class="docutils literal notranslate"><span class="pre">sjoin()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../sedona.stac.html">sedona.stac package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../sedona.stac.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../sedona.stac.html#module-sedona.stac.client">sedona.stac.client module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../sedona.stac.html#module-sedona.stac.collection_client">sedona.stac.collection_client module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../sedona.stac.html#module-sedona.stac">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../sedona.stats.html">sedona.stats package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../sedona.stats.html#subpackages">Subpackages</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../sedona.stats.clustering.html">sedona.stats.clustering package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.stats.clustering.html#subpackages">Subpackages</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.stats.clustering.html#module-sedona.stats.clustering">Module contents</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../sedona.stats.hotspot_detection.html">sedona.stats.hotspot_detection package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.stats.hotspot_detection.html#subpackages">Subpackages</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.stats.hotspot_detection.html#submodules">Submodules</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.stats.hotspot_detection.html#module-sedona.stats.hotspot_detection.getis_ord">sedona.stats.hotspot_detection.getis_ord module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.stats.hotspot_detection.html#module-sedona.stats.hotspot_detection">Module contents</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../sedona.stats.outlier_detection.html">sedona.stats.outlier_detection package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.stats.outlier_detection.html#subpackages">Subpackages</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.stats.outlier_detection.html#module-sedona.stats.outlier_detection">Module contents</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../sedona.stats.weighting.html">sedona.stats.weighting package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.stats.weighting.html#module-sedona.stats.weighting">Module contents</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../sedona.stats.html#module-sedona.stats">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../sedona.utils.html">sedona.utils package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../sedona.utils.html#subpackages">Subpackages</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../sedona.utils.structured_adapter.html">sedona.utils.structured_adapter package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../sedona.utils.structured_adapter.html#module-sedona.utils.structured_adapter">Module contents</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../sedona.utils.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../sedona.utils.html#module-sedona.utils.adapter">sedona.utils.adapter module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../sedona.utils.html#module-sedona.utils.spatial_rdd_parser">sedona.utils.spatial_rdd_parser module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../sedona.utils.html#module-sedona.utils">Module contents</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: #ff5722" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">Apache Sedona Python</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../../index.html">Module code</a></li>
      <li class="breadcrumb-item active">sedona.spark.geopandas.geodataframe</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
    <div class="sedona-content-wrapper">
        
           <div itemprop="articleBody">
             
  <h1>Source code for sedona.spark.geopandas.geodataframe</h1><div class="highlight"><pre>
<span></span><span class="c1"># Licensed to the Apache Software Foundation (ASF) under one</span>
<span class="c1"># or more contributor license agreements.  See the NOTICE file</span>
<span class="c1"># distributed with this work for additional information</span>
<span class="c1"># regarding copyright ownership.  The ASF licenses this file</span>
<span class="c1"># to you under the Apache License, Version 2.0 (the</span>
<span class="c1"># &quot;License&quot;); you may not use this file except in compliance</span>
<span class="c1"># with the License.  You may obtain a copy of the License at</span>
<span class="c1">#</span>
<span class="c1">#   http://www.apache.org/licenses/LICENSE-2.0</span>
<span class="c1">#</span>
<span class="c1"># Unless required by applicable law or agreed to in writing,</span>
<span class="c1"># software distributed under the License is distributed on an</span>
<span class="c1"># &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY</span>
<span class="c1"># KIND, either express or implied.  See the License for the</span>
<span class="c1"># specific language governing permissions and limitations</span>
<span class="c1"># under the License.</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">__future__</span><span class="w"> </span><span class="kn">import</span> <span class="n">annotations</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Any</span><span class="p">,</span> <span class="n">Literal</span><span class="p">,</span> <span class="n">Callable</span><span class="p">,</span> <span class="n">Union</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">typing</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">shapely</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">warnings</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">geopandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">gpd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pyspark.pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pspd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">sedona.spark.geopandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sgpd</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyspark.pandas</span><span class="w"> </span><span class="kn">import</span> <span class="n">Series</span> <span class="k">as</span> <span class="n">PandasOnSparkSeries</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyspark.pandas.frame</span><span class="w"> </span><span class="kn">import</span> <span class="n">DataFrame</span> <span class="k">as</span> <span class="n">PandasOnSparkDataFrame</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyspark.pandas.utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">log_advice</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">sedona.spark.geopandas._typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Label</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sedona.spark.geopandas.base</span><span class="w"> </span><span class="kn">import</span> <span class="n">GeoFrame</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">pandas.api.extensions</span><span class="w"> </span><span class="kn">import</span> <span class="n">register_extension_dtype</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">geopandas.geodataframe</span><span class="w"> </span><span class="kn">import</span> <span class="n">crs_mismatch_error</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">geopandas.array</span><span class="w"> </span><span class="kn">import</span> <span class="n">GeometryDtype</span>

<span class="n">register_extension_dtype</span><span class="p">(</span><span class="n">GeometryDtype</span><span class="p">)</span>


<span class="c1"># ============================================================================</span>
<span class="c1"># IMPLEMENTATION STATUS TRACKING</span>
<span class="c1"># ============================================================================</span>

<span class="n">IMPLEMENTATION_PRIORITY</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;HIGH&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">&quot;to_geopandas&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_to_geopandas&quot;</span><span class="p">,</span>
        <span class="s2">&quot;contains&quot;</span><span class="p">,</span>
        <span class="s2">&quot;contains_properly&quot;</span><span class="p">,</span>
        <span class="s2">&quot;convex_hull&quot;</span><span class="p">,</span>
        <span class="s2">&quot;count_coordinates&quot;</span><span class="p">,</span>
        <span class="s2">&quot;count_geometries&quot;</span><span class="p">,</span>
        <span class="s2">&quot;is_ring&quot;</span><span class="p">,</span>
        <span class="s2">&quot;is_closed&quot;</span><span class="p">,</span>
        <span class="s2">&quot;make_valid&quot;</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="s2">&quot;MEDIUM&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">&quot;force_2d&quot;</span><span class="p">,</span>
        <span class="s2">&quot;force_3d&quot;</span><span class="p">,</span>
        <span class="s2">&quot;transform&quot;</span><span class="p">,</span>
        <span class="s2">&quot;segmentize&quot;</span><span class="p">,</span>
        <span class="s2">&quot;line_merge&quot;</span><span class="p">,</span>
        <span class="s2">&quot;union_all&quot;</span><span class="p">,</span>
        <span class="s2">&quot;intersection_all&quot;</span><span class="p">,</span>
        <span class="s2">&quot;reverse&quot;</span><span class="p">,</span>
        <span class="s2">&quot;normalize&quot;</span><span class="p">,</span>
        <span class="s2">&quot;get_geometry&quot;</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="s2">&quot;LOW&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">&quot;delaunay_triangles&quot;</span><span class="p">,</span>
        <span class="s2">&quot;voronoi_polygons&quot;</span><span class="p">,</span>
        <span class="s2">&quot;minimum_bounding_circle&quot;</span><span class="p">,</span>
        <span class="s2">&quot;representative_point&quot;</span><span class="p">,</span>
        <span class="s2">&quot;extract_unique_points&quot;</span><span class="p">,</span>
        <span class="s2">&quot;offset_curve&quot;</span><span class="p">,</span>
        <span class="s2">&quot;minimum_rotated_rectangle&quot;</span><span class="p">,</span>
        <span class="s2">&quot;concave_hull&quot;</span><span class="p">,</span>
    <span class="p">],</span>
<span class="p">}</span>


<span class="k">def</span><span class="w"> </span><span class="nf">_not_implemented_error</span><span class="p">(</span><span class="n">method_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">additional_info</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generate a standardized NotImplementedError message for GeoDataFrame methods.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    method_name : str</span>
<span class="sd">        The name of the method that is not implemented.</span>
<span class="sd">    additional_info : str, optional</span>
<span class="sd">        Additional information about the method or workarounds.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    str</span>
<span class="sd">        Formatted error message.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">base_message</span> <span class="o">=</span> <span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;GeoDataFrame.</span><span class="si">{</span><span class="n">method_name</span><span class="si">}</span><span class="s2">() is not implemented yet.</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="sa">f</span><span class="s2">&quot;This method will be added in a future release.&quot;</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="n">additional_info</span><span class="p">:</span>
        <span class="n">base_message</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n\n</span><span class="si">{</span><span class="n">additional_info</span><span class="si">}</span><span class="s2">&quot;</span>

    <span class="n">workaround</span> <span class="o">=</span> <span class="p">(</span>
        <span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">Temporary workaround - use GeoPandas:</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="s2">&quot;  gpd_df = sedona_gdf.to_geopandas()</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="sa">f</span><span class="s2">&quot;  result = gpd_df.</span><span class="si">{</span><span class="n">method_name</span><span class="si">}</span><span class="s2">(...)</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="s2">&quot;  # Note: This will collect all data to the driver.&quot;</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">base_message</span> <span class="o">+</span> <span class="n">workaround</span>


<div class="viewcode-block" id="GeoDataFrame"><a class="viewcode-back" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoDataFrame">[docs]</a><span class="k">class</span><span class="w"> </span><span class="nc">GeoDataFrame</span><span class="p">(</span><span class="n">GeoFrame</span><span class="p">,</span> <span class="n">pspd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A pandas-on-Spark DataFrame for geospatial data with geometry columns.</span>

<span class="sd">    GeoDataFrame extends pyspark.pandas.DataFrame to provide geospatial operations</span>
<span class="sd">    using Apache Sedona&#39;s spatial functions. It maintains compatibility with</span>
<span class="sd">    GeoPandas GeoDataFrame while operating on distributed datasets.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data : dict, array-like, DataFrame, or GeoDataFrame</span>
<span class="sd">        Data to initialize the GeoDataFrame. Can be a dictionary, array-like structure,</span>
<span class="sd">        pandas DataFrame, GeoPandas GeoDataFrame, or another GeoDataFrame.</span>
<span class="sd">    geometry : str, array-like, or GeoSeries, optional</span>
<span class="sd">        Column name, array of geometries, or GeoSeries to use as the active geometry.</span>
<span class="sd">        If None, will look for existing geometry columns.</span>
<span class="sd">    crs : pyproj.CRS, optional</span>
<span class="sd">        Coordinate Reference System for the geometries.</span>
<span class="sd">    columns : Index or array-like, optional</span>
<span class="sd">        Column labels to use for the resulting frame.</span>
<span class="sd">    index : Index or array-like, optional</span>
<span class="sd">        Index to use for the resulting frame.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; from shapely.geometry import Point, Polygon</span>
<span class="sd">    &gt;&gt;&gt; from sedona.spark.geopandas import GeoDataFrame</span>
<span class="sd">    &gt;&gt;&gt; import pandas as pd</span>
<span class="sd">    &gt;&gt;&gt;</span>
<span class="sd">    &gt;&gt;&gt; # Create from dictionary with geometry</span>
<span class="sd">    &gt;&gt;&gt; data = {</span>
<span class="sd">    ...     &#39;name&#39;: [&#39;A&#39;, &#39;B&#39;, &#39;C&#39;],</span>
<span class="sd">    ...     &#39;geometry&#39;: [Point(0, 0), Point(1, 1), Point(2, 2)]</span>
<span class="sd">    ... }</span>
<span class="sd">    &gt;&gt;&gt; gdf = GeoDataFrame(data, crs=&#39;EPSG:4326&#39;)</span>
<span class="sd">    &gt;&gt;&gt; gdf</span>
<span class="sd">         name   geometry</span>
<span class="sd">    0       A   POINT (0 0)</span>
<span class="sd">    1       B   POINT (1 1)</span>
<span class="sd">    2       C   POINT (2 2)</span>
<span class="sd">    &gt;&gt;&gt;</span>
<span class="sd">    &gt;&gt;&gt; # Spatial operations</span>
<span class="sd">    &gt;&gt;&gt; buffered = gdf.buffer(0.1)</span>
<span class="sd">    &gt;&gt;&gt; buffered.area</span>
<span class="sd">    0    0.031416</span>
<span class="sd">    1    0.031416</span>
<span class="sd">    2    0.031416</span>
<span class="sd">    dtype: float64</span>
<span class="sd">    &gt;&gt;&gt;</span>
<span class="sd">    &gt;&gt;&gt; # Spatial joins</span>
<span class="sd">    &gt;&gt;&gt; polygons = GeoDataFrame({</span>
<span class="sd">    ...     &#39;region&#39;: [&#39;Region1&#39;, &#39;Region2&#39;],</span>
<span class="sd">    ...     &#39;geometry&#39;: [</span>
<span class="sd">    ...         Polygon([(-1, -1), (1, -1), (1, 1), (-1, 1)]),</span>
<span class="sd">    ...         Polygon([(0.5, 0.5), (2.5, 0.5), (2.5, 2.5), (0.5, 2.5)])</span>
<span class="sd">    ...     ]</span>
<span class="sd">    ... })</span>
<span class="sd">    &gt;&gt;&gt; result = gdf.sjoin(polygons, how=&#39;left&#39;, predicate=&#39;within&#39;)</span>
<span class="sd">    &gt;&gt;&gt; result[&#39;region&#39;]</span>
<span class="sd">    0    Region1</span>
<span class="sd">    1    Region2</span>
<span class="sd">    2    Region2</span>
<span class="sd">    dtype: object</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    This implementation differs from GeoPandas in several ways:</span>
<span class="sd">    - Uses Spark for distributed processing</span>
<span class="sd">    - Geometries are stored in WKB (Well-Known Binary) format internally</span>
<span class="sd">    - Some methods may have different performance characteristics</span>
<span class="sd">    - Not all GeoPandas methods are implemented yet (see Sedona GeoPandas docs).</span>

<span class="sd">    Performance Considerations:</span>
<span class="sd">    - Operations are distributed across Spark cluster</span>
<span class="sd">    - Avoid converting to GeoPandas (.to_geopandas()) on large datasets</span>
<span class="sd">    - Use .sample() for testing with large datasets</span>
<span class="sd">    - Spatial joins are optimized for distributed processing</span>

<span class="sd">    Geometry Column Management:</span>
<span class="sd">    - Supports multiple geometry columns</span>
<span class="sd">    - One geometry column is designated as &#39;active&#39; at a time</span>
<span class="sd">    - Active geometry is used for spatial operations and plotting</span>
<span class="sd">    - Use set_geometry() to change the active geometry column</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    geopandas.GeoDataFrame : The GeoPandas equivalent</span>
<span class="sd">    sedona.spark.geopandas.GeoSeries : Series with geometry data</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get item from GeoDataFrame by key.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        key : str, list, slice, ndarray or Series</span>
<span class="sd">            - If key is a string, returns a Series for that column</span>
<span class="sd">            - If key is a list of strings, returns a new GeoDataFrame with selected columns</span>
<span class="sd">            - If key is a slice or array, returns rows in the GeoDataFrame</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Any</span>
<span class="sd">            Series, GeoDataFrame, or other objects depending on the key type.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; from shapely.geometry import Point</span>
<span class="sd">        &gt;&gt;&gt; from sedona.spark.geopandas import GeoDataFrame</span>
<span class="sd">        &gt;&gt;&gt;</span>
<span class="sd">        &gt;&gt;&gt; data = {&#39;geometry&#39;: [Point(0, 0), Point(1, 1)], &#39;value&#39;: [1, 2]}</span>
<span class="sd">        &gt;&gt;&gt; gdf = GeoDataFrame(data)</span>
<span class="sd">        &gt;&gt;&gt; gdf[&#39;value&#39;]</span>
<span class="sd">        0    1</span>
<span class="sd">        1    2</span>
<span class="sd">        Name: value, dtype: int64</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Here we are getting a ps.Series with the same underlying anchor (ps.DataFrame).</span>
        <span class="c1"># This is important so we don&#39;t unnecessarily try to perform operations on different dataframes.</span>
        <span class="n">item</span> <span class="o">=</span> <span class="n">pspd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">pspd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
            <span class="c1"># Don&#39;t specify crs=self.crs here because it might not include the geometry column.</span>
            <span class="c1"># If it does include the geometry column, we don&#39;t need to set crs anyways.</span>
            <span class="k">return</span> <span class="n">GeoDataFrame</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">pspd</span><span class="o">.</span><span class="n">Series</span><span class="p">):</span>
            <span class="n">ps_series</span><span class="p">:</span> <span class="n">pspd</span><span class="o">.</span><span class="n">Series</span> <span class="o">=</span> <span class="n">item</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">sgpd</span><span class="o">.</span><span class="n">GeoSeries</span><span class="p">(</span><span class="n">ps_series</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">ps_series</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Logical Error: Unexpected type: </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">item</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="n">_geometry_column_name</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="c1"># ============================================================================</span>
    <span class="c1"># CONSTRUCTION AND INITIALIZATION</span>
    <span class="c1"># ============================================================================</span>

<div class="viewcode-block" id="GeoDataFrame.__init__"><a class="viewcode-back" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoDataFrame.__init__">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">index</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">columns</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">dtype</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">copy</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">geometry</span><span class="p">:</span> <span class="n">Any</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">crs</span><span class="p">:</span> <span class="n">Any</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="k">assert</span> <span class="n">data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_anchor</span><span class="p">:</span> <span class="n">GeoDataFrame</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_col_label</span><span class="p">:</span> <span class="n">Label</span>

        <span class="kn">from</span><span class="w"> </span><span class="nn">sedona.spark.geopandas</span><span class="w"> </span><span class="kn">import</span> <span class="n">GeoSeries</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">pyspark.sql</span><span class="w"> </span><span class="kn">import</span> <span class="n">DataFrame</span> <span class="k">as</span> <span class="n">SparkDataFrame</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="p">(</span><span class="n">GeoDataFrame</span><span class="p">,</span> <span class="n">GeoSeries</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">crs</span><span class="p">:</span>
                <span class="n">data</span><span class="o">.</span><span class="n">crs</span> <span class="o">=</span> <span class="n">crs</span>

            <span class="c1"># For each of these super().__init__() calls, we let pyspark decide which inputs are valid or not</span>
            <span class="c1"># instead of calling e.g assert not dtype ourselves.</span>
            <span class="c1"># This way, if Spark adds support later, we inherit those changes naturally.</span>
            <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="n">copy</span><span class="p">)</span>

        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="p">(</span><span class="n">PandasOnSparkDataFrame</span><span class="p">,</span> <span class="n">SparkDataFrame</span><span class="p">)):</span>

            <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="n">copy</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">PandasOnSparkSeries</span><span class="p">):</span>

            <span class="k">try</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">GeoSeries</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">crs</span><span class="o">=</span><span class="n">crs</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
                <span class="k">pass</span>

            <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="n">copy</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Below are not distributed dataframe types</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">):</span>
                <span class="c1"># We can use GeoDataFrame.active_geometry_name once we drop support for geopandas &lt; 1.0.0.</span>
                <span class="c1"># Below is the equivalent, since active_geometry_name simply calls _geometry_column_name.</span>
                <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">_geometry_column_name</span><span class="p">:</span>
                    <span class="c1"># GeoPandas stores CRS as metadata instead of inside shapely objects, so we must save it and set it manually later.</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">crs</span><span class="p">:</span>
                        <span class="n">crs</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">crs</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">geometry</span><span class="p">:</span>
                        <span class="n">geometry</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">name</span>

            <span class="n">pd_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
                <span class="n">data</span><span class="p">,</span>
                <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">,</span>
                <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">,</span>
                <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">,</span>
                <span class="n">copy</span><span class="o">=</span><span class="n">copy</span><span class="p">,</span>
            <span class="p">)</span>

            <span class="c1"># Spark complains if it&#39;s left as a geometry type.</span>
            <span class="n">geom_type_cols</span> <span class="o">=</span> <span class="n">pd_df</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;geometry&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span>
            <span class="n">pd_df</span><span class="p">[</span><span class="n">geom_type_cols</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd_df</span><span class="p">[</span><span class="n">geom_type_cols</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">object</span><span class="p">)</span>

            <span class="c1"># Initialize the parent class pyspark DataFrame with the pandas DataFrame.</span>
            <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
                <span class="n">data</span><span class="o">=</span><span class="n">pd_df</span><span class="p">,</span>
                <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">,</span>
                <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">,</span>
                <span class="n">copy</span><span class="o">=</span><span class="n">copy</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="c1"># Set geometry column name</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="p">(</span><span class="n">GeoDataFrame</span><span class="p">,</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">)):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_geometry_column_name</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">_geometry_column_name</span>
            <span class="k">if</span> <span class="n">crs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">data</span><span class="o">.</span><span class="n">crs</span> <span class="o">!=</span> <span class="n">crs</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">crs_mismatch_error</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">geometry</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_geometry</span><span class="p">(</span><span class="n">geometry</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">crs</span><span class="o">=</span><span class="n">crs</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">geometry</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="s2">&quot;geometry&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>

            <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">columns</span> <span class="o">==</span> <span class="s2">&quot;geometry&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s2">&quot;GeoDataFrame does not support multiple columns &quot;</span>
                    <span class="s2">&quot;using the geometry column name &#39;geometry&#39;.&quot;</span>
                <span class="p">)</span>

            <span class="n">geometry</span><span class="p">:</span> <span class="n">pspd</span><span class="o">.</span><span class="n">Series</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="s2">&quot;geometry&quot;</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">geometry</span><span class="p">,</span> <span class="n">sgpd</span><span class="o">.</span><span class="n">GeoSeries</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">crs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">set_geometry</span><span class="p">(</span><span class="n">geometry</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">crs</span><span class="o">=</span><span class="n">crs</span><span class="p">)</span>

            <span class="c1"># No need to call set_geometry() here since it&#39;s already part of the df, just set the name.</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_geometry_column_name</span> <span class="o">=</span> <span class="s2">&quot;geometry&quot;</span>

        <span class="k">if</span> <span class="n">geometry</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">crs</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;Assigning CRS to a GeoDataFrame without a geometry column is not &quot;</span>
                <span class="s2">&quot;supported. Supply geometry using the &#39;geometry=&#39; keyword argument, &quot;</span>
                <span class="s2">&quot;or by providing a DataFrame with column name &#39;geometry&#39;&quot;</span><span class="p">,</span>
            <span class="p">)</span></div>

    <span class="c1"># ============================================================================</span>
    <span class="c1"># GEOMETRY COLUMN MANAGEMENT</span>
    <span class="c1"># ============================================================================</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_get_geometry</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">sgpd</span><span class="o">.</span><span class="n">GeoSeries</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_geometry_column_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_geometry_column_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="s2">&quot;You are calling a geospatial method on the GeoDataFrame, &quot;</span>
                    <span class="s2">&quot;but the active geometry column to use has not been set. &quot;</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="s2">&quot;You are calling a geospatial method on the GeoDataFrame, &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;but the active geometry column (&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_geometry_column_name</span><span class="si">}</span><span class="s2">&#39;) &quot;</span>
                    <span class="s2">&quot;is not present. &quot;</span>
                <span class="p">)</span>
            <span class="n">geo_cols</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">dtypes</span> <span class="o">==</span> <span class="s2">&quot;geometry&quot;</span><span class="p">])</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">geo_cols</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">msg</span> <span class="o">+=</span> <span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">There are columns with geometry data type (</span><span class="si">{</span><span class="n">geo_cols</span><span class="si">}</span><span class="s2">), and &quot;</span>
                    <span class="s2">&quot;you can either set one as the active geometry with &quot;</span>
                    <span class="s1">&#39;df.set_geometry(&quot;name&quot;) or access the column as a &#39;</span>
                    <span class="s1">&#39;GeoSeries (df[&quot;name&quot;]) and call the method directly on it.&#39;</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">msg</span> <span class="o">+=</span> <span class="p">(</span>
                    <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">There are no existing columns with geometry data type. You can &quot;</span>
                    <span class="s2">&quot;add a geometry column as the active geometry column with &quot;</span>
                    <span class="s2">&quot;df.set_geometry. &quot;</span>
                <span class="p">)</span>

            <span class="k">raise</span> <span class="n">MissingGeometryColumnError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_geometry_column_name</span><span class="p">]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_set_geometry</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">col</span><span class="p">):</span>
        <span class="c1"># This check is included in the original geopandas. Note that this prevents assigning a str to the property</span>
        <span class="c1"># e.g. df.geometry = &quot;geometry&quot;</span>
        <span class="c1"># However, the user can still specify a str in the public .set_geometry() method</span>
        <span class="c1"># i.e. df.geometry = &quot;geometry1&quot; errors, but df.set_geometry(&quot;geometry1&quot;) works</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">pd</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">is_list_like</span><span class="p">(</span><span class="n">col</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Must use a list-like to set the geometry property&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_geometry</span><span class="p">(</span><span class="n">col</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">geometry</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span>
        <span class="n">fget</span><span class="o">=</span><span class="n">_get_geometry</span><span class="p">,</span> <span class="n">fset</span><span class="o">=</span><span class="n">_set_geometry</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Geometry data for GeoDataFrame&quot;</span>
    <span class="p">)</span>

    <span class="nd">@typing</span><span class="o">.</span><span class="n">overload</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">set_geometry</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">col</span><span class="p">,</span>
        <span class="n">drop</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="o">...</span><span class="p">,</span>
        <span class="n">inplace</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="kc">True</span><span class="p">]</span> <span class="o">=</span> <span class="o">...</span><span class="p">,</span>
        <span class="n">crs</span><span class="p">:</span> <span class="n">Any</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="o">...</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span> <span class="o">...</span>

    <span class="nd">@typing</span><span class="o">.</span><span class="n">overload</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">set_geometry</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">col</span><span class="p">,</span>
        <span class="n">drop</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="o">...</span><span class="p">,</span>
        <span class="n">inplace</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="kc">False</span><span class="p">]</span> <span class="o">=</span> <span class="o">...</span><span class="p">,</span>
        <span class="n">crs</span><span class="p">:</span> <span class="n">Any</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="o">...</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">GeoDataFrame</span><span class="p">:</span> <span class="o">...</span>

<div class="viewcode-block" id="GeoDataFrame.set_geometry"><a class="viewcode-back" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoDataFrame.set_geometry">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="nf">set_geometry</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">col</span><span class="p">,</span>
        <span class="n">drop</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">inplace</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">crs</span><span class="p">:</span> <span class="n">Any</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">GeoDataFrame</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the GeoDataFrame geometry using either an existing column or</span>
<span class="sd">        the specified input. By default yields a new object.</span>

<span class="sd">        The original geometry column is replaced with the input.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        col : column label or array-like</span>
<span class="sd">            An existing column name or values to set as the new geometry column.</span>
<span class="sd">            If values (array-like, (Geo)Series) are passed, then if they are named</span>
<span class="sd">            (Series) the new geometry column will have the corresponding name,</span>
<span class="sd">            otherwise the existing geometry column will be replaced. If there is</span>
<span class="sd">            no existing geometry column, the new geometry column will use the</span>
<span class="sd">            default name &quot;geometry&quot;.</span>
<span class="sd">        drop : boolean, default False</span>
<span class="sd">            When specifying a named Series or an existing column name for `col`,</span>
<span class="sd">            controls if the previous geometry column should be dropped from the</span>
<span class="sd">            result. The default of False keeps both the old and new geometry column.</span>

<span class="sd">            .. deprecated:: 1.0.0</span>

<span class="sd">        inplace : boolean, default False</span>
<span class="sd">            Modify the GeoDataFrame in place (do not create a new object)</span>
<span class="sd">        crs : pyproj.CRS, optional</span>
<span class="sd">            Coordinate system to use. The value can be anything accepted</span>
<span class="sd">            by :meth:`pyproj.CRS.from_user_input() &lt;pyproj.crs.CRS.from_user_input&gt;`,</span>
<span class="sd">            such as an authority string (eg &quot;EPSG:4326&quot;) or a WKT string.</span>
<span class="sd">            If passed, overrides both DataFrame and col&#39;s crs.</span>
<span class="sd">            Otherwise, tries to get crs from passed col values or DataFrame.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; from sedona.spark.geopandas import GeoDataFrame</span>
<span class="sd">        &gt;&gt;&gt; from shapely.geometry import Point</span>
<span class="sd">        &gt;&gt;&gt; d = {&#39;col1&#39;: [&#39;name1&#39;, &#39;name2&#39;], &#39;geometry&#39;: [Point(1, 2), Point(2, 1)]}</span>
<span class="sd">        &gt;&gt;&gt; gdf = GeoDataFrame(d, crs=&quot;EPSG:4326&quot;)</span>
<span class="sd">        &gt;&gt;&gt; gdf</span>
<span class="sd">            col1     geometry</span>
<span class="sd">        0  name1  POINT (1 2)</span>
<span class="sd">        1  name2  POINT (2 1)</span>

<span class="sd">        Passing an array:</span>

<span class="sd">        &gt;&gt;&gt; df1 = gdf.set_geometry([Point(0,0), Point(1,1)])</span>
<span class="sd">        &gt;&gt;&gt; df1</span>
<span class="sd">            col1     geometry</span>
<span class="sd">        0  name1  POINT (0 0)</span>
<span class="sd">        1  name2  POINT (1 1)</span>

<span class="sd">        Using existing column:</span>

<span class="sd">        &gt;&gt;&gt; gdf[&quot;buffered&quot;] = gdf.buffer(2)</span>
<span class="sd">        &gt;&gt;&gt; df2 = gdf.set_geometry(&quot;buffered&quot;)</span>
<span class="sd">        &gt;&gt;&gt; df2.geometry</span>
<span class="sd">        0    POLYGON ((3 2, 2.99037 1.80397, 2.96157 1.6098...</span>
<span class="sd">        1    POLYGON ((4 1, 3.99037 0.80397, 3.96157 0.6098...</span>
<span class="sd">        Name: buffered, dtype: geometry</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        GeoDataFrame</span>

<span class="sd">        See also</span>
<span class="sd">        --------</span>
<span class="sd">        GeoDataFrame.rename_geometry : rename an active geometry column</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Most of the code here is taken from DataFrame.set_index()</span>
        <span class="k">if</span> <span class="n">inplace</span><span class="p">:</span>
            <span class="n">frame</span> <span class="o">=</span> <span class="bp">self</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">frame</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

        <span class="n">geo_column_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_geometry_column_name</span>
        <span class="n">new_series</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="k">if</span> <span class="n">geo_column_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">geo_column_name</span> <span class="o">=</span> <span class="s2">&quot;geometry&quot;</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span>
            <span class="n">col</span><span class="p">,</span> <span class="p">(</span><span class="n">pspd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="nb">list</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">gpd</span><span class="o">.</span><span class="n">array</span><span class="o">.</span><span class="n">GeometryArray</span><span class="p">)</span>
        <span class="p">):</span>
            <span class="k">if</span> <span class="n">drop</span><span class="p">:</span>
                <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="s2">&quot;The `drop` keyword argument is deprecated and has no effect when &quot;</span>
                    <span class="s2">&quot;`col` is an array-like value. You should stop passing `drop` to &quot;</span>
                    <span class="s2">&quot;`set_geometry` when this is the case.&quot;</span>
                <span class="p">)</span>
                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="ne">FutureWarning</span><span class="p">,</span> <span class="n">stacklevel</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">col</span><span class="p">,</span> <span class="p">(</span><span class="n">pspd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)):</span>
                <span class="k">if</span> <span class="n">col</span><span class="o">.</span><span class="n">name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">geo_column_name</span> <span class="o">=</span> <span class="n">col</span><span class="o">.</span><span class="n">name</span>
                    <span class="n">level</span> <span class="o">=</span> <span class="n">col</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">level</span> <span class="o">=</span> <span class="n">col</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">geo_column_name</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">level</span> <span class="o">=</span> <span class="n">pspd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">col</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">geo_column_name</span><span class="p">)</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">level</span><span class="p">,</span> <span class="n">sgpd</span><span class="o">.</span><span class="n">GeoSeries</span><span class="p">):</span>
                <span class="c1"># Set the crs later, so we can allow_override=True</span>
                <span class="n">level</span> <span class="o">=</span> <span class="n">sgpd</span><span class="o">.</span><span class="n">GeoSeries</span><span class="p">(</span><span class="n">level</span><span class="p">)</span>

            <span class="n">new_series</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">elif</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">col</span><span class="p">,</span> <span class="s2">&quot;ndim&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">col</span><span class="o">.</span><span class="n">ndim</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Must pass array with one dimension only.&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># should be a colname</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">level</span> <span class="o">=</span> <span class="n">frame</span><span class="p">[</span><span class="n">col</span><span class="p">]</span>
            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unknown column </span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">level</span><span class="p">,</span> <span class="p">(</span><span class="n">sgpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">,</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">)):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s2">&quot;GeoDataFrame does not support setting the geometry column where &quot;</span>
                    <span class="s2">&quot;the column name is shared by multiple columns.&quot;</span>
                <span class="p">)</span>

            <span class="n">given_colname_drop_msg</span> <span class="o">=</span> <span class="p">(</span>
                <span class="s2">&quot;The `drop` keyword argument is deprecated and in future the only &quot;</span>
                <span class="s2">&quot;supported behaviour will match drop=False. To silence this &quot;</span>
                <span class="s2">&quot;warning and adopt the future behaviour, stop providing &quot;</span>
                <span class="s2">&quot;`drop` as a keyword to `set_geometry`. To replicate the &quot;</span>
                <span class="s2">&quot;`drop=True` behaviour you should update your code to:</span><span class="se">\n</span><span class="s2">&quot;</span>
                <span class="s2">&quot;`geo_col_name = gdf.active_geometry_name; &quot;</span>
                <span class="s2">&quot;gdf.set_geometry(new_geo_col).drop(columns=geo_col_name)&quot;</span>
                <span class="s2">&quot;.rename_geometry(geo_col_name)`.&quot;</span>
            <span class="p">)</span>

            <span class="k">if</span> <span class="n">drop</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>  <span class="c1"># specifically False, not falsy i.e. None</span>
                <span class="c1"># User supplied False explicitly, but arg is deprecated</span>
                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                    <span class="n">given_colname_drop_msg</span><span class="p">,</span>
                    <span class="n">category</span><span class="o">=</span><span class="ne">FutureWarning</span><span class="p">,</span>
                    <span class="n">stacklevel</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="k">if</span> <span class="n">drop</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
                    <span class="n">_not_implemented_error</span><span class="p">(</span>
                        <span class="s2">&quot;set_geometry&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;Setting geometry with drop=True parameter is not supported.&quot;</span><span class="p">,</span>
                    <span class="p">)</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># If not dropping, set the active geometry name to the given col name.</span>
                <span class="n">geo_column_name</span> <span class="o">=</span> <span class="n">col</span>

        <span class="c1"># This operation throws a warning to the user asking them to set pspd.set_option(&#39;compute.ops_on_diff_frames&#39;, True)</span>
        <span class="c1"># to allow operations on different frames. We pass these warnings on to the user so they must manually set it themselves.</span>
        <span class="k">if</span> <span class="n">crs</span><span class="p">:</span>
            <span class="n">level</span><span class="o">.</span><span class="n">set_crs</span><span class="p">(</span><span class="n">crs</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">allow_override</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">new_series</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="n">frame</span><span class="o">.</span><span class="n">_geometry_column_name</span> <span class="o">=</span> <span class="n">geo_column_name</span>
        <span class="k">if</span> <span class="n">new_series</span><span class="p">:</span>
            <span class="c1"># Note: This casts GeoSeries back into pspd.Series, so we lose any metadata that&#39;s not serialized.</span>
            <span class="n">frame</span><span class="p">[</span><span class="n">geo_column_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">level</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">inplace</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">frame</span></div>

    <span class="nd">@typing</span><span class="o">.</span><span class="n">overload</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">rename_geometry</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">col</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">inplace</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="kc">True</span><span class="p">]</span> <span class="o">=</span> <span class="o">...</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span> <span class="o">...</span>

    <span class="nd">@typing</span><span class="o">.</span><span class="n">overload</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">rename_geometry</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">col</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">inplace</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="kc">False</span><span class="p">]</span> <span class="o">=</span> <span class="o">...</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">GeoDataFrame</span><span class="p">:</span> <span class="o">...</span>

<div class="viewcode-block" id="GeoDataFrame.rename_geometry"><a class="viewcode-back" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoDataFrame.rename_geometry">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="nf">rename_geometry</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">col</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">inplace</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">GeoDataFrame</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Renames the GeoDataFrame geometry column to</span>
<span class="sd">        the specified name. By default yields a new object.</span>

<span class="sd">        The original geometry column is replaced with the input.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        col : new geometry column label</span>
<span class="sd">        inplace : boolean, default False</span>
<span class="sd">            Modify the GeoDataFrame in place (without creating a new object)</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; from sedona.spark.geopandas import GeoDataFrame</span>
<span class="sd">        &gt;&gt;&gt; from shapely.geometry import Point</span>
<span class="sd">        &gt;&gt;&gt; d = {&#39;col1&#39;: [&#39;name1&#39;, &#39;name2&#39;], &#39;geometry&#39;: [Point(1, 2), Point(2, 1)]}</span>
<span class="sd">        &gt;&gt;&gt; df = GeoDataFrame(d, crs=&quot;EPSG:4326&quot;)</span>
<span class="sd">        &gt;&gt;&gt; df1 = df.rename_geometry(&#39;geom1&#39;)</span>
<span class="sd">        &gt;&gt;&gt; df1.geometry.name</span>
<span class="sd">        &#39;geom1&#39;</span>
<span class="sd">        &gt;&gt;&gt; df.rename_geometry(&#39;geom1&#39;, inplace=True)</span>
<span class="sd">        &gt;&gt;&gt; df.geometry.name</span>
<span class="sd">        &#39;geom1&#39;</span>


<span class="sd">        See also</span>
<span class="sd">        --------</span>
<span class="sd">        GeoDataFrame.set_geometry : set the active geometry</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">geometry_col</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">name</span>
        <span class="k">if</span> <span class="n">col</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Column named </span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s2"> already exists&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">mapper</span> <span class="o">=</span> <span class="p">{</span><span class="n">col</span><span class="p">:</span> <span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">)}</span>
            <span class="n">mapper</span><span class="p">[</span><span class="n">geometry_col</span><span class="p">]</span> <span class="o">=</span> <span class="n">col</span>

            <span class="k">if</span> <span class="n">inplace</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">mapper</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s2">&quot;raise&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">set_geometry</span><span class="p">(</span><span class="n">col</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="k">return</span> <span class="kc">None</span>

            <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="n">df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">mapper</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s2">&quot;raise&quot;</span><span class="p">)</span>
            <span class="n">df</span><span class="o">.</span><span class="n">set_geometry</span><span class="p">(</span><span class="n">col</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">df</span></div>

    <span class="c1"># ============================================================================</span>
    <span class="c1"># PROPERTIES AND ATTRIBUTES</span>
    <span class="c1"># ============================================================================</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">active_geometry_name</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the name of the active geometry column</span>

<span class="sd">        Returns a name if a GeoDataFrame has an active geometry column set,</span>
<span class="sd">        otherwise returns None. The return type is usually a string, but may be</span>
<span class="sd">        an integer, tuple or other hashable, depending on the contents of the</span>
<span class="sd">        dataframe columns.</span>

<span class="sd">        You can also access the active geometry column using the</span>
<span class="sd">        ``.geometry`` property. You can set a GeoSeries to be an active geometry</span>
<span class="sd">        using the :meth:`~GeoDataFrame.set_geometry` method.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        str or other index label supported by pandas</span>
<span class="sd">            name of an active geometry column or None</span>

<span class="sd">        See also</span>
<span class="sd">        --------</span>
<span class="sd">        GeoDataFrame.set_geometry : set the active geometry</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_geometry_column_name</span>

<div class="viewcode-block" id="GeoDataFrame.to_geopandas"><a class="viewcode-back" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoDataFrame.to_geopandas">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="nf">to_geopandas</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Note: Unlike in pandas and geopandas, Sedona will always return a general Index.</span>
<span class="sd">        This differs from pandas and geopandas, which will return a RangeIndex by default.</span>

<span class="sd">        e.g pd.Index([0, 1, 2]) instead of pd.RangeIndex(start=0, stop=3, step=1)</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">log_advice</span><span class="p">(</span>
            <span class="s2">&quot;`to_geopandas` loads all data into the driver&#39;s memory. &quot;</span>
            <span class="s2">&quot;It should only be used if the resulting geopandas GeoSeries is expected to be small.&quot;</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_to_geopandas</span><span class="p">()</span></div>

    <span class="k">def</span><span class="w"> </span><span class="nf">_to_geopandas</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">:</span>
        <span class="n">pd_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_internal</span><span class="o">.</span><span class="n">to_pandas_frame</span>

        <span class="k">for</span> <span class="n">col_name</span> <span class="ow">in</span> <span class="n">pd_df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="n">series</span><span class="p">:</span> <span class="n">pspd</span><span class="o">.</span><span class="n">Series</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">col_name</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">series</span><span class="p">,</span> <span class="n">sgpd</span><span class="o">.</span><span class="n">GeoSeries</span><span class="p">):</span>
                <span class="c1"># Use _to_geopandas instead of to_geopandas to avoid logging extra warnings</span>
                <span class="n">pd_df</span><span class="p">[</span><span class="n">col_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">series</span><span class="o">.</span><span class="n">_to_geopandas</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">pd_df</span><span class="p">[</span><span class="n">col_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">series</span><span class="o">.</span><span class="n">_to_pandas</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">(</span><span class="n">pd_df</span><span class="p">,</span> <span class="n">geometry</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_geometry_column_name</span><span class="p">)</span>

<div class="viewcode-block" id="GeoDataFrame.to_spark_pandas"><a class="viewcode-back" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoDataFrame.to_spark_pandas">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="nf">to_spark_pandas</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pspd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Convert the GeoDataFrame to a Spark Pandas DataFrame.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">pspd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_internal</span><span class="p">)</span></div>

<div class="viewcode-block" id="GeoDataFrame.copy"><a class="viewcode-back" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoDataFrame.copy">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">deep</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">GeoDataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Make a copy of this GeoDataFrame object.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        deep : bool, default False</span>
<span class="sd">            This parameter is not supported but just a dummy parameter to match pandas.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        GeoDataFrame</span>
<span class="sd">            A copy of this GeoDataFrame object.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; from shapely.geometry import Point</span>
<span class="sd">        &gt;&gt;&gt; from sedona.spark.geopandas import GeoDataFrame</span>

<span class="sd">        &gt;&gt;&gt; gdf = GeoDataFrame([{&quot;geometry&quot;: Point(1, 1), &quot;value1&quot;: 2, &quot;value2&quot;: 3}])</span>
<span class="sd">        &gt;&gt;&gt; gdf_copy = gdf.copy()</span>
<span class="sd">        &gt;&gt;&gt; print(gdf_copy)</span>
<span class="sd">           geometry  value1  value2</span>
<span class="sd">        0  POINT (1 1)       2       3</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Note: The deep parameter is a dummy parameter just as it is in PySpark pandas.</span>
        <span class="k">return</span> <span class="n">GeoDataFrame</span><span class="p">(</span>
            <span class="n">pspd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_internal</span><span class="o">.</span><span class="n">copy</span><span class="p">()),</span> <span class="n">geometry</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">active_geometry_name</span>
        <span class="p">)</span></div>

    <span class="k">def</span><span class="w"> </span><span class="nf">_safe_get_crs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Helper method for getting the CRS of the GeoDataFrame safely.</span>

<span class="sd">        Returns None if no geometry column is set instead of raising an error.</span>
<span class="sd">        This is useful for operations that need to check the CRS without</span>
<span class="sd">        requiring a geometry column to be present.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Any or None</span>
<span class="sd">            The CRS of the active geometry column, or None if no geometry column is set.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">crs</span>
        <span class="k">except</span> <span class="n">MissingGeometryColumnError</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">crs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">crs</span>

    <span class="nd">@crs</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">crs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="c1"># Since PySpark DataFrames are immutable, we can&#39;t modify in place, so we create the new GeoSeries and replace it.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">geometry</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">set_crs</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

<div class="viewcode-block" id="GeoDataFrame.set_crs"><a class="viewcode-back" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoDataFrame.set_crs">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="nf">set_crs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">crs</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">allow_override</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the Coordinate Reference System (CRS) of the ``GeoDataFrame``.</span>

<span class="sd">        If there are multiple geometry columns within the GeoDataFrame, only</span>
<span class="sd">        the CRS of the active geometry column is set.</span>

<span class="sd">        Pass ``None`` to remove CRS from the active geometry column.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        The underlying geometries are not transformed to this CRS. To</span>
<span class="sd">        transform the geometries to a new CRS, use the ``to_crs`` method.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        crs : pyproj.CRS | None, optional</span>
<span class="sd">            The value can be anything accepted</span>
<span class="sd">            by :meth:`pyproj.CRS.from_user_input() &lt;pyproj.crs.CRS.from_user_input&gt;`,</span>
<span class="sd">            such as an authority string (eg &quot;EPSG:4326&quot;) or a WKT string.</span>
<span class="sd">        epsg : int, optional</span>
<span class="sd">            EPSG code specifying the projection.</span>
<span class="sd">        inplace : bool, default False</span>
<span class="sd">            If True, the CRS of the GeoDataFrame will be changed in place</span>
<span class="sd">            (while still returning the result) instead of making a copy of</span>
<span class="sd">            the GeoDataFrame.</span>
<span class="sd">        allow_override : bool, default True</span>
<span class="sd">            If the GeoDataFrame already has a CRS, allow to replace the</span>
<span class="sd">            existing CRS, even when both are not equal. In Sedona, setting this to True</span>
<span class="sd">            will lead to eager evaluation instead of lazy evaluation. Unlike Geopandas,</span>
<span class="sd">            True is the default value in Sedona for performance reasons.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; from sedona.spark.geopandas import GeoDataFrame</span>
<span class="sd">        &gt;&gt;&gt; from shapely.geometry import Point</span>
<span class="sd">        &gt;&gt;&gt; d = {&#39;col1&#39;: [&#39;name1&#39;, &#39;name2&#39;], &#39;geometry&#39;: [Point(1, 2), Point(2, 1)]}</span>
<span class="sd">        &gt;&gt;&gt; gdf = GeoDataFrame(d)</span>
<span class="sd">        &gt;&gt;&gt; gdf</span>
<span class="sd">            col1     geometry</span>
<span class="sd">        0  name1  POINT (1 2)</span>
<span class="sd">        1  name2  POINT (2 1)</span>

<span class="sd">        Setting CRS to a GeoDataFrame without one:</span>

<span class="sd">        &gt;&gt;&gt; gdf.crs is None</span>
<span class="sd">        True</span>

<span class="sd">        &gt;&gt;&gt; gdf = gdf.set_crs(&#39;epsg:3857&#39;)</span>
<span class="sd">        &gt;&gt;&gt; gdf.crs  # doctest: +SKIP</span>
<span class="sd">        &lt;Projected CRS: EPSG:3857&gt;</span>
<span class="sd">        Name: WGS 84 / Pseudo-Mercator</span>
<span class="sd">        Axis Info [cartesian]:</span>
<span class="sd">        - X[east]: Easting (metre)</span>
<span class="sd">        - Y[north]: Northing (metre)</span>
<span class="sd">        Area of Use:</span>
<span class="sd">        - name: World - 85S to 85N</span>
<span class="sd">        - bounds: (-180.0, -85.06, 180.0, 85.06)</span>
<span class="sd">        Coordinate Operation:</span>
<span class="sd">        - name: Popular Visualisation Pseudo-Mercator</span>
<span class="sd">        - method: Popular Visualisation Pseudo Mercator</span>
<span class="sd">        Datum: World Geodetic System 1984</span>
<span class="sd">        - Ellipsoid: WGS 84</span>
<span class="sd">        - Prime Meridian: Greenwich</span>

<span class="sd">        Overriding existing CRS:</span>

<span class="sd">        &gt;&gt;&gt; gdf = gdf.set_crs(4326, allow_override=True)</span>

<span class="sd">        Without ``allow_override=True``, ``set_crs`` returns an error if you try to</span>
<span class="sd">        override CRS.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        GeoDataFrame.to_crs : re-project to another CRS</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Since PySpark DataFrames are immutable, we can&#39;t modify in place, so we create the new GeoSeries and replace it.</span>
        <span class="n">new_geometry</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">set_crs</span><span class="p">(</span><span class="n">crs</span><span class="p">,</span> <span class="n">allow_override</span><span class="o">=</span><span class="n">allow_override</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">inplace</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">geometry</span> <span class="o">=</span> <span class="n">new_geometry</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="n">df</span><span class="o">.</span><span class="n">geometry</span> <span class="o">=</span> <span class="n">new_geometry</span>
            <span class="k">return</span> <span class="n">df</span></div>

<div class="viewcode-block" id="GeoDataFrame.to_crs"><a class="viewcode-back" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoDataFrame.to_crs">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="nf">to_crs</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">crs</span><span class="p">:</span> <span class="n">Any</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">epsg</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">inplace</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">GeoDataFrame</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Transform geometries to a new coordinate reference system.</span>

<span class="sd">        Transform all geometries in an active geometry column to a different coordinate</span>
<span class="sd">        reference system.  The ``crs`` attribute on the current GeoSeries must</span>
<span class="sd">        be set.  Either ``crs`` or ``epsg`` may be specified for output.</span>

<span class="sd">        This method will transform all points in all objects. It has no notion</span>
<span class="sd">        of projecting entire geometries.  All segments joining points are</span>
<span class="sd">        assumed to be lines in the current projection, not geodesics. Objects</span>
<span class="sd">        crossing the dateline (or other projection boundary) will have</span>
<span class="sd">        undesirable behavior.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        crs : pyproj.CRS, optional if `epsg` is specified</span>
<span class="sd">            The value can be anything accepted by</span>
<span class="sd">            :meth:`pyproj.CRS.from_user_input() &lt;pyproj.crs.CRS.from_user_input&gt;`,</span>
<span class="sd">            such as an authority string (eg &quot;EPSG:4326&quot;) or a WKT string.</span>
<span class="sd">        epsg : int, optional if `crs` is specified</span>
<span class="sd">            EPSG code specifying output projection.</span>
<span class="sd">        inplace : bool, optional, default: False</span>
<span class="sd">            Whether to return a new GeoDataFrame or do the transformation in</span>
<span class="sd">            place.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        GeoDataFrame</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; from shapely.geometry import Point</span>
<span class="sd">        &gt;&gt;&gt; from sedona.spark.geopandas import GeoDataFrame</span>
<span class="sd">        &gt;&gt;&gt; d = {&#39;col1&#39;: [&#39;name1&#39;, &#39;name2&#39;], &#39;geometry&#39;: [Point(1, 2), Point(2, 1)]}</span>
<span class="sd">        &gt;&gt;&gt; gdf = GeoDataFrame(d, crs=4326)</span>
<span class="sd">        &gt;&gt;&gt; gdf</span>
<span class="sd">            col1     geometry</span>
<span class="sd">        0  name1  POINT (1 2)</span>
<span class="sd">        1  name2  POINT (2 1)</span>
<span class="sd">        &gt;&gt;&gt; gdf.crs  # doctest: +SKIP</span>
<span class="sd">        &lt;Geographic 2D CRS: EPSG:4326&gt;</span>
<span class="sd">        Name: WGS 84</span>
<span class="sd">        Axis Info [ellipsoidal]:</span>
<span class="sd">        - Lat[north]: Geodetic latitude (degree)</span>
<span class="sd">        - Lon[east]: Geodetic longitude (degree)</span>
<span class="sd">        Area of Use:</span>
<span class="sd">        - name: World</span>
<span class="sd">        - bounds: (-180.0, -90.0, 180.0, 90.0)</span>
<span class="sd">        Datum: World Geodetic System 1984</span>
<span class="sd">        - Ellipsoid: WGS 84</span>
<span class="sd">        - Prime Meridian: Greenwich</span>

<span class="sd">        &gt;&gt;&gt; gdf = gdf.to_crs(3857)</span>
<span class="sd">        &gt;&gt;&gt; gdf</span>
<span class="sd">            col1                       geometry</span>
<span class="sd">        0  name1  POINT (111319.491 222684.209)</span>
<span class="sd">        1  name2  POINT (222638.982 111325.143)</span>
<span class="sd">        &gt;&gt;&gt; gdf.crs  # doctest: +SKIP</span>
<span class="sd">        &lt;Projected CRS: EPSG:3857&gt;</span>
<span class="sd">        Name: WGS 84 / Pseudo-Mercator</span>
<span class="sd">        Axis Info [cartesian]:</span>
<span class="sd">        - X[east]: Easting (metre)</span>
<span class="sd">        - Y[north]: Northing (metre)</span>
<span class="sd">        Area of Use:</span>
<span class="sd">        - name: World - 85S to 85N</span>
<span class="sd">        - bounds: (-180.0, -85.06, 180.0, 85.06)</span>
<span class="sd">        Coordinate Operation:</span>
<span class="sd">        - name: Popular Visualisation Pseudo-Mercator</span>
<span class="sd">        - method: Popular Visualisation Pseudo Mercator</span>
<span class="sd">        Datum: World Geodetic System 1984</span>
<span class="sd">        - Ellipsoid: WGS 84</span>
<span class="sd">        - Prime Meridian: Greenwich</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        GeoDataFrame.set_crs : assign CRS without re-projection</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">new_geometry</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">to_crs</span><span class="p">(</span><span class="n">crs</span><span class="o">=</span><span class="n">crs</span><span class="p">,</span> <span class="n">epsg</span><span class="o">=</span><span class="n">epsg</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">inplace</span><span class="p">:</span>
            <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span>
            <span class="n">df</span><span class="o">.</span><span class="n">geometry</span> <span class="o">=</span> <span class="n">new_geometry</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="n">df</span><span class="o">.</span><span class="n">geometry</span> <span class="o">=</span> <span class="n">new_geometry</span>
            <span class="k">return</span> <span class="n">df</span></div>

<div class="viewcode-block" id="GeoDataFrame.from_dict"><a class="viewcode-back" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoDataFrame.from_dict">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">from_dict</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span>
        <span class="n">data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
        <span class="n">geometry</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">crs</span><span class="p">:</span> <span class="n">Any</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">GeoDataFrame</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;from_dict() is not implemented yet.&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="GeoDataFrame.from_features"><a class="viewcode-back" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoDataFrame.from_features">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">from_features</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span> <span class="n">features</span><span class="p">,</span> <span class="n">crs</span><span class="p">:</span> <span class="n">Any</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">columns</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">GeoDataFrame</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;from_features() is not implemented yet.&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="GeoDataFrame.from_postgis"><a class="viewcode-back" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoDataFrame.from_postgis">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">from_postgis</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span>
        <span class="n">sql</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">sqlalchemy</span><span class="o">.</span><span class="n">text</span><span class="p">,</span>
        <span class="n">con</span><span class="p">,</span>
        <span class="n">geom_col</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;geom&quot;</span><span class="p">,</span>
        <span class="n">crs</span><span class="p">:</span> <span class="n">Any</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">index_col</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">coerce_float</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">parse_dates</span><span class="p">:</span> <span class="nb">list</span> <span class="o">|</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">params</span><span class="p">:</span> <span class="nb">list</span> <span class="o">|</span> <span class="nb">tuple</span> <span class="o">|</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">chunksize</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">GeoDataFrame</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;from_postgis() is not implemented yet.&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="GeoDataFrame.from_arrow"><a class="viewcode-back" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoDataFrame.from_arrow">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">from_arrow</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span> <span class="n">table</span><span class="p">,</span> <span class="n">geometry</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">to_pandas_kwargs</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Construct a GeoDataFrame from a Arrow table object based on GeoArrow</span>
<span class="sd">        extension types.</span>

<span class="sd">        See https://geoarrow.org/ for details on the GeoArrow specification.</span>

<span class="sd">        This functions accepts any tabular Arrow object implementing</span>
<span class="sd">        the `Arrow PyCapsule Protocol`_ (i.e. having an ``__arrow_c_array__``</span>
<span class="sd">        or ``__arrow_c_stream__`` method).</span>

<span class="sd">        .. _Arrow PyCapsule Protocol: https://arrow.apache.org/docs/format/CDataInterface/PyCapsuleInterface.html</span>

<span class="sd">        .. versionadded:: 1.0</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        table : pyarrow.Table or Arrow-compatible table</span>
<span class="sd">            Any tabular object implementing the Arrow PyCapsule Protocol</span>
<span class="sd">            (i.e. has an ``__arrow_c_array__`` or ``__arrow_c_stream__``</span>
<span class="sd">            method). This table should have at least one column with a</span>
<span class="sd">            geoarrow geometry type.</span>
<span class="sd">        geometry : str, default None</span>
<span class="sd">            The name of the geometry column to set as the active geometry</span>
<span class="sd">            column. If None, the first geometry column found will be used.</span>
<span class="sd">        to_pandas_kwargs : dict, optional</span>
<span class="sd">            Arguments passed to the `pa.Table.to_pandas` method for non-geometry</span>
<span class="sd">            columns. This can be used to control the behavior of the conversion of the</span>
<span class="sd">            non-geometry columns to a pandas DataFrame. For example, you can use this</span>
<span class="sd">            to control the dtype conversion of the columns. By default, the `to_pandas`</span>
<span class="sd">            method is called with no additional arguments.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        GeoDataFrame</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        GeoDataFrame.to_arrow</span>
<span class="sd">        GeoSeries.from_arrow</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>

<span class="sd">        &gt;&gt;&gt; from sedona.spark.geopandas import GeoDataFrame</span>
<span class="sd">        &gt;&gt;&gt; import geoarrow.pyarrow as ga  # requires: pip install geoarrow-pyarrow</span>
<span class="sd">        &gt;&gt;&gt; import pyarrow as pa  # requires: pip install pyarrow</span>
<span class="sd">        &gt;&gt;&gt; table = pa.Table.from_arrays([</span>
<span class="sd">        ...     ga.as_geoarrow([None, &quot;POLYGON ((0 0, 1 1, 0 1, 0 0))&quot;, &quot;LINESTRING (0 0, -1 1, 0 -1)&quot;]),</span>
<span class="sd">        ...     pa.array([1, 2, 3]),</span>
<span class="sd">        ...     pa.array([&quot;a&quot;, &quot;b&quot;, &quot;c&quot;]),</span>
<span class="sd">        ... ], names=[&quot;geometry&quot;, &quot;id&quot;, &quot;value&quot;])</span>
<span class="sd">        &gt;&gt;&gt; gdf = GeoDataFrame.from_arrow(table)</span>
<span class="sd">        &gt;&gt;&gt; gdf</span>
<span class="sd">                                   geometry   id  value</span>
<span class="sd">        0                              None    1      a</span>
<span class="sd">        1    POLYGON ((0 0, 1 1, 0 1, 0 0))    2      b</span>
<span class="sd">        2      LINESTRING (0 0, -1 1, 0 -1)    3      c</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">to_pandas_kwargs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">to_pandas_kwargs</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="n">gpd_df</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="o">.</span><span class="n">from_arrow</span><span class="p">(</span>
            <span class="n">table</span><span class="p">,</span> <span class="n">geometry</span><span class="o">=</span><span class="n">geometry</span><span class="p">,</span> <span class="o">**</span><span class="n">to_pandas_kwargs</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">GeoDataFrame</span><span class="p">(</span><span class="n">gpd_df</span><span class="p">)</span></div>

<div class="viewcode-block" id="GeoDataFrame.to_json"><a class="viewcode-back" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoDataFrame.to_json">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="nf">to_json</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">na</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;null&quot;</span><span class="p">,</span> <span class="s2">&quot;drop&quot;</span><span class="p">,</span> <span class="s2">&quot;keep&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;null&quot;</span><span class="p">,</span>
        <span class="n">show_bbox</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">drop_id</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">to_wgs84</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a GeoJSON representation of the ``GeoDataFrame`` as a string.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        na : {&#39;null&#39;, &#39;drop&#39;, &#39;keep&#39;}, default &#39;null&#39;</span>
<span class="sd">            Dictates how to represent missing (NaN) values in the output.</span>
<span class="sd">            - ``null``: Outputs missing entries as JSON `null`.</span>
<span class="sd">            - ``drop``: Removes the entire property from a feature if its</span>
<span class="sd">            value is missing.</span>
<span class="sd">            - ``keep``: Outputs missing entries as ``NaN``.</span>
<span class="sd">        show_bbox : bool, default False</span>
<span class="sd">            If True, the `bbox` (bounds) of the geometries is included in the</span>
<span class="sd">            output.</span>
<span class="sd">        drop_id : bool, default False</span>
<span class="sd">            If True, the GeoDataFrame index is not written to the &#39;id&#39; field</span>
<span class="sd">            of each GeoJSON Feature.</span>
<span class="sd">        to_wgs84 : bool, default False</span>
<span class="sd">            If True, all geometries are transformed to WGS84 (EPSG:4326) to</span>
<span class="sd">            meet the `2016 GeoJSON specification</span>
<span class="sd">            &lt;https://tools.ietf.org/html/rfc7946&gt;`_. When False, the current</span>
<span class="sd">            CRS is exported if it&#39;s set.</span>
<span class="sd">        **kwargs</span>
<span class="sd">            Additional keyword arguments passed to `json.dumps()`.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        str</span>
<span class="sd">            A GeoJSON representation of the GeoDataFrame.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        GeoDataFrame.to_file : Write a ``GeoDataFrame`` to a file, which can be</span>
<span class="sd">                            used for GeoJSON format.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; from sedona.spark.geopandas import GeoDataFrame</span>
<span class="sd">        &gt;&gt;&gt; from shapely.geometry import Point</span>
<span class="sd">        &gt;&gt;&gt; d = {&#39;col1&#39;: [&#39;name1&#39;, &#39;name2&#39;], &#39;geometry&#39;: [Point(1, 2), Point(2, 1)]}</span>
<span class="sd">        &gt;&gt;&gt; gdf = GeoDataFrame(d, crs=&quot;EPSG:3857&quot;)</span>
<span class="sd">        &gt;&gt;&gt; gdf.to_json()</span>
<span class="sd">        &#39;{&quot;type&quot;: &quot;FeatureCollection&quot;, &quot;features&quot;: [{&quot;id&quot;: &quot;0&quot;, &quot;type&quot;: &quot;Feature&quot;, &quot;properties&quot;: {&quot;col1&quot;: &quot;name1&quot;}, &quot;geometry&quot;: {&quot;type&quot;: &quot;Point&quot;, &quot;coordinates&quot;: [1.0, 2.0]}}, {&quot;id&quot;: &quot;1&quot;, &quot;type&quot;: &quot;Feature&quot;, &quot;properties&quot;: {&quot;col1&quot;: &quot;name2&quot;}, &quot;geometry&quot;: {&quot;type&quot;: &quot;Point&quot;, &quot;coordinates&quot;: [2.0, 1.0]}}], &quot;crs&quot;: {&quot;type&quot;: &quot;name&quot;, &quot;properties&quot;: {&quot;name&quot;: &quot;urn:ogc:def:crs:EPSG::3857&quot;}}}&#39;</span>


<span class="sd">        See also</span>
<span class="sd">        --------</span>
<span class="sd">        GeoDataFrame.to_file : write GeoDataFrame to file</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Because this function returns the GeoJSON string in memory,</span>
        <span class="c1"># we simply rely on GeoPandas&#39;s implementation.</span>
        <span class="c1"># Additionally, Spark doesn&#39;t seem to have a straightforward way to get the string</span>
        <span class="c1"># without writing to a file first by using sdf.write.format(&quot;geojson&quot;).save(path, **kwargs).</span>
        <span class="c1"># ST_AsGeoJSON() works only for one column.</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_geopandas</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">result</span><span class="o">.</span><span class="n">to_json</span><span class="p">(</span><span class="n">na</span><span class="p">,</span> <span class="n">show_bbox</span><span class="p">,</span> <span class="n">drop_id</span><span class="p">,</span> <span class="n">to_wgs84</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">__geo_interface__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;__geo_interface__() is not implemented yet.&quot;</span><span class="p">)</span>

<div class="viewcode-block" id="GeoDataFrame.iterfeatures"><a class="viewcode-back" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoDataFrame.iterfeatures">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="nf">iterfeatures</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">na</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;null&quot;</span><span class="p">,</span> <span class="n">show_bbox</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">drop_id</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Generator</span><span class="p">[</span><span class="nb">dict</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;iterfeatures() is not implemented yet.&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="GeoDataFrame.to_geo_dict"><a class="viewcode-back" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoDataFrame.to_geo_dict">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="nf">to_geo_dict</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">na</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="s2">&quot;null&quot;</span><span class="p">,</span> <span class="n">show_bbox</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">drop_id</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;to_geo_dict() is not implemented yet.&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="GeoDataFrame.to_wkb"><a class="viewcode-back" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoDataFrame.to_wkb">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="nf">to_wkb</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">hex</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;to_wkb() is not implemented yet.&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="GeoDataFrame.to_wkt"><a class="viewcode-back" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoDataFrame.to_wkt">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="nf">to_wkt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;to_wkt() is not implemented yet.&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="GeoDataFrame.to_arrow"><a class="viewcode-back" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoDataFrame.to_arrow">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="nf">to_arrow</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">index</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">geometry_encoding</span><span class="o">=</span><span class="s2">&quot;WKB&quot;</span><span class="p">,</span>
        <span class="n">interleaved</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">include_z</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Encode a GeoDataFrame to GeoArrow format.</span>
<span class="sd">        See https://geoarrow.org/ for details on the GeoArrow specification.</span>
<span class="sd">        This function returns a generic Arrow data object implementing</span>
<span class="sd">        the `Arrow PyCapsule Protocol`_ (i.e. having an ``__arrow_c_stream__``</span>
<span class="sd">        method). This object can then be consumed by your Arrow implementation</span>
<span class="sd">        of choice that supports this protocol.</span>
<span class="sd">        .. _Arrow PyCapsule Protocol: https://arrow.apache.org/docs/format/CDataInterface/PyCapsuleInterface.html</span>

<span class="sd">        Note: Requires geopandas versions &gt;= 1.0.0 to use with Sedona.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        index : bool, default None</span>
<span class="sd">            If ``True``, always include the dataframe&#39;s index(es) as columns</span>
<span class="sd">            in the file output.</span>
<span class="sd">            If ``False``, the index(es) will not be written to the file.</span>
<span class="sd">            If ``None``, the index(ex) will be included as columns in the file</span>
<span class="sd">            output except `RangeIndex` which is stored as metadata only.</span>

<span class="sd">            Note: Unlike in geopandas, ``None`` will include the index in the column because Sedona always</span>
<span class="sd">            converts `RangeIndex` into a general `Index`.</span>

<span class="sd">        geometry_encoding : {&#39;WKB&#39;, &#39;geoarrow&#39; }, default &#39;WKB&#39;</span>
<span class="sd">            The GeoArrow encoding to use for the data conversion.</span>
<span class="sd">        interleaved : bool, default True</span>
<span class="sd">            Only relevant for &#39;geoarrow&#39; encoding. If True, the geometries&#39;</span>
<span class="sd">            coordinates are interleaved in a single fixed size list array.</span>
<span class="sd">            If False, the coordinates are stored as separate arrays in a</span>
<span class="sd">            struct type.</span>
<span class="sd">        include_z : bool, default None</span>
<span class="sd">            Only relevant for &#39;geoarrow&#39; encoding (for WKB, the dimensionality</span>
<span class="sd">            of the individual geometries is preserved).</span>
<span class="sd">            If False, return 2D geometries. If True, include the third dimension</span>
<span class="sd">            in the output (if a geometry has no third dimension, the z-coordinates</span>
<span class="sd">            will be NaN). By default, will infer the dimensionality from the</span>
<span class="sd">            input geometries. Note that this inference can be unreliable with</span>
<span class="sd">            empty geometries (for a guaranteed result, it is recommended to</span>
<span class="sd">            specify the keyword).</span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        ArrowTable</span>
<span class="sd">            A generic Arrow table object with geometry columns encoded to</span>
<span class="sd">            GeoArrow.</span>
<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; from sedona.spark.geopandas import GeoDataFrame</span>
<span class="sd">        &gt;&gt;&gt; from shapely.geometry import Point</span>
<span class="sd">        &gt;&gt;&gt; data = {&#39;col1&#39;: [&#39;name1&#39;, &#39;name2&#39;], &#39;geometry&#39;: [Point(1, 2), Point(2, 1)]}</span>
<span class="sd">        &gt;&gt;&gt; gdf = GeoDataFrame(data)</span>
<span class="sd">        &gt;&gt;&gt; gdf</span>
<span class="sd">            col1     geometry</span>
<span class="sd">        0  name1  POINT (1 2)</span>
<span class="sd">        1  name2  POINT (2 1)</span>
<span class="sd">        &gt;&gt;&gt; arrow_table = gdf.to_arrow(index=False)</span>
<span class="sd">        &gt;&gt;&gt; arrow_table</span>
<span class="sd">        &lt;geopandas.io._geoarrow.ArrowTable object at ...&gt;</span>
<span class="sd">        The returned data object needs to be consumed by a library implementing</span>
<span class="sd">        the Arrow PyCapsule Protocol. For example, wrapping the data as a</span>
<span class="sd">        pyarrow.Table (requires pyarrow &gt;= 14.0):</span>
<span class="sd">        &gt;&gt;&gt; import pyarrow as pa  # requires: pip install pyarrow</span>
<span class="sd">        &gt;&gt;&gt; table = pa.table(arrow_table)</span>
<span class="sd">        &gt;&gt;&gt; table</span>
<span class="sd">        pyarrow.Table</span>
<span class="sd">        col1: string</span>
<span class="sd">        geometry: binary</span>
<span class="sd">        ----</span>
<span class="sd">        col1: [[&quot;name1&quot;,&quot;name2&quot;]]</span>
<span class="sd">        geometry: [[0101000000000000000000F03F0000000000000040,\</span>
<span class="sd">01010000000000000000000040000000000000F03F]]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Because this function returns the Arrow table in memory, we simply rely on GeoPandas&#39;s implementation.</span>
        <span class="c1"># This also returns a GeoPandas-specific data type, which can be converted to an actual PyArrow table,</span>
        <span class="c1"># so there is no direct Sedona equivalent. This way we also get all of the arguments implemented for free.</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_geopandas</span><span class="p">()</span><span class="o">.</span><span class="n">to_arrow</span><span class="p">(</span>
            <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">,</span>
            <span class="n">geometry_encoding</span><span class="o">=</span><span class="n">geometry_encoding</span><span class="p">,</span>
            <span class="n">interleaved</span><span class="o">=</span><span class="n">interleaved</span><span class="p">,</span>
            <span class="n">include_z</span><span class="o">=</span><span class="n">include_z</span><span class="p">,</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="GeoDataFrame.to_feather"><a class="viewcode-back" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoDataFrame.to_feather">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="nf">to_feather</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">path</span><span class="p">,</span>
        <span class="n">index</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">compression</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">schema_version</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;to_feather() is not implemented yet.&quot;</span><span class="p">)</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">type</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Implementation of the abstract method</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
            <span class="n">_not_implemented_error</span><span class="p">(</span><span class="s2">&quot;type&quot;</span><span class="p">,</span> <span class="s2">&quot;Returns numeric geometry type codes.&quot;</span><span class="p">)</span>
        <span class="p">)</span>

<div class="viewcode-block" id="GeoDataFrame.plot"><a class="viewcode-back" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoDataFrame.plot">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="nf">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plot a GeoDataFrame.</span>

<span class="sd">        Generate a plot of a GeoDataFrame with matplotlib.  If a</span>
<span class="sd">        column is specified, the plot coloring will be based on values</span>
<span class="sd">        in that column.</span>

<span class="sd">        Note: This method is not scalable and requires collecting all data to the driver.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        column : str, np.array, pd.Series, pd.Index (default None)</span>
<span class="sd">            The name of the dataframe column, np.array, pd.Series, or pd.Index</span>
<span class="sd">            to be plotted. If np.array, pd.Series, or pd.Index are used then it</span>
<span class="sd">            must have same length as dataframe. Values are used to color the plot.</span>
<span class="sd">            Ignored if `color` is also set.</span>
<span class="sd">        kind: str</span>
<span class="sd">            The kind of plots to produce. The default is to create a map (&quot;geo&quot;).</span>
<span class="sd">            Other supported kinds of plots from pandas:</span>

<span class="sd">            - &#39;line&#39; : line plot</span>
<span class="sd">            - &#39;bar&#39; : vertical bar plot</span>
<span class="sd">            - &#39;barh&#39; : horizontal bar plot</span>
<span class="sd">            - &#39;hist&#39; : histogram</span>
<span class="sd">            - &#39;box&#39; : BoxPlot</span>
<span class="sd">            - &#39;kde&#39; : Kernel Density Estimation plot</span>
<span class="sd">            - &#39;density&#39; : same as &#39;kde&#39;</span>
<span class="sd">            - &#39;area&#39; : area plot</span>
<span class="sd">            - &#39;pie&#39; : pie plot</span>
<span class="sd">            - &#39;scatter&#39; : scatter plot</span>
<span class="sd">            - &#39;hexbin&#39; : hexbin plot.</span>
<span class="sd">        cmap : str (default None)</span>
<span class="sd">            The name of a colormap recognized by matplotlib.</span>
<span class="sd">        color : str, np.array, pd.Series (default None)</span>
<span class="sd">            If specified, all objects will be colored uniformly.</span>
<span class="sd">        ax : matplotlib.pyplot.Artist (default None)</span>
<span class="sd">            axes on which to draw the plot</span>
<span class="sd">        cax : matplotlib.pyplot Artist (default None)</span>
<span class="sd">            axes on which to draw the legend in case of color map.</span>
<span class="sd">        categorical : bool (default False)</span>
<span class="sd">            If False, cmap will reflect numerical values of the</span>
<span class="sd">            column being plotted.  For non-numerical columns, this</span>
<span class="sd">            will be set to True.</span>
<span class="sd">        legend : bool (default False)</span>
<span class="sd">            Plot a legend. Ignored if no `column` is given, or if `color` is given.</span>
<span class="sd">        scheme : str (default None)</span>
<span class="sd">            Name of a choropleth classification scheme (requires mapclassify).</span>
<span class="sd">            A mapclassify.MapClassifier object will be used</span>
<span class="sd">            under the hood. Supported are all schemes provided by mapclassify (e.g.</span>
<span class="sd">            &#39;BoxPlot&#39;, &#39;EqualInterval&#39;, &#39;FisherJenks&#39;, &#39;FisherJenksSampled&#39;,</span>
<span class="sd">            &#39;HeadTailBreaks&#39;, &#39;JenksCaspall&#39;, &#39;JenksCaspallForced&#39;,</span>
<span class="sd">            &#39;JenksCaspallSampled&#39;, &#39;MaxP&#39;, &#39;MaximumBreaks&#39;,</span>
<span class="sd">            &#39;NaturalBreaks&#39;, &#39;Quantiles&#39;, &#39;Percentiles&#39;, &#39;StdMean&#39;,</span>
<span class="sd">            &#39;UserDefined&#39;). Arguments can be passed in classification_kwds.</span>
<span class="sd">        k : int (default 5)</span>
<span class="sd">            Number of classes (ignored if scheme is None)</span>
<span class="sd">        vmin : None or float (default None)</span>
<span class="sd">            Minimum value of cmap. If None, the minimum data value</span>
<span class="sd">            in the column to be plotted is used.</span>
<span class="sd">        vmax : None or float (default None)</span>
<span class="sd">            Maximum value of cmap. If None, the maximum data value</span>
<span class="sd">            in the column to be plotted is used.</span>
<span class="sd">        markersize : str or float or sequence (default None)</span>
<span class="sd">            Only applies to point geometries within a frame.</span>
<span class="sd">            If a str, will use the values in the column of the frame specified</span>
<span class="sd">            by markersize to set the size of markers. Otherwise can be a value</span>
<span class="sd">            to apply to all points, or a sequence of the same length as the</span>
<span class="sd">            number of points.</span>
<span class="sd">        figsize : tuple of integers (default None)</span>
<span class="sd">            Size of the resulting matplotlib.figure.Figure. If the argument</span>
<span class="sd">            axes is given explicitly, figsize is ignored.</span>
<span class="sd">        legend_kwds : dict (default None)</span>
<span class="sd">            Keyword arguments to pass to :func:`matplotlib.pyplot.legend` or</span>
<span class="sd">            :func:`matplotlib.pyplot.colorbar`.</span>
<span class="sd">            Additional accepted keywords when `scheme` is specified:</span>

<span class="sd">            fmt : string</span>
<span class="sd">                A formatting specification for the bin edges of the classes in the</span>
<span class="sd">                legend. For example, to have no decimals: ``{&quot;fmt&quot;: &quot;{:.0f}&quot;}``.</span>
<span class="sd">            labels : list-like</span>
<span class="sd">                A list of legend labels to override the auto-generated labels.</span>
<span class="sd">                Needs to have the same number of elements as the number of</span>
<span class="sd">                classes (`k`).</span>
<span class="sd">            interval : boolean (default False)</span>
<span class="sd">                An option to control brackets from mapclassify legend.</span>
<span class="sd">                If True, open/closed interval brackets are shown in the legend.</span>
<span class="sd">        categories : list-like</span>
<span class="sd">            Ordered list-like object of categories to be used for categorical plot.</span>
<span class="sd">        classification_kwds : dict (default None)</span>
<span class="sd">            Keyword arguments to pass to mapclassify</span>
<span class="sd">        missing_kwds : dict (default None)</span>
<span class="sd">            Keyword arguments specifying color options (as style_kwds)</span>
<span class="sd">            to be passed on to geometries with missing values in addition to</span>
<span class="sd">            or overwriting other style kwds. If None, geometries with missing</span>
<span class="sd">            values are not plotted.</span>
<span class="sd">        aspect : &#39;auto&#39;, &#39;equal&#39;, None or float (default &#39;auto&#39;)</span>
<span class="sd">            Set aspect of axis. If &#39;auto&#39;, the default aspect for map plots is &#39;equal&#39;; if</span>
<span class="sd">            however data are not projected (coordinates are long/lat), the aspect is by</span>
<span class="sd">            default set to 1/cos(df_y * pi/180) with df_y the y coordinate of the middle of</span>
<span class="sd">            the GeoDataFrame (the mean of the y range of bounding box) so that a long/lat</span>
<span class="sd">            square appears square in the middle of the plot. This implies an</span>
<span class="sd">            Equirectangular projection. If None, the aspect of `ax` won&#39;t be changed. It can</span>
<span class="sd">            also be set manually (float) as the ratio of y-unit to x-unit.</span>
<span class="sd">        autolim : bool (default True)</span>
<span class="sd">            Update axes data limits to contain the new geometries.</span>
<span class="sd">        **style_kwds : dict</span>
<span class="sd">            Style options to be passed on to the actual plot function, such</span>
<span class="sd">            as ``edgecolor``, ``facecolor``, ``linewidth``, ``markersize``,</span>
<span class="sd">            ``alpha``.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        ax : matplotlib axes instance</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; import geodatasets  # requires: pip install geodatasets</span>
<span class="sd">        &gt;&gt;&gt; import geopandas as gpd</span>
<span class="sd">        &gt;&gt;&gt; df = gpd.read_file(geodatasets.get_path(&quot;nybb&quot;))</span>
<span class="sd">        &gt;&gt;&gt; df.head()  # doctest: +SKIP</span>
<span class="sd">        BoroCode  ...                                           geometry</span>
<span class="sd">        0         5  ...  MULTIPOLYGON (((970217.022 145643.332, 970227....</span>
<span class="sd">        1         4  ...  MULTIPOLYGON (((1029606.077 156073.814, 102957...</span>
<span class="sd">        2         3  ...  MULTIPOLYGON (((1021176.479 151374.797, 102100...</span>
<span class="sd">        3         1  ...  MULTIPOLYGON (((981219.056 188655.316, 980940....</span>
<span class="sd">        4         2  ...  MULTIPOLYGON (((1012821.806 229228.265, 101278...</span>

<span class="sd">        &gt;&gt;&gt; df.plot(&quot;BoroName&quot;, cmap=&quot;Set1&quot;)  # doctest: +SKIP</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_geopandas</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

    <span class="c1"># ============================================================================</span>
    <span class="c1"># SPATIAL OPERATIONS</span>
    <span class="c1"># ============================================================================</span>

<div class="viewcode-block" id="GeoDataFrame.sjoin"><a class="viewcode-back" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoDataFrame.sjoin">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="nf">sjoin</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">other</span><span class="p">,</span>
        <span class="n">how</span><span class="o">=</span><span class="s2">&quot;inner&quot;</span><span class="p">,</span>
        <span class="n">predicate</span><span class="o">=</span><span class="s2">&quot;intersects&quot;</span><span class="p">,</span>
        <span class="n">lsuffix</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">,</span>
        <span class="n">rsuffix</span><span class="o">=</span><span class="s2">&quot;right&quot;</span><span class="p">,</span>
        <span class="n">distance</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">on_attribute</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Spatial join of two GeoDataFrames.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        other : GeoDataFrame</span>
<span class="sd">            The right GeoDataFrame to join with.</span>
<span class="sd">        how : str, default &#39;inner&#39;</span>
<span class="sd">            The type of join:</span>
<span class="sd">            * &#39;left&#39;: use keys from left_df; retain only left_df geometry column</span>
<span class="sd">            * &#39;right&#39;: use keys from right_df; retain only right_df geometry column</span>
<span class="sd">            * &#39;inner&#39;: use intersection of keys from both dfs; retain only left_df geometry column</span>
<span class="sd">        predicate : str, default &#39;intersects&#39;</span>
<span class="sd">            Binary predicate. Valid values: &#39;intersects&#39;, &#39;contains&#39;, &#39;within&#39;, &#39;dwithin&#39;, &#39;touches&#39;, &#39;crosses&#39;, &#39;overlaps&#39;, &#39;covers&#39;, &#39;covered_by&#39;</span>
<span class="sd">        lsuffix : str, default &#39;left&#39;</span>
<span class="sd">            Suffix to apply to overlapping column names (left GeoDataFrame).</span>
<span class="sd">        rsuffix : str, default &#39;right&#39;</span>
<span class="sd">            Suffix to apply to overlapping column names (right GeoDataFrame).</span>
<span class="sd">        distance : float, optional</span>
<span class="sd">            Distance for &#39;dwithin&#39; predicate. Required if predicate=&#39;dwithin&#39;.</span>
<span class="sd">        on_attribute : str, list or tuple, optional</span>
<span class="sd">            Column name(s) to join on as an additional join restriction.</span>
<span class="sd">            These must be found in both DataFrames.</span>
<span class="sd">        **kwargs</span>
<span class="sd">            Additional keyword arguments passed to the spatial join function.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        GeoDataFrame</span>
<span class="sd">            A GeoDataFrame with the results of the spatial join.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; from shapely.geometry import Point, Polygon</span>
<span class="sd">        &gt;&gt;&gt; from sedona.spark.geopandas import GeoDataFrame</span>

<span class="sd">        &gt;&gt;&gt; polygons = GeoDataFrame({</span>
<span class="sd">        ...     &#39;geometry&#39;: [Polygon([(0, 0), (0, 1), (1, 1), (1, 0)])],</span>
<span class="sd">        ...     &#39;value&#39;: [1]</span>
<span class="sd">        ... })</span>
<span class="sd">        &gt;&gt;&gt; points = GeoDataFrame({</span>
<span class="sd">        ...     &#39;geometry&#39;: [Point(0.5, 0.5), Point(2, 2)],</span>
<span class="sd">        ...     &#39;value&#39;: [1, 2]</span>
<span class="sd">        ... })</span>
<span class="sd">        &gt;&gt;&gt; joined = points.sjoin(polygons)</span>
<span class="sd">        &gt;&gt;&gt; joined</span>
<span class="sd">            geometry_left  value_left            geometry_right  value_right</span>
<span class="sd">        0  POINT (0.5 0.5)           1  POLYGON ((0 0, 0 1, 1 1, 1 0, 0 0))            1</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">sedona.spark.geopandas.tools.sjoin</span><span class="w"> </span><span class="kn">import</span> <span class="n">sjoin</span> <span class="k">as</span> <span class="n">sjoin_tool</span>

        <span class="k">return</span> <span class="n">sjoin_tool</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">other</span><span class="p">,</span>
            <span class="n">how</span><span class="o">=</span><span class="n">how</span><span class="p">,</span>
            <span class="n">predicate</span><span class="o">=</span><span class="n">predicate</span><span class="p">,</span>
            <span class="n">lsuffix</span><span class="o">=</span><span class="n">lsuffix</span><span class="p">,</span>
            <span class="n">rsuffix</span><span class="o">=</span><span class="n">rsuffix</span><span class="p">,</span>
            <span class="n">distance</span><span class="o">=</span><span class="n">distance</span><span class="p">,</span>
            <span class="n">on_attribute</span><span class="o">=</span><span class="n">on_attribute</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span></div>

    <span class="c1"># ============================================================================</span>
    <span class="c1"># I/O OPERATIONS</span>
    <span class="c1"># ============================================================================</span>

<div class="viewcode-block" id="GeoDataFrame.from_file"><a class="viewcode-back" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoDataFrame.from_file">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">from_file</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">format</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">GeoDataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Alternate constructor to create a ``GeoDataFrame`` from a file.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        filename : str</span>
<span class="sd">            File path or file handle to read from. If the path is a directory,</span>
<span class="sd">            Sedona will read all files in that directory.</span>
<span class="sd">        format : str, optional</span>
<span class="sd">            The format of the file to read, by default None. If None, Sedona</span>
<span class="sd">            infers the format from the file extension. Note that format</span>
<span class="sd">            inference is not supported for directories. Available formats are</span>
<span class="sd">            &quot;shapefile&quot;, &quot;geojson&quot;, &quot;geopackage&quot;, and &quot;geoparquet&quot;.</span>
<span class="sd">        table_name : str, optional</span>
<span class="sd">            The name of the table to read from a GeoPackage file, by default</span>
<span class="sd">            None. This is required if ``format`` is &quot;geopackage&quot;.</span>
<span class="sd">        **kwargs</span>
<span class="sd">            Additional keyword arguments passed to the file reader.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        GeoDataFrame</span>
<span class="sd">            A new GeoDataFrame created from the file.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        GeoDataFrame.to_file : Write a ``GeoDataFrame`` to a file.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">sgpd</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="nb">format</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="GeoDataFrame.to_file"><a class="viewcode-back" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoDataFrame.to_file">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="nf">to_file</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">driver</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">schema</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">index</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Write the ``GeoDataFrame`` to a file.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        path : str</span>
<span class="sd">            File path or file handle to write to.</span>

<span class="sd">        driver : str, default None</span>
<span class="sd">            The format driver used to write the file.</span>
<span class="sd">            If not specified, it attempts to infer it from the file extension.</span>
<span class="sd">            If no extension is specified, Sedona will error.</span>

<span class="sd">            Options: &quot;geojson&quot;, &quot;geopackage&quot;, &quot;geoparquet&quot;</span>

<span class="sd">        schema : dict, default None</span>
<span class="sd">            Not applicable to Sedona&#39;s implementation.</span>

<span class="sd">        index : bool, default None</span>
<span class="sd">            If True, write index into one or more columns (for MultiIndex).</span>
<span class="sd">            Default None writes the index into one or more columns only if</span>
<span class="sd">            the index is named, is a MultiIndex, or has a non-integer data</span>
<span class="sd">            type. If False, no index is written.</span>

<span class="sd">        **kwargs</span>
<span class="sd">            Additional keyword arguments:</span>

<span class="sd">            mode : str, default &#39;w&#39;</span>
<span class="sd">                The write mode, &#39;w&#39; to overwrite the existing file and &#39;a&#39; to append.</span>
<span class="sd">                &#39;overwrite&#39; and &#39;append&#39; are equivalent to &#39;w&#39; and &#39;a&#39; respectively.</span>

<span class="sd">            crs : pyproj.CRS, default None</span>
<span class="sd">                If specified, the CRS is passed to Fiona to better control how the file is written.</span>
<span class="sd">                If None, GeoPandas will determine the CRS based on the ``crs`` attribute.</span>
<span class="sd">                The value can be anything accepted by</span>
<span class="sd">                :meth:`pyproj.CRS.from_user_input &lt;pyproj.crs.CRS.from_user_input&gt;`,</span>
<span class="sd">                such as an authority string (e.g., &quot;EPSG:4326&quot;) or a WKT string.</span>

<span class="sd">            engine : str</span>
<span class="sd">                Not applicable to Sedona&#39;s implementation.</span>

<span class="sd">            metadata : dict[str, str], default None</span>
<span class="sd">                Optional metadata to be stored in the file. Keys and values must be</span>
<span class="sd">                strings. Supported only for &quot;GPKG&quot; driver. Not supported by Sedona.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; from shapely.geometry import Point, LineString</span>
<span class="sd">        &gt;&gt;&gt; from sedona.spark.geopandas import GeoDataFrame</span>

<span class="sd">        &gt;&gt;&gt; gdf = GeoDataFrame({</span>
<span class="sd">        ...     &quot;geometry&quot;: [Point(0, 0), LineString([(0, 0), (1, 1)])],</span>
<span class="sd">        ...     &quot;int&quot;: [1, 2]</span>
<span class="sd">        ... })</span>
<span class="sd">        &gt;&gt;&gt; gdf.to_file(&quot;output.parquet&quot;, driver=&quot;geoparquet&quot;)</span>

<span class="sd">        With selected drivers you can also append to a file with ``mode=&quot;a&quot;``:</span>

<span class="sd">        &gt;&gt;&gt; gdf.to_file(&quot;output.geojson&quot;, driver=&quot;geojson&quot;, mode=&quot;a&quot;)</span>

<span class="sd">        When the index is of non-integer dtype, ``index=None`` (default) is treated as True,</span>
<span class="sd">        writing the index to the file.</span>

<span class="sd">        &gt;&gt;&gt; gdf = GeoDataFrame({&quot;geometry&quot;: [Point(0, 0), Point(1, 1)]}, index=[&quot;a&quot;, &quot;b&quot;])</span>
<span class="sd">        &gt;&gt;&gt; gdf.to_file(&quot;output_with_index.parquet&quot;, driver=&quot;geoparquet&quot;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">sgpd</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">_to_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">driver</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="GeoDataFrame.to_parquet"><a class="viewcode-back" href="../../../../sedona.spark.geopandas.api.html#sedona.spark.geopandas.GeoDataFrame.to_parquet">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="nf">to_parquet</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Write the GeoDataFrame to a GeoParquet file.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        path : str</span>
<span class="sd">            The file path where the GeoParquet file will be written.</span>
<span class="sd">        **kwargs</span>
<span class="sd">            Additional arguments to pass to the Sedona DataFrame output function.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; from shapely.geometry import Point</span>
<span class="sd">        &gt;&gt;&gt; from sedona.spark.geopandas import GeoDataFrame</span>
<span class="sd">        &gt;&gt;&gt; gdf = GeoDataFrame({&quot;geometry&quot;: [Point(0, 0), Point(1, 1)], &quot;value&quot;: [1, 2]})</span>
<span class="sd">        &gt;&gt;&gt; gdf.to_parquet(&quot;output.parquet&quot;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">to_file</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">driver</span><span class="o">=</span><span class="s2">&quot;geoparquet&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div></div>


<span class="c1"># -----------------------------------------------------------------------------</span>
<span class="c1"># # Utils</span>
<span class="c1"># -----------------------------------------------------------------------------</span>


<span class="k">def</span><span class="w"> </span><span class="nf">_ensure_geometry</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">crs</span><span class="p">:</span> <span class="n">Any</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">sgpd</span><span class="o">.</span><span class="n">GeoSeries</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Ensure the data is of geometry dtype or converted to it.</span>

<span class="sd">    If the input is a GeometryDtype with a set CRS, `crs` is ignored.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">sgpd</span><span class="o">.</span><span class="n">GeoSeries</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">crs</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">crs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># Avoids caching issues/crs sharing issues</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="n">data</span><span class="o">.</span><span class="n">crs</span> <span class="o">=</span> <span class="n">crs</span>
        <span class="k">return</span> <span class="n">data</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">sgpd</span><span class="o">.</span><span class="n">GeoSeries</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">crs</span><span class="o">=</span><span class="n">crs</span><span class="p">)</span>


<span class="c1"># We don&#39;t raise AttributeError because that would be caught by pyspark&#39;s __getattr__ creating a misleading error message</span>
<span class="k">class</span><span class="w"> </span><span class="nc">MissingGeometryColumnError</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
    <span class="k">pass</span>
</pre></div>

           </div>
          </div>
    </div>

          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Apache Software Foundation.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>